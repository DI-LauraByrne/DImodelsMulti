[{"path":"https://di-laurabyrne.github.io/DImodelsMulti/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Laura Byrne. Author, maintainer. Rishabh Vishwakarma. Author. Rafael de Andrade Moral. Author. Caroline Brophy. Author.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Byrne L, Vishwakarma R, de Andrade Moral R, Brophy C (2025). DImodelsMulti: Fit Multivariate Diversity-Interactions Models Repeated Measures. R package version 1.2.0, https://dimodels.com.","code":"@Manual{,   title = {DImodelsMulti: Fit Multivariate Diversity-Interactions Models with Repeated Measures},   author = {Laura Byrne and Rishabh Vishwakarma and Rafael {de Andrade Moral} and Caroline Brophy},   year = {2025},   note = {R package version 1.2.0},   url = {https://dimodels.com}, }"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/index.html","id":"dimodelsmulti","dir":"","previous_headings":"","what":"Fit Multivariate Diversity-Interactions Models with Repeated Measures","title":"Fit Multivariate Diversity-Interactions Models with Repeated Measures","text":"goal DImodelsMulti enable easy fitting multivariate repeated measures DI models.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Fit Multivariate Diversity-Interactions Models with Repeated Measures","text":"can install development version DImodelsMulti GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"DI-LauraByrne/DImodelsMulti\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Fit Multivariate Diversity-Interactions Models with Repeated Measures","text":"Examples follow.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/AICc.html","id":null,"dir":"Reference","previous_headings":"","what":"AICc — AICc","title":"AICc — AICc","text":"Calculate Second-order Akaike Information Criterion fitted DImulti object","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/AICc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"AICc — AICc","text":"","code":"AICc(model)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/AICc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"AICc — AICc","text":"model object class DImulti","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/AICc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"AICc — AICc","text":"numeric value AICc value corresponding model object","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/BICc.html","id":null,"dir":"Reference","previous_headings":"","what":"BICc — BICc","title":"BICc — BICc","text":"Calculate Second-order Bayesian Information Criterion fitted DImulti obect","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/BICc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BICc — BICc","text":"","code":"BICc(model)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/BICc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BICc — BICc","text":"model object class DImulti","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/BICc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BICc — BICc","text":"numeric value BICc value corresponding model object","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium.html","id":null,"dir":"Reference","previous_headings":"","what":"The extended Belgium dataset — Belgium","title":"The extended Belgium dataset — Belgium","text":"Single site dataset containing thirty experimental units (plots), four species seeded two density levels, representing fifteen communities. Two ecosystem function responses recorded plot single year (N Weed) third recorded across three years (Sown). Data stacked format.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The extended Belgium dataset — Belgium","text":"","code":"data(\"Belgium\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The extended Belgium dataset — Belgium","text":"data frame 150 observations following 9 variables. YEARN numeric vector indicating time point (year) ecosystem     function recording measured PLOT numeric vector indicating ID experimental unit observation recorded G1 numeric vector ranging 0 1, proportion species G1 G2 numeric vector ranging 0 1, proportion species G2 L1 numeric vector ranging 0 1, proportion species L1 L2 numeric vector ranging 0 1, proportion species L2 DENS vector factors two levels, -1 1, representing seeding density plot Var character vector indicating ecosystem function recorded Y numeric vector indicating value ecosystem function recorded","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The extended Belgium dataset — Belgium","text":"Data comes single site wider agrodiversity experiment conducted Belgium, established 2002.  four species used Lolium perenne (G1), Phleum pratense (G2), Trifolium pratense (L1), Trifolium repens (L2). two recommended functional groupings: grouping grasses (G1, G2) legumes (L1, L2), grouping fast-establishing species (G1, L1) temporally persistent species (G2, L2).  Three ecosystem functions recorded summing recordings multiple harvests years experiment: (1) aboveground biomass sown species (Sown) (t DM ha-1), (2) aboveground biomass weed species (Weed) (t DM ha-1) (3) total annual yield nitrogen harvested aboveground biomass (N) (t DM ha-1). recommended perform linear transformation response value 'Y' commencing multivariate analysis dataset.  dataset used create datasets 'Belgium_MV' 'Beglium_RM'.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The extended Belgium dataset — Belgium","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The extended Belgium dataset — Belgium","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":null,"dir":"Reference","previous_headings":"","what":"The multivariate Belgium dataset — Belgium_MV","title":"The multivariate Belgium dataset — Belgium_MV","text":"Single site dataset containing thirty experimental units (plots), four species seeded two density levels, representing fifteen communities. Three ecosystem function responses recorded plot single year. responses linearly transformed lie scale. Data stacked format.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The multivariate Belgium dataset — Belgium_MV","text":"","code":"data(\"Belgium_MV\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The multivariate Belgium dataset — Belgium_MV","text":"data frame 150 observations following 9 variables. YEARN numeric vector indicating time point (year) ecosystem     function recording measured PLOT numeric vector indicating ID experimental unit observation recorded G1 numeric vector ranging 0 1, proportion species G1 G2 numeric vector ranging 0 1, proportion species G2 L1 numeric vector ranging 0 1, proportion species L1 L2 numeric vector ranging 0 1, proportion species L2 DENS vector factors two levels, -1 1, representing seeding density plot Var character vector indicating ecosystem function recorded Y numeric vector indicating value ecosystem function recorded","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The multivariate Belgium dataset — Belgium_MV","text":"Data comes single site wider agrodiversity experiment conducted Belgium, established 2002.  four species used Lolium perenne (G1), Phleum pratense (G2), Trifolium pratense (L1), Trifolium repens (L2). two recommended functional groupings: grouping grasses (G1, G2) legumes (L1, L2), grouping fast-establishing species (G1, L1) temporally persistent species (G2, L2).  Three ecosystem functions recorded summing recordings multiple harvests years experiment: (1) aboveground biomass sown species (Sown) (t DM ha-1), (2) aboveground biomass weed species (Weed) (t DM ha-1) (3) total annual yield nitrogen harvested aboveground biomass (N) (t DM ha-1). linear transformation response applied value 'Y', now represent percentage top 10% recorded values function, .e., response multiplied 100, divided mean top three readings.  dataset extracted dataset 'Belgium'.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The multivariate Belgium dataset — Belgium_MV","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The multivariate Belgium dataset — Belgium_MV","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_MV.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The multivariate Belgium dataset — Belgium_MV","text":"","code":"#How to extra and transform the data from the 'Belgium' dataset  ## Libraries ################################################ library(reshape2) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union library(DImodelsMulti) ############################################################# ## Read in data################################## data(\"Belgium\")  Belgium_MV <- Belgium[which(Belgium$YEARN == 3), ]  #Top 3 values for each ecosystem function top <- Belgium_MV %>%   arrange(desc(Y)) %>%   group_by(Var) %>%   slice(1:3)  #Divide by average of top values top <- aggregate(Y ~ Var, data = top, FUN = \"mean\") Belgium_MV$Y <- 100*Belgium_MV$Y  #Sown condition <- which(Belgium_MV$Var == \"Sown\") Belgium_MV$Y[condition] <- Belgium_MV$Y[condition] /   top[1, \"Y\"]  #N condition <- which(Belgium_MV$Var == \"N\") Belgium_MV$Y[condition] <- Belgium_MV$Y[condition] /   top[2, \"Y\"]  #Weed condition <- which(Belgium_MV$Var == \"Weed\") Belgium_MV$Y[condition] <- Belgium_MV$Y[condition] /   top[3, \"Y\"]   Belgium_MV #>     YEARN PLOT DENS   G1   G2   L1   L2  Var         Y #> 3       3   12 High 1.00 0.00 0.00 0.00 Sown  97.28529 #> 6       3   27  Low 1.00 0.00 0.00 0.00 Sown  85.30130 #> 9       3   13 High 0.00 1.00 0.00 0.00 Sown 109.38330 #> 12      3   28  Low 0.00 1.00 0.00 0.00 Sown 104.85410 #> 15      3   14 High 0.00 0.00 1.00 0.00 Sown 111.79308 #> 18      3   29  Low 0.00 0.00 1.00 0.00 Sown 104.84389 #> 21      3    1 High 0.70 0.10 0.10 0.10 Sown 147.27697 #> 24      3   16  Low 0.70 0.10 0.10 0.10 Sown 128.27171 #> 27      3    6 High 0.40 0.40 0.10 0.10 Sown 146.85606 #> 30      3   21  Low 0.40 0.40 0.10 0.10 Sown 147.96639 #> 33      3    2 High 0.10 0.70 0.10 0.10 Sown 137.97764 #> 36      3   17  Low 0.10 0.70 0.10 0.10 Sown 143.39015 #> 39      3    7 High 0.40 0.10 0.40 0.10 Sown 131.38370 #> 42      3   22  Low 0.40 0.10 0.40 0.10 Sown 142.80896 #> 45      3    9 High 0.10 0.40 0.40 0.10 Sown 140.76013 #> 48      3   24  Low 0.10 0.40 0.40 0.10 Sown 136.03128 #> 51      3    3 High 0.10 0.10 0.70 0.10 Sown 152.90260 #> 54      3   18  Low 0.10 0.10 0.70 0.10 Sown 147.25813 #> 57      3    5 High 0.25 0.25 0.25 0.25 Sown 140.51727 #> 60      3   20  Low 0.25 0.25 0.25 0.25 Sown 147.04639 #> 63      3    8 High 0.40 0.10 0.10 0.40 Sown 140.15944 #> 66      3   23  Low 0.40 0.10 0.10 0.40 Sown 153.93166 #> 69      3   10 High 0.10 0.40 0.10 0.40 Sown 128.04480 #> 72      3   25  Low 0.10 0.40 0.10 0.40 Sown 141.35070 #> 75      3   11 High 0.10 0.10 0.40 0.40 Sown 148.07851 #> 78      3   26  Low 0.10 0.10 0.40 0.40 Sown 134.12903 #> 81      3    4 High 0.10 0.10 0.10 0.70 Sown 150.12933 #> 84      3   19  Low 0.10 0.10 0.10 0.70 Sown 137.59442 #> 87      3   15 High 0.00 0.00 0.00 1.00 Sown  33.45700 #> 90      3   30  Low 0.00 0.00 0.00 1.00 Sown  16.70037 #> 91      3   12 High 1.00 0.00 0.00 0.00    N  42.33555 #> 92      3   27  Low 1.00 0.00 0.00 0.00    N  48.12690 #> 93      3   13 High 0.00 1.00 0.00 0.00    N  36.45611 #> 94      3   28  Low 0.00 1.00 0.00 0.00    N  39.37299 #> 95      3   14 High 0.00 0.00 1.00 0.00    N  66.34598 #> 96      3   29  Low 0.00 0.00 1.00 0.00    N  64.22847 #> 97      3    1 High 0.70 0.10 0.10 0.10    N  48.13995 #> 98      3   16  Low 0.70 0.10 0.10 0.10    N  44.52076 #> 99      3    6 High 0.40 0.40 0.10 0.10    N  51.25177 #> 100     3   21  Low 0.40 0.40 0.10 0.10    N  45.23530 #> 101     3    2 High 0.10 0.70 0.10 0.10    N  50.11961 #> 102     3   17  Low 0.10 0.70 0.10 0.10    N  43.80623 #> 103     3    7 High 0.40 0.10 0.40 0.10    N  55.71274 #> 104     3   22  Low 0.40 0.10 0.40 0.10    N  53.72819 #> 105     3    9 High 0.10 0.40 0.40 0.10    N  50.46709 #> 106     3   24  Low 0.10 0.40 0.40 0.10    N  48.34876 #> 107     3    3 High 0.10 0.10 0.70 0.10    N  52.66698 #> 108     3   18  Low 0.10 0.10 0.70 0.10    N  58.48606 #> 109     3    5 High 0.25 0.25 0.25 0.25    N  48.64893 #> 110     3   20  Low 0.25 0.25 0.25 0.25    N  46.74758 #> 111     3    8 High 0.40 0.10 0.10 0.40    N  43.63004 #> 112     3   23  Low 0.40 0.10 0.10 0.40    N  49.49969 #> 113     3   10 High 0.10 0.40 0.10 0.40    N  46.93355 #> 114     3   25  Low 0.10 0.40 0.10 0.40    N  51.18815 #> 115     3   11 High 0.10 0.10 0.40 0.40    N  46.90908 #> 116     3   26  Low 0.10 0.10 0.40 0.40    N  56.71195 #> 117     3    4 High 0.10 0.10 0.10 0.70    N  50.23462 #> 118     3   19  Low 0.10 0.10 0.10 0.70    N  47.69458 #> 119     3   15 High 0.00 0.00 0.00 1.00    N  62.05794 #> 120     3   30  Low 0.00 0.00 0.00 1.00    N  66.37779 #> 121     3   12 High 1.00 0.00 0.00 0.00 Weed  90.23570 #> 122     3   27  Low 1.00 0.00 0.00 0.00 Weed  95.69545 #> 123     3   13 High 0.00 1.00 0.00 0.00 Weed  99.76610 #> 124     3   28  Low 0.00 1.00 0.00 0.00 Weed  99.83487 #> 125     3   14 High 0.00 0.00 1.00 0.00 Weed  96.80273 #> 126     3   29  Low 0.00 0.00 1.00 0.00 Weed  81.37624 #> 127     3    1 High 0.70 0.10 0.10 0.10 Weed 100.00000 #> 128     3   16  Low 0.70 0.10 0.10 0.10 Weed 100.00000 #> 129     3    6 High 0.40 0.40 0.10 0.10 Weed  94.96939 #> 130     3   21  Low 0.40 0.40 0.10 0.10 Weed 100.00000 #> 131     3    2 High 0.10 0.70 0.10 0.10 Weed 100.00000 #> 132     3   17  Low 0.10 0.70 0.10 0.10 Weed 100.00000 #> 133     3    7 High 0.40 0.10 0.40 0.10 Weed  99.99467 #> 134     3   22  Low 0.40 0.10 0.40 0.10 Weed 100.00000 #> 135     3    9 High 0.10 0.40 0.40 0.10 Weed 100.00000 #> 136     3   24  Low 0.10 0.40 0.40 0.10 Weed 100.00000 #> 137     3    3 High 0.10 0.10 0.70 0.10 Weed 100.00000 #> 138     3   18  Low 0.10 0.10 0.70 0.10 Weed 100.00000 #> 139     3    5 High 0.25 0.25 0.25 0.25 Weed  99.96881 #> 140     3   20  Low 0.25 0.25 0.25 0.25 Weed  99.64182 #> 141     3    8 High 0.40 0.10 0.10 0.40 Weed  92.23312 #> 142     3   23  Low 0.40 0.10 0.10 0.40 Weed 100.00000 #> 143     3   10 High 0.10 0.40 0.10 0.40 Weed 100.00000 #> 144     3   25  Low 0.10 0.40 0.10 0.40 Weed 100.00000 #> 145     3   11 High 0.10 0.10 0.40 0.40 Weed  99.83170 #> 146     3   26  Low 0.10 0.10 0.40 0.40 Weed  98.73048 #> 147     3    4 High 0.10 0.10 0.10 0.70 Weed 100.00000 #> 148     3   19  Low 0.10 0.10 0.10 0.70 Weed  99.75334 #> 149     3   15 High 0.00 0.00 0.00 1.00 Weed  19.93108 #> 150     3   30  Low 0.00 0.00 0.00 1.00 Weed   0.00000"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":null,"dir":"Reference","previous_headings":"","what":"The repeated measures Belgium dataset — Belgium_RM","title":"The repeated measures Belgium dataset — Belgium_RM","text":"Single site dataset containing thirty experimental units (plots), four species seeded two density levels, representing fifteen communities. single ecosystem function response recorded plot three years. responses linearly transformed lie percentage scale. Data stacked format.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The repeated measures Belgium dataset — Belgium_RM","text":"","code":"data(\"Belgium_RM\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The repeated measures Belgium dataset — Belgium_RM","text":"data frame 150 observations following 9 variables. YEARN numeric vector indicating time point (year) ecosystem     function recording measured PLOT numeric vector indicating ID experimental unit observation recorded G1 numeric vector ranging 0 1, proportion species G1 G2 numeric vector ranging 0 1, proportion species G2 L1 numeric vector ranging 0 1, proportion species L1 L2 numeric vector ranging 0 1, proportion species L2 DENS vector factors two levels, -1 1, representing seeding density plot Var character vector indicating ecosystem function recorded Y numeric vector indicating value ecosystem function recorded","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The repeated measures Belgium dataset — Belgium_RM","text":"Data comes single site wider agrodiversity experiment conducted Belgium, established 2002.  four species used Lolium perenne (G1), Phleum pratense (G2), Trifolium pratense (L1), Trifolium repens (L2). two recommended functional groupings: grouping grasses (G1, G2) legumes (L1, L2), grouping fast-establishing species (G1, L1) temporally persistent species (G2, L2).  ecosystem function (aboveground biomass sown species (Sown) (t DM ha-1)) recorded summing recordings multiple harvests years experiment. linear transformation response applied value 'Y', now represents percentage top 10% recorded values, .e., response multiplied 100, divided mean top nine readings.  dataset extracted dataset 'Belgium'.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The repeated measures Belgium dataset — Belgium_RM","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The repeated measures Belgium dataset — Belgium_RM","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/Belgium_RM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The repeated measures Belgium dataset — Belgium_RM","text":"","code":"#How to extra and transform the data from the 'Belgium' dataset  ## Libraries ################################################ library(reshape2) library(dplyr) library(DImodelsMulti) ############################################################# ## Read in data################################## data(\"Belgium\") ############################################################# ## Standardise responses for Analysis 1 (RM) ################# Belgium_RM <- Belgium #Top 9 values top <- Belgium_RM %>%   arrange(desc(Y)) %>%   group_by(Var) %>%   slice(1:9) #Average of top values top <- aggregate(Y ~ Var, data = top, FUN = \"mean\")  Belgium_RM$Y <- 100*Belgium_RM$Y  #Sown condition <- which(Belgium_RM$Var == \"Sown\") Belgium_RM$Y[condition] <- Belgium_RM$Y[condition] /   top[1, \"Y\"]  #Subset to just the Sown response Belgium_RM <- Belgium_RM[which(Belgium_RM$Var == \"Sown\"), ]   Belgium_RM #>    YEARN PLOT DENS   G1   G2   L1   L2  Var         Y #> 1      1   12 High 1.00 0.00 0.00 0.00 Sown  87.44931 #> 2      2   12 High 1.00 0.00 0.00 0.00 Sown  80.42454 #> 3      3   12 High 1.00 0.00 0.00 0.00 Sown 107.17870 #> 4      1   27  Low 1.00 0.00 0.00 0.00 Sown  99.65902 #> 5      2   27  Low 1.00 0.00 0.00 0.00 Sown  96.56732 #> 6      3   27  Low 1.00 0.00 0.00 0.00 Sown  93.97601 #> 7      1   13 High 0.00 1.00 0.00 0.00 Sown  83.24496 #> 8      2   13 High 0.00 1.00 0.00 0.00 Sown 113.10767 #> 9      3   13 High 0.00 1.00 0.00 0.00 Sown 120.50702 #> 10     1   28  Low 0.00 1.00 0.00 0.00 Sown  70.69485 #> 11     2   28  Low 0.00 1.00 0.00 0.00 Sown 109.60502 #> 12     3   28  Low 0.00 1.00 0.00 0.00 Sown 115.51723 #> 13     1   14 High 0.00 0.00 1.00 0.00 Sown 124.33131 #> 14     2   14 High 0.00 0.00 1.00 0.00 Sown 168.53835 #> 15     3   14 High 0.00 0.00 1.00 0.00 Sown 123.16186 #> 16     1   29  Low 0.00 0.00 1.00 0.00 Sown 118.45355 #> 17     2   29  Low 0.00 0.00 1.00 0.00 Sown 147.33609 #> 18     3   29  Low 0.00 0.00 1.00 0.00 Sown 115.50598 #> 19     1    1 High 0.70 0.10 0.10 0.10 Sown 160.64814 #> 20     2    1 High 0.70 0.10 0.10 0.10 Sown 179.02140 #> 21     3    1 High 0.70 0.10 0.10 0.10 Sown 162.25429 #> 22     1   16  Low 0.70 0.10 0.10 0.10 Sown 135.07897 #> 23     2   16  Low 0.70 0.10 0.10 0.10 Sown 182.43164 #> 24     3   16  Low 0.70 0.10 0.10 0.10 Sown 141.31629 #> 25     1    6 High 0.40 0.40 0.10 0.10 Sown 131.70721 #> 26     2    6 High 0.40 0.40 0.10 0.10 Sown 177.69451 #> 27     3    6 High 0.40 0.40 0.10 0.10 Sown 161.79057 #> 28     1   21  Low 0.40 0.40 0.10 0.10 Sown 134.88313 #> 29     2   21  Low 0.40 0.40 0.10 0.10 Sown 173.43763 #> 30     3   21  Low 0.40 0.40 0.10 0.10 Sown 163.01382 #> 31     1    2 High 0.10 0.70 0.10 0.10 Sown 127.31889 #> 32     2    2 High 0.10 0.70 0.10 0.10 Sown 183.10781 #> 33     3    2 High 0.10 0.70 0.10 0.10 Sown 152.00926 #> 34     1   17  Low 0.10 0.70 0.10 0.10 Sown 117.74664 #> 35     2   17  Low 0.10 0.70 0.10 0.10 Sown 166.21709 #> 36     3   17  Low 0.10 0.70 0.10 0.10 Sown 157.97219 #> 37     1    7 High 0.40 0.10 0.40 0.10 Sown 152.60986 #> 38     2    7 High 0.40 0.10 0.40 0.10 Sown 186.00376 #> 39     3    7 High 0.40 0.10 0.40 0.10 Sown 144.74475 #> 40     1   22  Low 0.40 0.10 0.40 0.10 Sown 143.00579 #> 41     2   22  Low 0.40 0.10 0.40 0.10 Sown 186.88097 #> 42     3   22  Low 0.40 0.10 0.40 0.10 Sown 157.33190 #> 43     1    9 High 0.10 0.40 0.40 0.10 Sown 128.04326 #> 44     2    9 High 0.10 0.40 0.40 0.10 Sown 193.09648 #> 45     3    9 High 0.10 0.40 0.40 0.10 Sown 155.07472 #> 46     1   24  Low 0.10 0.40 0.40 0.10 Sown 128.53674 #> 47     2   24  Low 0.10 0.40 0.40 0.10 Sown 177.63092 #> 48     3   24  Low 0.10 0.40 0.40 0.10 Sown 149.86497 #> 49     1    3 High 0.10 0.10 0.70 0.10 Sown 149.45721 #> 50     2    3 High 0.10 0.10 0.70 0.10 Sown 176.45823 #> 51     3    3 High 0.10 0.10 0.70 0.10 Sown 168.45201 #> 52     1   18  Low 0.10 0.10 0.70 0.10 Sown 133.03722 #> 53     2   18  Low 0.10 0.10 0.70 0.10 Sown 179.57537 #> 54     3   18  Low 0.10 0.10 0.70 0.10 Sown 162.23353 #> 55     1    5 High 0.25 0.25 0.25 0.25 Sown 145.38963 #> 56     2    5 High 0.25 0.25 0.25 0.25 Sown 185.73949 #> 57     3    5 High 0.25 0.25 0.25 0.25 Sown 154.80716 #> 58     1   20  Low 0.25 0.25 0.25 0.25 Sown 144.84636 #> 59     2   20  Low 0.25 0.25 0.25 0.25 Sown 175.97434 #> 60     3   20  Low 0.25 0.25 0.25 0.25 Sown 162.00025 #> 61     1    8 High 0.40 0.10 0.10 0.40 Sown 139.80615 #> 62     2    8 High 0.40 0.10 0.10 0.40 Sown 189.06078 #> 63     3    8 High 0.40 0.10 0.10 0.40 Sown 154.41294 #> 64     1   23  Low 0.40 0.10 0.10 0.40 Sown 137.39378 #> 65     2   23  Low 0.40 0.10 0.10 0.40 Sown 176.54789 #> 66     3   23  Low 0.40 0.10 0.10 0.40 Sown 169.58572 #> 67     1   10 High 0.10 0.40 0.10 0.40 Sown 120.43205 #> 68     2   10 High 0.10 0.40 0.10 0.40 Sown 176.64443 #> 69     3   10 High 0.10 0.40 0.10 0.40 Sown 141.06631 #> 70     1   25  Low 0.10 0.40 0.10 0.40 Sown 114.26796 #> 71     2   25  Low 0.10 0.40 0.10 0.40 Sown 171.26852 #> 72     3   25  Low 0.10 0.40 0.10 0.40 Sown 155.72534 #> 73     1   11 High 0.10 0.10 0.40 0.40 Sown 132.78575 #> 74     2   11 High 0.10 0.10 0.40 0.40 Sown 174.27806 #> 75     3   11 High 0.10 0.10 0.40 0.40 Sown 163.13734 #> 76     1   26  Low 0.10 0.10 0.40 0.40 Sown 131.43052 #> 77     2   26  Low 0.10 0.10 0.40 0.40 Sown 174.52577 #> 78     3   26  Low 0.10 0.10 0.40 0.40 Sown 147.76927 #> 79     1    4 High 0.10 0.10 0.10 0.70 Sown 127.27669 #> 80     2    4 High 0.10 0.10 0.10 0.70 Sown 171.65712 #> 81     3    4 High 0.10 0.10 0.10 0.70 Sown 165.39671 #> 82     1   19  Low 0.10 0.10 0.10 0.70 Sown 135.86455 #> 83     2   19  Low 0.10 0.10 0.10 0.70 Sown 167.26133 #> 84     3   19  Low 0.10 0.10 0.10 0.70 Sown 151.58707 #> 85     1   15 High 0.00 0.00 0.00 1.00 Sown  66.75652 #> 86     2   15 High 0.00 0.00 0.00 1.00 Sown  67.65311 #> 87     3   15 High 0.00 0.00 0.00 1.00 Sown  36.85941 #> 88     1   30  Low 0.00 0.00 0.00 1.00 Sown  79.37764 #> 89     2   30  Low 0.00 0.00 0.00 1.00 Sown  65.64431 #> 90     3   30  Low 0.00 0.00 0.00 1.00 Sown  18.39871"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImodelsMulti.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate Diversity-Interactions (DI) Models with Repeated Measures — DImodelsMulti","title":"Multivariate Diversity-Interactions (DI) Models with Repeated Measures — DImodelsMulti","text":"package add-'DImodels' package (Moral et al., 2023). enables fitting Diversity-Interactions (DI) models (1) univariate repeated measures responses(Finn et al., 2013), (2) multivariate responses single point time (Dooley et al., 2015), (3) multivariate repeated measures responses. responses come biodiversity ecosystem function (BEF) relationship study aims test relationship ecosystem functioning ecosystem design, including species identities, interactions, additional factors treatments time. data can used construct regression model main function package DImulti.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImodelsMulti.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multivariate Diversity-Interactions (DI) Models with Repeated Measures — DImodelsMulti","text":"Data package intended use data containing multiple ecosystem function responses /time points biodiversity ecosystem function (BEF) relationship study. dataset contain column species' proportion, row columns sum one. row data also contain identifier experimental unit referenced, identifiers must unique experimental unit, remain consistent time across functions. experimental unit included must recordings either:  - single community level ecosystem function response variable taken multiple time points (repeated measures),  - multiple community level ecosystem function responses (multivariate),  - multiple community level ecosystem function responses taken multiple time points (multivariate repeated measures).  Ecosystem functions may stored long wide format repeated measures must stored long format. Introduction multivariate & repeated measures Diversity-Interactions models Diversity-Interactions (DI) models regression based approach modelling biodiversity ecosystem function (BEF) relationship assumes main driver behind changes ecosystem functioning initial relative abundance (proportions) species present. models can estimated using least squares estimation methods.  example univariate DI model can seen ,  $$ y =  \\sum^{S}_{=1}{\\beta_{} p_{}} +  \\sum^{S}_{\\substack{,j=1 \\\\ <j}}{\\delta_{ij}(p_{}p_{j})^{\\theta} + \\alpha + \\epsilon }$$ response \\(y\\) represents recorded ecosystem function, \\(p_{}\\) represents initial proportion \\(^{th}\\) species, therefore \\(p\\) values sum 1 form simplex space, scales ID effect species, \\(\\beta_{}\\); species interactions treatments required model, response \\(y\\) weighted average species identity effects. \\(S\\) represents number unique species present study. Similarly ID effect, interaction effect, \\(\\delta\\), species scaled combination products species proportions, depends interaction structure chosen. example shows full pairwise structure, unique interaction term, \\(\\delta_{ij}\\), per pair species \\(\\) & \\(j\\). nonlinear term \\(\\theta\\) (Connolly et al., 2013; Vishwakarma et al., 2023) included model allow shape BEF relationship change. parameter can estimated using profile log-likelihood optimisation (Brent, 1973) can assigned set value based priori assumption/knowledge. \\(\\) may include blocks treatment terms, \\(\\alpha\\) vector corresponding effect coefficients.  details univariate DI modelling, see ?DImodels, Kirwan et al., 2009, Moral et al., 2023. multivariate DI model (Dooley et al., 2015) extends DI modelling framework allow estimation multiple ecosystem functions simultaneously, accounting existing covariance functions error term. models can extended introduction repeated measures multiple time points.  structure models : $$ y_{kmt} =  \\sum^{S}_{=1}{\\beta_{ikt} p_{im}} + \\sum^{S}_{\\substack{,j=1 \\\\ <j}}{\\delta_{ijkt}(p_{im}p_{jm})^{\\theta_{k}}} + \\alpha_{kt}+ \\epsilon_{kmt} $$ \\(y_{kmt}\\) refers value \\(k^{th}\\) ecosystem function \\(m^{th}\\) experimental unit time point \\(t\\). experimental unit \\(m\\), \\(\\beta_{ikt}\\) scaled \\(p_{im}\\) expected contribution \\(^{th}\\) species \\(k^{th}\\) response time point \\(t\\) referred \\(^{th}\\) species' ID effect. value nonlinear parameter \\(\\theta\\) allowed vary ecosystem functions, turn allowing fixed effect structure change across functions, recognition nature species interactions change ecosystem functions. case dataset contains single ecosystem function, corresponding subscript \\(k\\) can simply removed equation, can said removal subscript \\(t\\) instance dataset contains single time point. structure error term univariate DI model, error term assumed follow normal distribution mean \\(0\\) variance \\(\\sigma^{2}\\). $$ \\epsilon \\sim N(0, \\sigma^{2})$$ model extended fit multivariate (\\(k>1\\)) /repeated measures (\\(t>1\\)) data, error term now assumed follow multivariate normal distribution mean \\(0\\) variance \\(\\Sigma^{*}\\). $$ \\epsilon \\sim MVN(0, \\Sigma^{*}) $$ \\(\\Sigma^{*}\\) block diagonal matrix, one \\(kt\\) x \\(kt\\) block, \\(\\Sigma\\), experimental unit \\(m\\). refer \\(\\Sigma\\) variance covariance matrix ecosystem functions time points. Typically, includes unique variance per combination ecosystem functions time points along diagonal unique covariance pair combinations -diagonal. Autocorrelation structures may implemented matrix \\(\\Sigma\\), either simplify estimation process based priori knowledge. One structure chosen ecosystem functions another repeated measures/time points, two matrices estimated independently combined using Kronecker product (\\(\\otimes\\)), matrix multiplication method. case data multivariate (\\(k>1\\) & \\(t=1\\)) repeated measures (\\(k=1\\) & \\(t>1\\)), one autocorrelation structure needs chosen, multiplication necessary.  Three structures currently available package repeated measures responses, two available multivariate responses: UN: element \\(\\Sigma\\) set estimate independently,  said unstructured follow general structure preferred option case  priori information nature relationships.  corSymm CS: simpler structure compound symmetry,  assumed ecosystem function time point variance value  \\(\\sigma^{2}\\) pair covariance value \\(\\sigma^{2}\\rho\\).  structure preferred use multiple ecosystem functions provides  meaningful interpretation, however allowed package model requires  simplification. corCompSymm AR(1): autocorrelation structure exclusive repeated measures data  autoregressive model order one, assumes , time point variance,  \\(\\sigma^{2}\\), distance pairs time points increases, covariance  changes factor \\(\\rho\\). corAR1","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImodelsMulti.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multivariate Diversity-Interactions (DI) Models with Repeated Measures — DImodelsMulti","text":"Vishwakarma, R., Byrne, L., Connolly, J., de Andrade Moral, R. Brophy, C., 2023.  Estimation non-linear parameter Generalised Diversity-Interactions models unaffected change structure interaction terms.  Environmental Ecological Statistics, 30(3), pp.555-574. Moral, R.., Vishwakarma, R., Connolly, J., Byrne, L., Hurley, C., Finn, J.. Brophy, C., 2023.  Going beyond richness: Modelling BEF relationship using species identity, evenness, richness species interactions via DImodels R package.  Methods Ecology Evolution, 14(9), pp.2250-2258. Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P. Cop, J., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Connolly, J., Bell, T., Bolger, T., Brophy, C., Carnus, T., Finn, J.., Kirwan, L., Isbell, F., Levine, J., Luscher, . Picasso, V., 2013.  improved model predict effects changing biodiversity levels ecosystem function.  Journal Ecology, 101(2), pp.344-355. Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038. Brent, R.P., 1973.  efficient algorithms solving systems nonlinear equations.  SIAM Journal Numerical Analysis, 10(2), pp.327-344.","code":""},{"path":[]},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImodelsMulti.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Multivariate Diversity-Interactions (DI) Models with Repeated Measures — DImodelsMulti","text":"Laura Byrne [aut, cre], Rishabh Vishwakarma [aut], Rafael de Andrade Moral [aut], Caroline Brophy [aut]  Maintainer: Laura Byrne byrnel54@tcd.ie","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImodelsMulti.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multivariate Diversity-Interactions (DI) Models with Repeated Measures — DImodelsMulti","text":"","code":"################################################################################################# ################################################################################################# #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE>  ## Modelling Examples  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # \\donttest{ vignette(\"DImulti_workflow\") #> Warning: vignette ‘DImulti_workflow’ not found # }  ## The simMVRM dataset # # This simulated dataset contains multiple ecosystem functions (k=3) and multiple time points # (t=2). The dataset was # simulated using unstructured Sigma matrices. # The true values can be found in the help file for the data, ?simMVRM  data(simMVRM) head(simMVRM) #>   plot p1 p2 p3 p4         Y1          Y2        Y3 time #> 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1 #> 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1 #> 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1 #> 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1 #> 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1 #> 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1  # We will start the analysis with a call to the package's main function, DImulti(). # We begin the call by specifying the column indices holding the initial species proportions # (p_i) through 'prop' and the columns which hold the ecosystem response values through 'y'. # Since our data is multivariate, we include the 'eco_func' parameter, specifying \"na\" as our # data is in a wide format (multiple columns in 'y') and \"un\" to fit an unstructured Sigma # for our ecosystem functions. # The data also contains repeated measures, so we include the 'time' parameter, specifying \"time\" # as the column containing the time point indicator for each row and \"ar1\" to fit an AR(1) # autocorrelation structure for our time points. # Next, we specify that the experimental unit identifier is in column 1 through 'unit_IDs'. We # indicate that we do not want to estimate the non-linear parameter theta, but do not provide # any values, opting for the default value of 1. # We specify a full pairwise (FULL) interaction structure through 'DImodel' and estimate the # model using maximum likelihood (ML) as we may compare models. # Finally, we provide the data object simMVRM through 'data'.  simModel_FULL <- DImulti(prop = 2:5, y = 6:8, eco_func = c(\"na\", \"un\"), time = c(\"time\", \"ar1\"),                          unit_IDs = 1, estimate_theta = FALSE, DImodel = \"FULL\", method = \"ML\",                          data = simMVRM)  # simModel_FULL is an object of custom class DImulti, which can be used with a number of S3 # methods and any method compatible with gls objects. We use summary() to examine the model fit, # including fixed effect coefficients and the variance covariance matrix Sigma.  print(simModel_FULL) #> Note:  #> Method Used = ML  #> Correlation Structure Used = un@ar1 #>  Full Pairwise Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + FULL.p1.p2 +      FULL.p1.p3 + FULL.p1.p4 + FULL.p2.p3 + FULL.p2.p4 + FULL.p3.p4))  #>       AIC       BIC    logLik  #>  7969.803  8311.945 -3923.902  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      #> 2  0.612        #> 3 -0.310 -0.360 #>  #>  Repeated Measure Correlation Structure: AR(1) #>  Formula: ~0 + as.numeric(time) | plot/func  #>  Parameter estimate(s): #>       Phi  #> 0.3184991  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                           Beta      Std. Error   t-value   p-value     Signif  #> ------------------------  --------  -----------  --------  ----------  ------- #> funcY1:time1:p1_ID        -1.750    0.535        -3.274    0.001078    **      #> funcY2:time1:p1_ID        +0.399    0.535        0.747     0.4554              #> funcY3:time1:p1_ID        +0.840    0.535        1.572     0.116               #> funcY1:time2:p1_ID        +0.454    0.535        0.850     0.3955              #> funcY2:time2:p1_ID        +3.122    0.535        5.840     6.095e-09   ***     #> funcY3:time2:p1_ID        -0.533    0.535        -0.998    0.3186              #> funcY1:time1:p2_ID        +5.054    0.458        11.029    1.751e-27   ***     #> funcY2:time1:p2_ID        +4.458    0.458        9.730     7.004e-22   ***     #> funcY3:time1:p2_ID        +6.544    0.458        14.281    4.378e-44   ***     #> funcY1:time2:p2_ID        +5.009    0.458        10.933    4.79e-27    ***     #> funcY2:time2:p2_ID        +2.706    0.458        5.907     4.108e-09   ***     #> funcY3:time2:p2_ID        +6.663    0.458        14.542    1.442e-45   ***     #> funcY1:time1:p3_ID        +2.764    0.534        5.177     2.483e-07   ***     #> funcY2:time1:p3_ID        -0.622    0.534        -1.166    0.2439              #> funcY3:time1:p3_ID        +3.171    0.534        5.939     3.388e-09   ***     #> funcY1:time2:p3_ID        +4.114    0.534        7.706     2.046e-14   ***     #> funcY2:time2:p3_ID        -3.673    0.534        -6.880    8.035e-12   ***     #> funcY3:time2:p3_ID        +2.792    0.534        5.230     1.879e-07   ***     #> funcY1:time1:p4_ID        -0.991    0.609        -1.629    0.1034              #> funcY2:time1:p4_ID        -0.123    0.609        -0.203    0.8395              #> funcY3:time1:p4_ID        +5.431    0.609        8.926     9.95e-19    ***     #> funcY1:time2:p4_ID        -2.586    0.609        -4.251    2.233e-05   ***     #> funcY2:time2:p4_ID        +1.808    0.609        2.971     0.003002    **      #> funcY3:time2:p4_ID        +3.969    0.609        6.523     8.772e-11   ***     #> funcY1:time1:FULL.p1.p2   +3.292    1.899        1.734     0.08309     +       #> funcY2:time1:FULL.p1.p2   +7.657    1.899        4.033     5.726e-05   ***     #> funcY3:time1:FULL.p1.p2   +6.776    1.899        3.569     0.0003675   ***     #> funcY1:time2:FULL.p1.p2   +32.544   1.899        17.140    1.844e-61   ***     #> funcY2:time2:FULL.p1.p2   +3.174    1.899        1.672     0.09473     +       #> funcY3:time2:FULL.p1.p2   +19.498   1.899        10.269    3.949e-24   ***     #> funcY1:time1:FULL.p1.p3   +3.232    1.955        1.653     0.09842     +       #> funcY2:time1:FULL.p1.p3   +6.802    1.955        3.480     0.0005128   ***     #> funcY3:time1:FULL.p1.p3   +7.057    1.955        3.610     0.0003136   ***     #> funcY1:time2:FULL.p1.p3   +33.570   1.955        17.173    1.114e-61   ***     #> funcY2:time2:FULL.p1.p3   +4.154    1.955        2.125     0.03371     *       #> funcY3:time2:FULL.p1.p3   +19.103   1.955        9.772     4.697e-22   ***     #> funcY1:time1:FULL.p1.p4   +4.977    2.231        2.231     0.0258      *       #> funcY2:time1:FULL.p1.p4   +9.175    2.231        4.113     4.072e-05   ***     #> funcY3:time1:FULL.p1.p4   +5.448    2.231        2.442     0.01469     *       #> funcY1:time2:FULL.p1.p4   +34.133   2.231        15.301    5.257e-50   ***     #> funcY2:time2:FULL.p1.p4   +3.481    2.231        1.560     0.1188              #> funcY3:time2:FULL.p1.p4   +18.009   2.231        8.073     1.185e-15   ***     #> funcY1:time1:FULL.p2.p3   +1.621    1.830        0.886     0.3757              #> funcY2:time1:FULL.p2.p3   +6.701    1.830        3.662     0.0002567   ***     #> funcY3:time1:FULL.p2.p3   +7.567    1.830        4.136     3.691e-05   ***     #> funcY1:time2:FULL.p2.p3   +35.388   1.830        19.339    2.158e-76   ***     #> funcY2:time2:FULL.p2.p3   +5.926    1.830        3.238     0.001222    **      #> funcY3:time2:FULL.p2.p3   +20.525   1.830        11.217    2.422e-28   ***     #> funcY1:time1:FULL.p2.p4   +1.686    1.953        0.863     0.3882              #> funcY2:time1:FULL.p2.p4   +8.136    1.953        4.165     3.245e-05   ***     #> funcY3:time1:FULL.p2.p4   +5.257    1.953        2.692     0.00717     **      #> funcY1:time2:FULL.p2.p4   +33.761   1.953        17.285    2.081e-62   ***     #> funcY2:time2:FULL.p2.p4   +5.241    1.953        2.683     0.007352    **      #> funcY3:time2:FULL.p2.p4   +17.665   1.953        9.044     3.533e-19   ***     #> funcY1:time1:FULL.p3.p4   +3.364    2.104        1.599     0.11                #> funcY2:time1:FULL.p3.p4   +9.872    2.104        4.692     2.898e-06   ***     #> funcY3:time1:FULL.p3.p4   +4.387    2.104        2.085     0.0372      *       #> funcY1:time2:FULL.p3.p4   +35.150   2.104        16.705    1.149e-58   ***     #> funcY2:time2:FULL.p3.p4   +6.951    2.104        3.304     0.0009714   ***     #> funcY3:time2:FULL.p3.p4   +18.366   2.104        8.729     5.416e-18   ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 2016 total; 1956 residual #> Residual standard error: 1.931155  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.8157  2.3236 -1.3479 #> [2,]  2.3236  2.9908 -1.2351 #> [3,] -1.3479 -1.2351  3.9281 #>   Standard Deviations: 2.1945 1.7294 1.982  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.5364 1.4449 #> [2,] 1.4449 4.5364 #>   Standard Deviations: 2.1299 2.1299  #>  #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.72940  1.18780  2.28330  0.72724 -1.15570 -0.36810 #> Y1:2  1.18780  3.72940  0.72724  2.28330 -0.36810 -1.15570 #> Y2:1  2.28330  0.72724  3.72940  1.18780 -1.34380 -0.42801 #> Y2:2  0.72724  2.28330  1.18780  3.72940 -0.42801 -1.34380 #> Y3:1 -1.15570 -0.36810 -1.34380 -0.42801  3.72940  1.18780 #> Y3:2 -0.36810 -1.15570 -0.42801 -1.34380  1.18780  3.72940 #>   Standard Deviations: 1.9312 1.9312 1.9312 1.9312 1.9312 1.9312  #>   # From this summary, we can see that there are many coefficients, a number of which are not # statistically significant at an # alpha level of 0.05, therefore this model may not be ideal for our data. We refit the model # using an average interaction structure instead as it reduces the number of interaction terms # to 1 per ecosystem function and time point.  simModel_AV <- DImulti(prop = 2:5, y = 6:8, eco_func = c(\"na\", \"un\"), time = c(\"time\", \"ar1\"),                        unit_IDs = 1, estimate_theta = FALSE, DImodel = \"AV\", method = \"ML\",                        data = simMVRM) print(simModel_AV) #> Note:  #> Method Used = ML  #> Correlation Structure Used = un@ar1 #>  Average Term Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + AV))  #>       AIC       BIC    logLik  #>  7921.064  8094.939 -3929.532  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      #> 2  0.612        #> 3 -0.310 -0.364 #>  #>  Repeated Measure Correlation Structure: AR(1) #>  Formula: ~0 + as.numeric(time) | plot/func  #>  Parameter estimate(s): #>       Phi  #> 0.3161191  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                      Beta      Std. Error   t-value   p-value      Signif  #> -------------------  --------  -----------  --------  -----------  ------- #> funcY1:time1:p1_ID   -1.407    0.402        -3.505    0.0004663    ***     #> funcY2:time1:p1_ID   +0.354    0.402        0.881     0.3787               #> funcY3:time1:p1_ID   +0.946    0.402        2.357     0.01852      *       #> funcY1:time2:p1_ID   +0.142    0.402        0.353     0.7238               #> funcY2:time2:p1_ID   +2.630    0.402        6.550     7.324e-11    ***     #> funcY3:time2:p1_ID   -0.552    0.402        -1.375    0.1692               #> funcY1:time1:p2_ID   +4.770    0.372        12.825    3.103e-36    ***     #> funcY2:time1:p2_ID   +4.273    0.372        11.489    1.258e-29    ***     #> funcY3:time1:p2_ID   +6.704    0.372        18.025    2.163e-67    ***     #> funcY1:time2:p2_ID   +4.976    0.372        13.379    3.759e-39    ***     #> funcY2:time2:p2_ID   +2.707    0.372        7.280     4.793e-13    ***     #> funcY3:time2:p2_ID   +6.806    0.372        18.299    3.007e-69    ***     #> funcY1:time1:p3_ID   +2.665    0.404        6.603     5.17e-11     ***     #> funcY2:time1:p3_ID   -0.766    0.404        -1.896    0.05804      +       #> funcY3:time1:p3_ID   +3.321    0.404        8.226     3.45e-16     ***     #> funcY1:time2:p3_ID   +4.394    0.404        10.884    7.756e-27    ***     #> funcY2:time2:p3_ID   -3.350    0.404        -8.299    1.913e-16    ***     #> funcY3:time2:p3_ID   +3.008    0.404        7.452     1.362e-13    ***     #> funcY1:time1:p4_ID   -0.900    0.453        -1.984    0.04736      *       #> funcY2:time1:p4_ID   +0.325    0.453        0.717     0.4733               #> funcY3:time1:p4_ID   +4.924    0.453        10.860    9.948e-27    ***     #> funcY1:time2:p4_ID   -2.504    0.453        -5.523    3.779e-08    ***     #> funcY2:time2:p4_ID   +2.019    0.453        4.453     8.941e-06    ***     #> funcY3:time2:p4_ID   +3.544    0.453        7.817     8.734e-15    ***     #> funcY1:time1:AV      +2.892    0.984        2.938     0.003339     **      #> funcY2:time1:AV      +7.938    0.984        8.066     1.246e-15    ***     #> funcY3:time1:AV      +6.184    0.984        6.284     4.055e-10    ***     #> funcY1:time2:AV      +34.080   0.984        34.628    5.753e-206   ***     #> funcY2:time2:AV      +4.827    0.984        4.904     1.014e-06    ***     #> funcY3:time2:AV      +18.944   0.984        19.249    7.598e-76    ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 2016 total; 1986 residual #> Residual standard error: 1.936361  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.8390  2.3374 -1.3561 #> [2,]  2.3374  3.0147 -1.2559 #> [3,] -1.3561 -1.2559  3.9495 #>   Standard Deviations: 2.1998 1.7363 1.9873  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.5575 1.4407 #> [2,] 1.4407 4.5575 #>   Standard Deviations: 2.1348 2.1348  #>  #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.74950  1.18530  2.29460  0.72537 -1.16310 -0.36768 #> Y1:2  1.18530  3.74950  0.72537  2.29460 -0.36768 -1.16310 #> Y2:1  2.29460  0.72537  3.74950  1.18530 -1.36470 -0.43139 #> Y2:2  0.72537  2.29460  1.18530  3.74950 -0.43139 -1.36470 #> Y3:1 -1.16310 -0.36768 -1.36470 -0.43139  3.74950  1.18530 #> Y3:2 -0.36768 -1.16310 -0.43139 -1.36470  1.18530  3.74950 #>   Standard Deviations: 1.9364 1.9364 1.9364 1.9364 1.9364 1.9364  #>   # This model looks like it is a better fit, with less insignificant terms, but we can test this # formally using a likelihood ratio test, as the DImodels interaction structures are nested in # nature (with the exception of \"ADD\" and \"FG\", which are on the same level in the nesting # hierarchy). # This will test the null hypothesis that the likelihood of the two models do not significantly # differ, in other words, the added parameters of the more complex model are not worth it.  anova(simModel_FULL, simModel_AV) #>               Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> simModel_FULL     1 61 7969.803 8311.945 -3923.902                         #> simModel_AV       2 31 7921.064 8094.939 -3929.532 1 vs 2 11.26025  0.9992  # As the p-value is greater than our selected alpha value (0.05), we fail to reject the null # hypothesis and so continue with the simpler model, simModel_AV. # We can confirm this result by using information criteria such as AIC or BIC. # We select the model with the lower value as it indicates a better fit. # We use the second order versions of AIC and BIC (AICc and BICc) as we have a large number of # terms, which can cause AIC and BIC to favour more complex models.  AICc(simModel_FULL); AICc(simModel_AV) #> [1] 7975.676 #> [1] 7924.065 BICc(simModel_FULL); BICc(simModel_AV) #> [1] 8326.672 #> [1] 8098.743  # We refit our chosen model using the REML estimation method to have unbiased estimates.  simModel_AV <- DImulti(prop = 2:5, y = 6:8, eco_func = c(\"na\", \"un\"), time = c(\"time\", \"ar1\"),                        unit_IDs = 1, estimate_theta = FALSE, DImodel = \"AV\", method = \"REML\",                        data = simMVRM)  # We can now examine the variance covariance matrix, Sigma, and the fixed effect coefficients, # which can be retrieved from our initial summary() check or individually.  coef(simModel_AV) #> funcY1:time1:p1_ID funcY2:time1:p1_ID funcY3:time1:p1_ID funcY1:time2:p1_ID  #>         -1.4073525          0.3535514          0.9463605          0.1419124  #> funcY2:time2:p1_ID funcY3:time2:p1_ID funcY1:time1:p2_ID funcY2:time1:p2_ID  #>          2.6296879         -0.5521430          4.7699282          4.2730527  #> funcY3:time1:p2_ID funcY1:time2:p2_ID funcY2:time2:p2_ID funcY3:time2:p2_ID  #>          6.7037708          4.9758685          2.7074546          6.8055585  #> funcY1:time1:p3_ID funcY2:time1:p3_ID funcY3:time1:p3_ID funcY1:time2:p3_ID  #>          2.6653214         -0.7655644          3.3207690          4.3935222  #> funcY2:time2:p3_ID funcY3:time2:p3_ID funcY1:time1:p4_ID funcY2:time1:p4_ID  #>         -3.3501635          3.0082933         -0.8997879          0.3252207  #> funcY3:time1:p4_ID funcY1:time2:p4_ID funcY2:time2:p4_ID funcY3:time2:p4_ID  #>          4.9242752         -2.5041979          2.0191631          3.5443872  #>    funcY1:time1:AV    funcY2:time1:AV    funcY3:time1:AV    funcY1:time2:AV  #>          2.8917739          7.9381038          6.1841587         34.0798392  #>    funcY2:time2:AV    funcY3:time2:AV  #>          4.8267227         18.9444801  simModel_AV$vcov #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.80690  1.20340  2.33020  0.73662 -1.18210 -0.37368 #> Y1:2  1.20340  3.80690  0.73662  2.33020 -0.37368 -1.18210 #> Y2:1  2.33020  0.73662  3.80690  1.20340 -1.38640 -0.43828 #> Y2:2  0.73662  2.33020  1.20340  3.80690 -0.43828 -1.38640 #> Y3:1 -1.18210 -0.37368 -1.38640 -0.43828  3.80690  1.20340 #> Y3:2 -0.37368 -1.18210 -0.43828 -1.38640  1.20340  3.80690 #>   Standard Deviations: 1.9511 1.9511 1.9511 1.9511 1.9511 1.9511  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.9140  2.3738 -1.3783 #> [2,]  2.3738  3.0605 -1.2758 #> [3,] -1.3783 -1.2758  4.0093 #>   Standard Deviations: 2.2168 1.7494 2.0023  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.6263 1.4625 #> [2,] 1.4625 4.6263 #>   Standard Deviations: 2.1509 2.1509  #>   # An example of what we can infer from this is that ecosystem functions Y1 and Y2 have a positive # covariance at time 1, while Y3 has a negative covariance with both Y1 and Y2 at the same time # point. This means that maximising Y1 would not negatively impact Y2 but it would be at the cost # of Y3. However, as our interaction term is positive and significant at this time point for all # three ecosystem functions, we should be able to include a mixture of species that have positive # ID effects for each response to help mitigate this trade-off. # We can also predict from the model if we want to compare responses from different conditions, # even those not included in the original data.  predict(simModel_AV, newdata = simMVRM[which(simMVRM$plot == 1:2), ]) #>    plot     Yvalue Ytype #> 1     1 -1.4073525  Y1:1 #> 2     1  0.1419124  Y1:2 #> 3     1  0.3535514  Y2:1 #> 4     1  2.6296879  Y2:2 #> 5     1  0.9463605  Y3:1 #> 6     1 -0.5521430  Y3:2 #> 7     2 -1.4073525  Y1:1 #> 8     2  0.1419124  Y1:2 #> 9     2  0.3535514  Y2:1 #> 10    2  2.6296879  Y2:2 #> 11    2  0.9463605  Y3:1 #> 12    2 -0.5521430  Y3:2   ################################################################################################# ## The Belgium dataset # # This real world dataset contains multiple ecosystem functions (k=3) at a single time point # (t=1). The dataset also contains seeding density as a treatment in the form of a factor with # two levels (1, -1). More detail can be found at ?dataBEL.  data(dataBEL) head(dataBEL) #>   Plot  G1  G2  L1  L2 Density  Var VarNum       Y #> 1    1 0.7 0.1 0.1 0.1       1 Sown      1 104.156 #> 2    1 0.7 0.1 0.1 0.1       1 Weed      2 100.058 #> 3    1 0.7 0.1 0.1 0.1       1    N      3  87.996 #> 4    2 0.1 0.7 0.1 0.1       1 Sown      1  82.547 #> 5    2 0.1 0.7 0.1 0.1       1 Weed      2  89.801 #> 6    2 0.1 0.7 0.1 0.1       1    N      3  72.239  # We begin with the main function DImulti(), passing the initial species proportions column names # through 'prop' and the response value column name through 'y'. # As the data is in a long or stacked format, we specify the ecosystem function type through the # first index of the 'eco_func' parameter, along with specifying that we want an unstructured # Sigma for these response types. # The experimental unit ID is stored in the column \"Plot\" and so we pass this to 'unit_IDs'. # Rather than estimating the nonlinear parameter theta, we opt to provide a value for each # ecosystem function type through the parameter 'theta', which will be applied to the # interaction terms as a power. In this case, we use functional group (FG) interactions, which # requires an additional argument FG to be provided, specifying which group each species present # in 'prop' belongs to. In this case, we group the grasses and the legumes. # We include the treatment Density as an additional fixed effect. # We opt to use the REML estimation method as we will not be doing any model comparisons. # Finally, we specify the data object, dataBEL, through 'data'.  belModel <- DImulti(prop = c(\"G1\", \"G2\", \"L1\", \"L2\"), y = \"Y\", eco_func = c(\"Var\", \"un\"),                     unit_IDs = \"Plot\", theta = c(0.5, 1, 1.2), DImodel = \"FG\",                     FG = c(\"Grass\", \"Grass\", \"Legume\", \"Legume\"), extra_fixed = ~ Density,                     method = \"REML\", data = dataBEL)  # We can now print the output from our model, stored in belModel with class DImulti.  print(belModel) #> Note:  #> Method Used = REML  #> Correlation Structure Used = un #>  Functional Group Model #> Theta value(s) = N:0.5, Sown:1, Weed:1.2 #>  #> Generalized least squares fit by REML #>   Model: Y ~ 0 + Var:((G1_ID + G2_ID + L1_ID + L2_ID + FG.bfg_Grass_Legume +      FG.wfg_Grass + FG.wfg_Legume) + Density)  #>       AIC       BIC    logLik  #>  488.8132  554.5029 -214.4066  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | Plot  #>  Parameter estimate(s): #>  Correlation:  #>   1     2     #> 2 0.797       #> 3 0.065 0.523 #>  #>  #> Table: Fixed Effect Coefficients #>  #>                               Beta       Std. Error   t-value   p-value     Signif  #> ----------------------------  ---------  -----------  --------  ----------  ------- #> VarN:G1_ID                    +44.867    4.209        10.661    5.433e-16   ***     #> VarSown:G1_ID                 +65.337    4.656        14.033    1.745e-21   ***     #> VarWeed:G1_ID                 +79.372    9.039        8.781     1.065e-12   ***     #> VarN:G2_ID                    +28.926    4.209        6.873     2.722e-09   ***     #> VarSown:G2_ID                 +46.808    4.656        10.053    6.096e-15   ***     #> VarWeed:G2_ID                 +90.654    9.039        10.029    6.706e-15   ***     #> VarN:L1_ID                    +98.246    4.209        23.344    1.322e-33   ***     #> VarSown:L1_ID                 +76.396    4.656        16.408    5.561e-25   ***     #> VarWeed:L1_ID                 +50.032    9.039        5.535     5.782e-07   ***     #> VarN:L2_ID                    +77.067    4.209        18.312    1.438e-27   ***     #> VarSown:L2_ID                 +51.062    4.656        10.967    1.629e-16   ***     #> VarWeed:L2_ID                 +33.951    9.039        3.756     0.0003674   ***     #> VarN:FG.bfg_Grass_Legume      +14.538    13.281       1.095     0.2777              #> VarSown:FG.bfg_Grass_Legume   +86.492    18.699       4.625     1.796e-05   ***     #> VarWeed:FG.bfg_Grass_Legume   +152.157   49.542       3.071     0.003095    **      #> VarN:FG.wfg_Grass             +58.483    28.072       2.083     0.0411      *       #> VarSown:FG.wfg_Grass          +107.670   41.360       2.603     0.0114      *       #> VarWeed:FG.wfg_Grass          -9.702     108.079      -0.090    0.9287              #> VarN:FG.wfg_Legume            -16.215    28.072       -0.578    0.5655              #> VarSown:FG.wfg_Legume         +60.847    41.360       1.471     0.146               #> VarWeed:FG.wfg_Legume         +242.472   108.079      2.243     0.02823     *       #> VarN:Density1                 -1.261     2.348        -0.537    0.593               #> VarSown:Density1              +2.290     2.618        0.875     0.3849              #> VarWeed:Density1              +0.991     5.083        0.195     0.846               #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 90 total; 66 residual #> Residual standard error: 6.428977  #>  #> Marginal variance covariance matrix #>            N   Sown     Weed #> N    41.3320 36.716   5.8403 #> Sown 36.7160 51.407  52.2200 #> Weed  5.8403 52.220 193.7900 #>   Standard Deviations: 6.429 7.1699 13.921    ################################################################################################# ## The Sweden dataset # # This real-world dataset contains a single ecosystem function read at multiple time points # (k=1 & t=3). The data contains two treatments, TREAT and DENS, each with two levels # 1 & 2 and High & Low, respectively. # More details can be found at ?dataSWE  data(dataSWE) head(dataSWE) #>   YEARN PLOT TREAT DENS   G1   G2   L1   L2     YIELD #> 1     1    1     1 High 0.70 0.10 0.10 0.10  7.774822 #> 2     1    2     1 High 0.10 0.70 0.10 0.10 10.302994 #> 3     1    3     1 High 0.10 0.10 0.70 0.10 12.643246 #> 4     1    4     1 High 0.10 0.10 0.10 0.70 12.174211 #> 5     1    5     1 High 0.25 0.25 0.25 0.25  9.063782 #> 6     1    6     1 High 0.40 0.40 0.10 0.10  9.148516  # We transform the \"YEARN\" column to factors to better act as groups in our models, giving us a # coefficient per year number as opposed to acting as a continuous scaling factor.  dataSWE$YEARN <- as.factor(dataSWE$YEARN)  # We use the DImulti() function to fit a repeated measures DI model to this data. # We specify the column indices 5 through 8 for our initial species proportions and the response # value column name \"YIELD\". # As there are multiple time points (repeated measures), we use the parameter 'time', providing # the column name containing the time identifier through the first index and the desired Sigma # structure (compound symmetry) through the second. # The experimental unit ID is stored in column index two, which is passed through 'unit_IDs'. # The interaction structure chosen is the average interaction term, \"AV\". # We include both of the treatment terms, TREAT and DENS, as extra fixed effects crossed with # each ID effect, the interaction effect, and with each other. # We opt to use the REML # estimation method for the model as we will not be doing any model comparisons. # Finally, we specify the data object, dataSWE, through 'data'  SWEmodel <- DImulti(prop = 5:8, y = c(\"YIELD\"), time = c(\"YEARN\", \"CS\"),                     unit_IDs = 2, DImodel = \"AV\", extra_fixed = ~ 1:(TREAT:DENS),                     method = \"REML\", data = dataSWE)  print(SWEmodel) #> Note:  #> Method Used = REML  #> Correlation Structure Used = CS #>  Average Term Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by REML #>   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID + AV):(TREAT:DENS))  #>       AIC       BIC    logLik  #>  386.0460  536.7567 -131.0230  #>  #>  Repeated Measure Correlation Structure: Compound symmetry #>  Formula: ~0 | PLOT  #>  Parameter estimate(s): #>       Rho  #> 0.5934898  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                                Beta      Std. Error   t-value   p-value     Signif  #> -----------------------------  --------  -----------  --------  ----------  ------- #> YEARN1:G1_ID:TREAT1:DENSHigh   +7.247    1.103        6.569     3.998e-09   ***     #> YEARN2:G1_ID:TREAT1:DENSHigh   +4.404    1.103        3.992     0.0001397   ***     #> YEARN3:G1_ID:TREAT1:DENSHigh   +2.749    1.103        2.492     0.01467     *       #> YEARN1:G1_ID:TREAT2:DENSHigh   +10.605   1.155        9.185     2.52e-14    ***     #> YEARN2:G1_ID:TREAT2:DENSHigh   +7.905    1.155        6.847     1.159e-09   ***     #> YEARN3:G1_ID:TREAT2:DENSHigh   +6.164    1.155        5.339     7.82e-07    ***     #> YEARN1:G1_ID:TREAT1:DENSLow    +7.564    1.103        6.856     1.111e-09   ***     #> YEARN2:G1_ID:TREAT1:DENSLow    +3.748    1.103        3.397     0.001042    **      #> YEARN3:G1_ID:TREAT1:DENSLow    +2.861    1.103        2.593     0.01122     *       #> YEARN1:G1_ID:TREAT2:DENSLow    +9.509    1.155        8.236     2.041e-12   ***     #> YEARN2:G1_ID:TREAT2:DENSLow    +7.103    1.155        6.152     2.498e-08   ***     #> YEARN3:G1_ID:TREAT2:DENSLow    +5.447    1.155        4.717     9.422e-06   ***     #> YEARN1:G2_ID:TREAT1:DENSHigh   +7.412    1.103        6.719     2.057e-09   ***     #> YEARN2:G2_ID:TREAT1:DENSHigh   +5.286    1.103        4.792     7.052e-06   ***     #> YEARN3:G2_ID:TREAT1:DENSHigh   +4.293    1.103        3.891     0.0001991   ***     #> YEARN1:G2_ID:TREAT2:DENSHigh   +12.244   1.155        10.605    3.611e-17   ***     #> YEARN2:G2_ID:TREAT2:DENSHigh   +11.280   1.155        9.770     1.679e-15   ***     #> YEARN3:G2_ID:TREAT2:DENSHigh   +9.434    1.155        8.170     2.763e-12   ***     #> YEARN1:G2_ID:TREAT1:DENSLow    +7.629    1.103        6.915     8.518e-10   ***     #> YEARN2:G2_ID:TREAT1:DENSLow    +6.194    1.103        5.614     2.489e-07   ***     #> YEARN3:G2_ID:TREAT1:DENSLow    +4.791    1.103        4.343     3.907e-05   ***     #> YEARN1:G2_ID:TREAT2:DENSLow    +12.185   1.155        10.553    4.579e-17   ***     #> YEARN2:G2_ID:TREAT2:DENSLow    +10.478   1.155        9.075     4.198e-14   ***     #> YEARN3:G2_ID:TREAT2:DENSLow    +9.152    1.155        7.926     8.516e-12   ***     #> YEARN1:L1_ID:TREAT1:DENSHigh   +9.475    1.103        8.589     3.99e-13    ***     #> YEARN2:L1_ID:TREAT1:DENSHigh   +7.245    1.103        6.567     4.027e-09   ***     #> YEARN3:L1_ID:TREAT1:DENSHigh   +3.269    1.103        2.963     0.003964    **      #> YEARN1:L1_ID:TREAT2:DENSHigh   +11.322   1.155        9.806     1.422e-15   ***     #> YEARN2:L1_ID:TREAT2:DENSHigh   +9.371    1.155        8.116     3.552e-12   ***     #> YEARN3:L1_ID:TREAT2:DENSHigh   +5.873    1.155        5.086     2.19e-06    ***     #> YEARN1:L1_ID:TREAT1:DENSLow    +8.150    1.103        7.388     1.005e-10   ***     #> YEARN2:L1_ID:TREAT1:DENSLow    +5.371    1.103        4.868     5.223e-06   ***     #> YEARN3:L1_ID:TREAT1:DENSLow    +3.773    1.103        3.420     0.0009678   ***     #> YEARN1:L1_ID:TREAT2:DENSLow    +10.581   1.155        9.164     2.773e-14   ***     #> YEARN2:L1_ID:TREAT2:DENSLow    +8.815    1.155        7.634     3.255e-11   ***     #> YEARN3:L1_ID:TREAT2:DENSLow    +6.277    1.155        5.436     5.23e-07    ***     #> YEARN1:L2_ID:TREAT1:DENSHigh   +8.638    1.103        7.829     1.33e-11    ***     #> YEARN2:L2_ID:TREAT1:DENSHigh   +7.772    1.103        7.045     4.749e-10   ***     #> YEARN3:L2_ID:TREAT1:DENSHigh   +5.782    1.103        5.241     1.169e-06   ***     #> YEARN1:L2_ID:TREAT2:DENSHigh   +8.531    1.155        7.389     9.999e-11   ***     #> YEARN2:L2_ID:TREAT2:DENSHigh   +8.047    1.155        6.969     6.685e-10   ***     #> YEARN3:L2_ID:TREAT2:DENSHigh   +6.793    1.155        5.883     7.949e-08   ***     #> YEARN1:L2_ID:TREAT1:DENSLow    +8.184    1.103        7.418     8.741e-11   ***     #> YEARN2:L2_ID:TREAT1:DENSLow    +7.295    1.103        6.613     3.297e-09   ***     #> YEARN3:L2_ID:TREAT1:DENSLow    +6.697    1.103        6.070     3.555e-08   ***     #> YEARN1:L2_ID:TREAT2:DENSLow    +8.235    1.155        7.132     3.201e-10   ***     #> YEARN2:L2_ID:TREAT2:DENSLow    +8.091    1.155        7.007     5.634e-10   ***     #> YEARN3:L2_ID:TREAT2:DENSLow    +7.256    1.155        6.285     1.401e-08   ***     #> YEARN1:AV:TREAT1:DENSHigh      +8.000    2.405        3.326     0.001307    **      #> YEARN2:AV:TREAT1:DENSHigh      +14.532   2.405        6.042     4.02e-08    ***     #> YEARN3:AV:TREAT1:DENSHigh      +16.668   2.405        6.930     7.959e-10   ***     #> YEARN1:AV:TREAT2:DENSHigh      +10.452   3.124        3.346     0.001228    **      #> YEARN2:AV:TREAT2:DENSHigh      +15.438   3.124        4.942     3.895e-06   ***     #> YEARN3:AV:TREAT2:DENSHigh      +15.672   3.124        5.017     2.888e-06   ***     #> YEARN1:AV:TREAT1:DENSLow       +7.187    2.405        2.988     0.003678    **      #> YEARN2:AV:TREAT1:DENSLow       +16.129   2.405        6.706     2.172e-09   ***     #> YEARN3:AV:TREAT1:DENSLow       +15.116   2.405        6.285     1.398e-08   ***     #> YEARN1:AV:TREAT2:DENSLow       +10.213   3.124        3.269     0.001563    **      #> YEARN2:AV:TREAT2:DENSLow       +15.793   3.124        5.056     2.473e-06   ***     #> YEARN3:AV:TREAT2:DENSLow       +14.843   3.124        4.752     8.23e-06    ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 144 total; 84 residual #> Residual standard error: 1.299215  #>  #> Marginal variance covariance matrix #>        1      2      3 #> 1 1.6880 1.0018 1.0018 #> 2 1.0018 1.6880 1.0018 #> 3 1.0018 1.0018 1.6880 #>   Standard Deviations: 1.2992 1.2992 1.2992"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":null,"dir":"Reference","previous_headings":"","what":"DImulti — DImulti","title":"DImulti — DImulti","text":"function fit Diversity-Interactions models data multiple ecosystem functions /multiple time points","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DImulti — DImulti","text":"","code":"DImulti(   y,   eco_func = c(\"NA\", \"NA\"),   time = c(\"NA\", \"NA\"),   unit_IDs,   prop,   data,   DImodel,   FG = NULL,   ID = NULL,   extra_fixed = NULL,   estimate_theta = FALSE,   theta = 1,   method,   method_theta = \"univariate\" )"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DImulti — DImulti","text":"y dataset wide format, argument vector k column names identifying ecosystem function values recorded experimental unit dataset. example, ecosystem function columns labelled Y1 Y4, y = c(\"Y1\",\"Y2\",\"Y3\",\"Y4\"). Alternatively, column numbers can specified, example, y = 8:11, ecosystem function values 8th 11th columns. dataset long/stacked format, argument column name response value vector, example, y = \"yield\", alternatively, column number can supplied, y = 8 eco_func vector size two, first index holding column name containing character factor indicator response recorded (use stacked/long data passed parameter y), otherwise string \"NA\", case insensitive. second index contain string referring autocorrelation structure responses (use multivariate data case), options include \"un\" unstructured/general \"cs\" compound symmetry. example, eco_func = c(\"Function\", \"cs\"), pertaining multivariate data stacked format compound symmetry structure, eco_func = c(\"na\", \"un\"), meaning either univariate wide multivariate data unstructured/general variance covariance matrix time vector size two, first index holding column name containing repeated measures identifier (.e., indicating time point corresponding response recorded ), otherwise string \"NA\", case insensitive. second index contain string referring autocorrelation structure repeated measures, options include \"un\" unstructured/general, \"cs\" compound symmetry, \"ar1\" autoregressive model order 1 (AR(1)). example, time = c(\"reading\", \"ar1\"), pertaining repeated measures data multiple readings unit AR(1) structure, time = c(\"na\", \"un\"), meaning multivariate data repeated measures (correlation structure ignored) unit_IDs vector columns names/indices containing identifiers experimental units observations (either multiple readings response single reading multiple responses) taken, e.g., unit_IDs = \"Plot\" prop vector S column names identifying species proportions community dataset. example, species proportions columns labelled p1 p4, prop = c(\"p1\",\"p2\",\"p3\",\"p4\"). Alternatively, column numbers can specified, example, prop = 4:7, species proportions 4th 7th columns data dataframe tibble containing previously input columns DImodel string, referring interaction structure model fit full list: \"STR\", \"ID\", \"FULL\", \"E\", \"AV\", \"ADD\", \"FG\" FG species classified g functional groups, argument takes string vector (length S) functional group species referenced prop argument belongs. example, four grassland species two grasses two legumes: FG FG = c(\"G\",\"G\",\"L\",\"L\"), G stands grass L stands legume. argument optional must supplied \"FG\" interaction structure specified DImodel argument ID text list (length s) describing groupings identity effects species. groupings constrain identity effects equal. example, four species wish two identity effect groups species 1 3 species 2 4 grouped together: ID ID = c(\"ID1\", \"ID2\", \"ID1\", \"ID2\"), \"ID1\" \"ID2\" names ID groups. changes identity component model 'beta_1p_1 + beta_2p_2 + beta_3p_3 + beta_4p_4' 'beta_a(p_1 + p_3) + beta_b(p_2 + p_4)'. grouping affect interaction terms. extra_fixed formula expression additional fixed effect terms. example, extra_fixed = ~ Treatment extra_fixed = ~ Treatment + Density. Interactions across regular formula can easily included beginning argument 1* 1:, e.g. extra_fixed = ~ 1:Density. interactions included parameter affected theta. terms included automatically crossed column(s) specified eco_func /time, therefore interactions need specified . estimate_theta default, \\(\\theta\\) (power parameter p_i * p_j components interaction variable model) set equal one. Specify estimate_theta = TRUE include estimation \\(\\theta\\) specified model. value \\(\\theta\\) estimated ecosystem function present data, possibly changing fixed effects across functions. theta Users may specify value \\(\\theta\\) different 1 fit DI model. Note estimate_theta = TRUE, \\(\\theta\\) estimated via maximum profile log-likelihood value specified theta overridden. Specify vector positive non-zero numerical values indicating value non-linear parameter model ecosystem function (alphabetical order, use sort() find ) present dataset, changing fixed effects across functions, single value used . example, theta = 0.5 theta = c(1, 0.5, 1). method string \"REML\" \"ML\", referring estimation method used. \"REML\" suitable model comparisons fixed effects held constant provides unbiased estimates. fixed effects going tested models, use \"ML\" comparisons refit chosen model using \"REML\". method_theta string \"single\", \"joint\", \"univariate\", referring profiling method used. refers whether theta value multivariate model profiled separately (line), (surface), using series univariate DI models. Defaults \"univariate\", currently found efficient/parsimonious method via simulation study.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DImulti — DImulti","text":"DImulti - custom class object containing gls model fit additional DI model attributes","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"DImulti — DImulti","text":"Data package intended use data containing multiple ecosystem function responses /time points biodiversity ecosystem function (BEF) relationship study. dataset contain column species' proportion, row columns sum one. row data also contain identifier experimental unit referenced, identifiers must unique experimental unit, remain consistent time across functions. experimental unit included must recordings either:  - single community level ecosystem function response variable taken multiple time points (repeated measures),  - multiple community level ecosystem function responses (multivariate),  - multiple community level ecosystem function responses taken multiple time points (multivariate repeated measures).  Ecosystem functions may stored long wide format repeated measures must stored long format. Introduction multivariate & repeated measures Diversity-Interactions models Diversity-Interactions (DI) models regression based approach modelling biodiversity ecosystem function (BEF) relationship assumes main driver behind changes ecosystem functioning initial relative abundance (proportions) species present. models can estimated using least squares estimation methods.  example univariate DI model can seen ,  $$ y =  \\sum^{S}_{=1}{\\beta_{} p_{}} +  \\sum^{S}_{\\substack{,j=1 \\\\ <j}}{\\delta_{ij}(p_{}p_{j})^{\\theta} + \\alpha + \\epsilon }$$ response \\(y\\) represents recorded ecosystem function, \\(p_{}\\) represents initial proportion \\(^{th}\\) species, therefore \\(p\\) values sum 1 form simplex space, scales ID effect species, \\(\\beta_{}\\); species interactions treatments required model, response \\(y\\) weighted average species identity effects. \\(S\\) represents number unique species present study. Similarly ID effect, interaction effect, \\(\\delta\\), species scaled combination products species proportions, depends interaction structure chosen. example shows full pairwise structure, unique interaction term, \\(\\delta_{ij}\\), per pair species \\(\\) & \\(j\\). nonlinear term \\(\\theta\\) (Connolly et al., 2013; Vishwakarma et al., 2023) included model allow shape BEF relationship change. parameter can estimated using profile log-likelihood optimisation (Brent, 1973) can assigned set value based priori assumption/knowledge. \\(\\) may include blocks treatment terms, \\(\\alpha\\) vector corresponding effect coefficients.  details univariate DI modelling, see ?DImodels, Kirwan et al., 2009, Moral et al., 2023. multivariate DI model (Dooley et al., 2015) extends DI modelling framework allow estimation multiple ecosystem functions simultaneously, accounting existing covariance functions error term. models can extended introduction repeated measures multiple time points.  structure models : $$ y_{kmt} =  \\sum^{S}_{=1}{\\beta_{ikt} p_{im}} + \\sum^{S}_{\\substack{,j=1 \\\\ <j}}{\\delta_{ijkt}(p_{im}p_{jm})^{\\theta_{k}}} + \\alpha_{kt}+ \\epsilon_{kmt} $$ \\(y_{kmt}\\) refers value \\(k^{th}\\) ecosystem function \\(m^{th}\\) experimental unit time point \\(t\\). experimental unit \\(m\\), \\(\\beta_{ikt}\\) scaled \\(p_{im}\\) expected contribution \\(^{th}\\) species \\(k^{th}\\) response time point \\(t\\) referred \\(^{th}\\) species' ID effect. value nonlinear parameter \\(\\theta\\) allowed vary ecosystem functions, turn allowing fixed effect structure change across functions, recognition nature species interactions change ecosystem functions. case dataset contains single ecosystem function, corresponding subscript \\(k\\) can simply removed equation, can said removal subscript \\(t\\) instance dataset contains single time point. structure error term univariate DI model, error term assumed follow normal distribution mean \\(0\\) variance \\(\\sigma^{2}\\). $$ \\epsilon \\sim N(0, \\sigma^{2})$$ model extended fit multivariate (\\(k>1\\)) /repeated measures (\\(t>1\\)) data, error term now assumed follow multivariate normal distribution mean \\(0\\) variance \\(\\Sigma^{*}\\). $$ \\epsilon \\sim MVN(0, \\Sigma^{*}) $$ \\(\\Sigma^{*}\\) block diagonal matrix, one \\(kt\\) x \\(kt\\) block, \\(\\Sigma\\), experimental unit \\(m\\). refer \\(\\Sigma\\) variance covariance matrix ecosystem functions time points. Typically, includes unique variance per combination ecosystem functions time points along diagonal unique covariance pair combinations -diagonal. Autocorrelation structures may implemented matrix \\(\\Sigma\\), either simplify estimation process based priori knowledge. One structure chosen ecosystem functions another repeated measures/time points, two matrices estimated independently combined using Kronecker product (\\(\\otimes\\)), matrix multiplication method. case data multivariate (\\(k>1\\) & \\(t=1\\)) repeated measures (\\(k=1\\) & \\(t>1\\)), one autocorrelation structure needs chosen, multiplication necessary.  Three structures currently available package repeated measures responses, two available multivariate responses: UN: element \\(\\Sigma\\) set estimate independently,  said unstructured follow general structure preferred option case  priori information nature relationships.  corSymm CS: simpler structure compound symmetry,  assumed ecosystem function time point variance value  \\(\\sigma^{2}\\) pair covariance value \\(\\sigma^{2}\\rho\\).  structure preferred use multiple ecosystem functions provides  meaningful interpretation, however allowed package model requires  simplification. corCompSymm AR(1): autocorrelation structure exclusive repeated measures data  autoregressive model order one, assumes , time point variance,  \\(\\sigma^{2}\\), distance pairs time points increases, covariance  changes factor \\(\\rho\\). corAR1","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"DImulti — DImulti","text":"Vishwakarma, R., Byrne, L., Connolly, J., de Andrade Moral, R. Brophy, C., 2023.  Estimation non-linear parameter Generalised Diversity-Interactions models unaffected change structure interaction terms.  Environmental Ecological Statistics, 30(3), pp.555-574. Moral, R.., Vishwakarma, R., Connolly, J., Byrne, L., Hurley, C., Finn, J.. Brophy, C., 2023.  Going beyond richness: Modelling BEF relationship using species identity, evenness, richness species interactions via DImodels R package.  Methods Ecology Evolution, 14(9), pp.2250-2258. Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P. Cop, J., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Connolly, J., Bell, T., Bolger, T., Brophy, C., Carnus, T., Finn, J.., Kirwan, L., Isbell, F., Levine, J., Luscher, . Picasso, V., 2013.  improved model predict effects changing biodiversity levels ecosystem function.  Journal Ecology, 101(2), pp.344-355. Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038. Brent, R.P., 1973.  efficient algorithms solving systems nonlinear equations.  SIAM Journal Numerical Analysis, 10(2), pp.327-344.","code":""},{"path":[]},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DImulti — DImulti","text":"Laura Byrne [aut, cre], Rishabh Vishwakarma [aut], Rafael de Andrade Moral [aut], Caroline Brophy [aut]  Maintainer: Laura Byrne byrnel54@tcd.ie","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/DImulti.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DImulti — DImulti","text":"","code":"################################################################################################# ################################################################################################# ################################################################################################# #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE>  ## Modelling Examples  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # \\donttest{ vignette(\"DImulti_workflow\") #> Warning: vignette ‘DImulti_workflow’ not found # }  ## The simMVRM dataset # # This simulated dataset contains multiple ecosystem functions (k=3) and multiple time points # (t=2). The dataset was # simulated using unstructured Sigma matrices. # The true values can be found in the help file for the data, ?simMVRM  data(simMVRM) head(simMVRM) #>   plot p1 p2 p3 p4         Y1          Y2        Y3 time #> 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1 #> 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1 #> 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1 #> 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1 #> 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1 #> 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1  # We will start the analysis with a call to the package's main function, DImulti(). # We begin the call by specifying the column indices holding the initial species proportions # (p_i) through 'prop' and the columns which hold the ecosystem response values through 'y'. # Since our data is multivariate, we include the 'eco_func' parameter, specifying \"na\" as our # data is in a wide format (multiple columns in 'y') and \"un\" to fit an unstructured Sigma # for our ecosystem functions. # The data also contains repeated measures, so we include the 'time' parameter, specifying \"time\" # as the column containing the time point indicator for each row and \"ar1\" to fit an AR(1) # autocorrelation structure for our time points. # Next, we specify that the experimental unit identifier is in column 1 through 'unit_IDs'. We # indicate that we do not want to estimate the non-linear parameter theta, but do not provide # any values, opting for the default value of 1. # We specify a full pairwise (FULL) interaction structure through 'DImodel' and estimate the # model using maximum likelihood (ML) as we may compare models. # Finally, we provide the data object simMVRM through 'data'.  simModel_FULL <- DImulti(prop = 2:5, y = 6:8, eco_func = c(\"na\", \"un\"), time = c(\"time\", \"ar1\"),                          unit_IDs = 1, estimate_theta = FALSE, DImodel = \"FULL\", method = \"ML\",                          data = simMVRM)  # simModel_FULL is an object of custom class DImulti, which can be used with a number of S3 # methods and any method compatible with gls objects. We use summary() to examine the model fit, # including fixed effect coefficients and the variance covariance matrix Sigma.  print(simModel_FULL) #> Note:  #> Method Used = ML  #> Correlation Structure Used = un@ar1 #>  Full Pairwise Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + FULL.p1.p2 +      FULL.p1.p3 + FULL.p1.p4 + FULL.p2.p3 + FULL.p2.p4 + FULL.p3.p4))  #>       AIC       BIC    logLik  #>  7969.803  8311.945 -3923.902  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      #> 2  0.612        #> 3 -0.310 -0.360 #>  #>  Repeated Measure Correlation Structure: AR(1) #>  Formula: ~0 + as.numeric(time) | plot/func  #>  Parameter estimate(s): #>       Phi  #> 0.3184991  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                           Beta      Std. Error   t-value   p-value     Signif  #> ------------------------  --------  -----------  --------  ----------  ------- #> funcY1:time1:p1_ID        -1.750    0.535        -3.274    0.001078    **      #> funcY2:time1:p1_ID        +0.399    0.535        0.747     0.4554              #> funcY3:time1:p1_ID        +0.840    0.535        1.572     0.116               #> funcY1:time2:p1_ID        +0.454    0.535        0.850     0.3955              #> funcY2:time2:p1_ID        +3.122    0.535        5.840     6.095e-09   ***     #> funcY3:time2:p1_ID        -0.533    0.535        -0.998    0.3186              #> funcY1:time1:p2_ID        +5.054    0.458        11.029    1.751e-27   ***     #> funcY2:time1:p2_ID        +4.458    0.458        9.730     7.004e-22   ***     #> funcY3:time1:p2_ID        +6.544    0.458        14.281    4.378e-44   ***     #> funcY1:time2:p2_ID        +5.009    0.458        10.933    4.79e-27    ***     #> funcY2:time2:p2_ID        +2.706    0.458        5.907     4.108e-09   ***     #> funcY3:time2:p2_ID        +6.663    0.458        14.542    1.442e-45   ***     #> funcY1:time1:p3_ID        +2.764    0.534        5.177     2.483e-07   ***     #> funcY2:time1:p3_ID        -0.622    0.534        -1.166    0.2439              #> funcY3:time1:p3_ID        +3.171    0.534        5.939     3.388e-09   ***     #> funcY1:time2:p3_ID        +4.114    0.534        7.706     2.046e-14   ***     #> funcY2:time2:p3_ID        -3.673    0.534        -6.880    8.035e-12   ***     #> funcY3:time2:p3_ID        +2.792    0.534        5.230     1.879e-07   ***     #> funcY1:time1:p4_ID        -0.991    0.609        -1.629    0.1034              #> funcY2:time1:p4_ID        -0.123    0.609        -0.203    0.8395              #> funcY3:time1:p4_ID        +5.431    0.609        8.926     9.95e-19    ***     #> funcY1:time2:p4_ID        -2.586    0.609        -4.251    2.233e-05   ***     #> funcY2:time2:p4_ID        +1.808    0.609        2.971     0.003002    **      #> funcY3:time2:p4_ID        +3.969    0.609        6.523     8.772e-11   ***     #> funcY1:time1:FULL.p1.p2   +3.292    1.899        1.734     0.08309     +       #> funcY2:time1:FULL.p1.p2   +7.657    1.899        4.033     5.726e-05   ***     #> funcY3:time1:FULL.p1.p2   +6.776    1.899        3.569     0.0003675   ***     #> funcY1:time2:FULL.p1.p2   +32.544   1.899        17.140    1.844e-61   ***     #> funcY2:time2:FULL.p1.p2   +3.174    1.899        1.672     0.09473     +       #> funcY3:time2:FULL.p1.p2   +19.498   1.899        10.269    3.949e-24   ***     #> funcY1:time1:FULL.p1.p3   +3.232    1.955        1.653     0.09842     +       #> funcY2:time1:FULL.p1.p3   +6.802    1.955        3.480     0.0005128   ***     #> funcY3:time1:FULL.p1.p3   +7.057    1.955        3.610     0.0003136   ***     #> funcY1:time2:FULL.p1.p3   +33.570   1.955        17.173    1.114e-61   ***     #> funcY2:time2:FULL.p1.p3   +4.154    1.955        2.125     0.03371     *       #> funcY3:time2:FULL.p1.p3   +19.103   1.955        9.772     4.697e-22   ***     #> funcY1:time1:FULL.p1.p4   +4.977    2.231        2.231     0.0258      *       #> funcY2:time1:FULL.p1.p4   +9.175    2.231        4.113     4.072e-05   ***     #> funcY3:time1:FULL.p1.p4   +5.448    2.231        2.442     0.01469     *       #> funcY1:time2:FULL.p1.p4   +34.133   2.231        15.301    5.257e-50   ***     #> funcY2:time2:FULL.p1.p4   +3.481    2.231        1.560     0.1188              #> funcY3:time2:FULL.p1.p4   +18.009   2.231        8.073     1.185e-15   ***     #> funcY1:time1:FULL.p2.p3   +1.621    1.830        0.886     0.3757              #> funcY2:time1:FULL.p2.p3   +6.701    1.830        3.662     0.0002567   ***     #> funcY3:time1:FULL.p2.p3   +7.567    1.830        4.136     3.691e-05   ***     #> funcY1:time2:FULL.p2.p3   +35.388   1.830        19.339    2.158e-76   ***     #> funcY2:time2:FULL.p2.p3   +5.926    1.830        3.238     0.001222    **      #> funcY3:time2:FULL.p2.p3   +20.525   1.830        11.217    2.422e-28   ***     #> funcY1:time1:FULL.p2.p4   +1.686    1.953        0.863     0.3882              #> funcY2:time1:FULL.p2.p4   +8.136    1.953        4.165     3.245e-05   ***     #> funcY3:time1:FULL.p2.p4   +5.257    1.953        2.692     0.00717     **      #> funcY1:time2:FULL.p2.p4   +33.761   1.953        17.285    2.081e-62   ***     #> funcY2:time2:FULL.p2.p4   +5.241    1.953        2.683     0.007352    **      #> funcY3:time2:FULL.p2.p4   +17.665   1.953        9.044     3.533e-19   ***     #> funcY1:time1:FULL.p3.p4   +3.364    2.104        1.599     0.11                #> funcY2:time1:FULL.p3.p4   +9.872    2.104        4.692     2.898e-06   ***     #> funcY3:time1:FULL.p3.p4   +4.387    2.104        2.085     0.0372      *       #> funcY1:time2:FULL.p3.p4   +35.150   2.104        16.705    1.149e-58   ***     #> funcY2:time2:FULL.p3.p4   +6.951    2.104        3.304     0.0009714   ***     #> funcY3:time2:FULL.p3.p4   +18.366   2.104        8.729     5.416e-18   ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 2016 total; 1956 residual #> Residual standard error: 1.931155  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.8157  2.3236 -1.3479 #> [2,]  2.3236  2.9908 -1.2351 #> [3,] -1.3479 -1.2351  3.9281 #>   Standard Deviations: 2.1945 1.7294 1.982  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.5364 1.4449 #> [2,] 1.4449 4.5364 #>   Standard Deviations: 2.1299 2.1299  #>  #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.72940  1.18780  2.28330  0.72724 -1.15570 -0.36810 #> Y1:2  1.18780  3.72940  0.72724  2.28330 -0.36810 -1.15570 #> Y2:1  2.28330  0.72724  3.72940  1.18780 -1.34380 -0.42801 #> Y2:2  0.72724  2.28330  1.18780  3.72940 -0.42801 -1.34380 #> Y3:1 -1.15570 -0.36810 -1.34380 -0.42801  3.72940  1.18780 #> Y3:2 -0.36810 -1.15570 -0.42801 -1.34380  1.18780  3.72940 #>   Standard Deviations: 1.9312 1.9312 1.9312 1.9312 1.9312 1.9312  #>   # From this summary, we can see that there are many coefficients, a number of which are not # statistically significant at an # alpha level of 0.05, therefore this model may not be ideal for our data. We refit the model # using an average interaction structure instead as it reduces the number of interaction terms # to 1 per ecosystem function and time point.  simModel_AV <- DImulti(prop = 2:5, y = 6:8, eco_func = c(\"na\", \"un\"), time = c(\"time\", \"ar1\"),                        unit_IDs = 1, estimate_theta = FALSE, DImodel = \"AV\", method = \"ML\",                        data = simMVRM) print(simModel_AV) #> Note:  #> Method Used = ML  #> Correlation Structure Used = un@ar1 #>  Average Term Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + AV))  #>       AIC       BIC    logLik  #>  7921.064  8094.939 -3929.532  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      #> 2  0.612        #> 3 -0.310 -0.364 #>  #>  Repeated Measure Correlation Structure: AR(1) #>  Formula: ~0 + as.numeric(time) | plot/func  #>  Parameter estimate(s): #>       Phi  #> 0.3161191  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                      Beta      Std. Error   t-value   p-value      Signif  #> -------------------  --------  -----------  --------  -----------  ------- #> funcY1:time1:p1_ID   -1.407    0.402        -3.505    0.0004663    ***     #> funcY2:time1:p1_ID   +0.354    0.402        0.881     0.3787               #> funcY3:time1:p1_ID   +0.946    0.402        2.357     0.01852      *       #> funcY1:time2:p1_ID   +0.142    0.402        0.353     0.7238               #> funcY2:time2:p1_ID   +2.630    0.402        6.550     7.324e-11    ***     #> funcY3:time2:p1_ID   -0.552    0.402        -1.375    0.1692               #> funcY1:time1:p2_ID   +4.770    0.372        12.825    3.103e-36    ***     #> funcY2:time1:p2_ID   +4.273    0.372        11.489    1.258e-29    ***     #> funcY3:time1:p2_ID   +6.704    0.372        18.025    2.163e-67    ***     #> funcY1:time2:p2_ID   +4.976    0.372        13.379    3.759e-39    ***     #> funcY2:time2:p2_ID   +2.707    0.372        7.280     4.793e-13    ***     #> funcY3:time2:p2_ID   +6.806    0.372        18.299    3.007e-69    ***     #> funcY1:time1:p3_ID   +2.665    0.404        6.603     5.17e-11     ***     #> funcY2:time1:p3_ID   -0.766    0.404        -1.896    0.05804      +       #> funcY3:time1:p3_ID   +3.321    0.404        8.226     3.45e-16     ***     #> funcY1:time2:p3_ID   +4.394    0.404        10.884    7.756e-27    ***     #> funcY2:time2:p3_ID   -3.350    0.404        -8.299    1.913e-16    ***     #> funcY3:time2:p3_ID   +3.008    0.404        7.452     1.362e-13    ***     #> funcY1:time1:p4_ID   -0.900    0.453        -1.984    0.04736      *       #> funcY2:time1:p4_ID   +0.325    0.453        0.717     0.4733               #> funcY3:time1:p4_ID   +4.924    0.453        10.860    9.948e-27    ***     #> funcY1:time2:p4_ID   -2.504    0.453        -5.523    3.779e-08    ***     #> funcY2:time2:p4_ID   +2.019    0.453        4.453     8.941e-06    ***     #> funcY3:time2:p4_ID   +3.544    0.453        7.817     8.734e-15    ***     #> funcY1:time1:AV      +2.892    0.984        2.938     0.003339     **      #> funcY2:time1:AV      +7.938    0.984        8.066     1.246e-15    ***     #> funcY3:time1:AV      +6.184    0.984        6.284     4.055e-10    ***     #> funcY1:time2:AV      +34.080   0.984        34.628    5.753e-206   ***     #> funcY2:time2:AV      +4.827    0.984        4.904     1.014e-06    ***     #> funcY3:time2:AV      +18.944   0.984        19.249    7.598e-76    ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 2016 total; 1986 residual #> Residual standard error: 1.936361  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.8390  2.3374 -1.3561 #> [2,]  2.3374  3.0147 -1.2559 #> [3,] -1.3561 -1.2559  3.9495 #>   Standard Deviations: 2.1998 1.7363 1.9873  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.5575 1.4407 #> [2,] 1.4407 4.5575 #>   Standard Deviations: 2.1348 2.1348  #>  #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.74950  1.18530  2.29460  0.72537 -1.16310 -0.36768 #> Y1:2  1.18530  3.74950  0.72537  2.29460 -0.36768 -1.16310 #> Y2:1  2.29460  0.72537  3.74950  1.18530 -1.36470 -0.43139 #> Y2:2  0.72537  2.29460  1.18530  3.74950 -0.43139 -1.36470 #> Y3:1 -1.16310 -0.36768 -1.36470 -0.43139  3.74950  1.18530 #> Y3:2 -0.36768 -1.16310 -0.43139 -1.36470  1.18530  3.74950 #>   Standard Deviations: 1.9364 1.9364 1.9364 1.9364 1.9364 1.9364  #>   # This model looks like it is a better fit, with less insignificant terms, but we can test this # formally using a likelihood ratio test, as the DImodels interaction structures are nested in # nature (with the exception of \"ADD\" and \"FG\", which are on the same level in the nesting # hierarchy). # This will test the null hypothesis that the likelihood of the two models do not significantly # differ, in other words, the added parameters of the more complex model are not worth it.  anova(simModel_FULL, simModel_AV) #>               Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> simModel_FULL     1 61 7969.803 8311.945 -3923.902                         #> simModel_AV       2 31 7921.064 8094.939 -3929.532 1 vs 2 11.26025  0.9992  # As the p-value is greater than our selected alpha value (0.05), we fail to reject the null # hypothesis and so continue with the simpler model, simModel_AV. # We can confirm this result by using information criteria such as AIC or BIC. # We select the model with the lower value as it indicates a better fit. # We use the second order versions of AIC and BIC (AICc and BICc) as we have a large number of # terms, which can cause AIC and BIC to favour more complex models.  AICc(simModel_FULL); AICc(simModel_AV) #> [1] 7975.676 #> [1] 7924.065 BICc(simModel_FULL); BICc(simModel_AV) #> [1] 8326.672 #> [1] 8098.743  # We refit our chosen model using the REML estimation method to have unbiased estimates.  simModel_AV <- DImulti(prop = 2:5, y = 6:8, eco_func = c(\"na\", \"un\"), time = c(\"time\", \"ar1\"),                        unit_IDs = 1, estimate_theta = FALSE, DImodel = \"AV\", method = \"REML\",                        data = simMVRM)  # We can now examine the variance covariance matrix, Sigma, and the fixed effect coefficients, # which can be retrieved from our initial summary() check or individually.  coef(simModel_AV) #> funcY1:time1:p1_ID funcY2:time1:p1_ID funcY3:time1:p1_ID funcY1:time2:p1_ID  #>         -1.4073525          0.3535514          0.9463605          0.1419124  #> funcY2:time2:p1_ID funcY3:time2:p1_ID funcY1:time1:p2_ID funcY2:time1:p2_ID  #>          2.6296879         -0.5521430          4.7699282          4.2730527  #> funcY3:time1:p2_ID funcY1:time2:p2_ID funcY2:time2:p2_ID funcY3:time2:p2_ID  #>          6.7037708          4.9758685          2.7074546          6.8055585  #> funcY1:time1:p3_ID funcY2:time1:p3_ID funcY3:time1:p3_ID funcY1:time2:p3_ID  #>          2.6653214         -0.7655644          3.3207690          4.3935222  #> funcY2:time2:p3_ID funcY3:time2:p3_ID funcY1:time1:p4_ID funcY2:time1:p4_ID  #>         -3.3501635          3.0082933         -0.8997879          0.3252207  #> funcY3:time1:p4_ID funcY1:time2:p4_ID funcY2:time2:p4_ID funcY3:time2:p4_ID  #>          4.9242752         -2.5041979          2.0191631          3.5443872  #>    funcY1:time1:AV    funcY2:time1:AV    funcY3:time1:AV    funcY1:time2:AV  #>          2.8917739          7.9381038          6.1841587         34.0798392  #>    funcY2:time2:AV    funcY3:time2:AV  #>          4.8267227         18.9444801  simModel_AV$vcov #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.80690  1.20340  2.33020  0.73662 -1.18210 -0.37368 #> Y1:2  1.20340  3.80690  0.73662  2.33020 -0.37368 -1.18210 #> Y2:1  2.33020  0.73662  3.80690  1.20340 -1.38640 -0.43828 #> Y2:2  0.73662  2.33020  1.20340  3.80690 -0.43828 -1.38640 #> Y3:1 -1.18210 -0.37368 -1.38640 -0.43828  3.80690  1.20340 #> Y3:2 -0.37368 -1.18210 -0.43828 -1.38640  1.20340  3.80690 #>   Standard Deviations: 1.9511 1.9511 1.9511 1.9511 1.9511 1.9511  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.9140  2.3738 -1.3783 #> [2,]  2.3738  3.0605 -1.2758 #> [3,] -1.3783 -1.2758  4.0093 #>   Standard Deviations: 2.2168 1.7494 2.0023  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.6263 1.4625 #> [2,] 1.4625 4.6263 #>   Standard Deviations: 2.1509 2.1509  #>   # An example of what we can infer from this is that ecosystem functions Y1 and Y2 have a positive # covariance at time 1, while Y3 has a negative covariance with both Y1 and Y2 at the same time # point. This means that maximising Y1 would not negatively impact Y2 but it would be at the cost # of Y3. However, as our interaction term is positive and significant at this time point for all # three ecosystem functions, we should be able to include a mixture of species that have positive # ID effects for each response to help mitigate this trade-off. # We can also predict from the model if we want to compare responses from different conditions, # even those not included in the original data.  predict(simModel_AV, newdata = simMVRM[which(simMVRM$plot == 1:2), ]) #>    plot     Yvalue Ytype #> 1     1 -1.4073525  Y1:1 #> 2     1  0.1419124  Y1:2 #> 3     1  0.3535514  Y2:1 #> 4     1  2.6296879  Y2:2 #> 5     1  0.9463605  Y3:1 #> 6     1 -0.5521430  Y3:2 #> 7     2 -1.4073525  Y1:1 #> 8     2  0.1419124  Y1:2 #> 9     2  0.3535514  Y2:1 #> 10    2  2.6296879  Y2:2 #> 11    2  0.9463605  Y3:1 #> 12    2 -0.5521430  Y3:2   ################################################################################################# ## The Belgium dataset # # This real world dataset contains multiple ecosystem functions (k=3) at a single time point # (t=1). The dataset also contains seeding density as a treatment in the form of a factor with # two levels (1, -1). More detail can be found at ?dataBEL.  data(dataBEL) head(dataBEL) #>   Plot  G1  G2  L1  L2 Density  Var VarNum       Y #> 1    1 0.7 0.1 0.1 0.1       1 Sown      1 104.156 #> 2    1 0.7 0.1 0.1 0.1       1 Weed      2 100.058 #> 3    1 0.7 0.1 0.1 0.1       1    N      3  87.996 #> 4    2 0.1 0.7 0.1 0.1       1 Sown      1  82.547 #> 5    2 0.1 0.7 0.1 0.1       1 Weed      2  89.801 #> 6    2 0.1 0.7 0.1 0.1       1    N      3  72.239  # We begin with the main function DImulti(), passing the initial species proportions column names # through 'prop' and the response value column name through 'y'. # As the data is in a long or stacked format, we specify the ecosystem function type through the # first index of the 'eco_func' parameter, along with specifying that we want an unstructured # Sigma for these response types. # The experimental unit ID is stored in the column \"Plot\" and so we pass this to 'unit_IDs'. # Rather than estimating the nonlinear parameter theta, we opt to provide a value for each # ecosystem function type through the parameter 'theta', which will be applied to the # interaction terms as a power. In this case, we use functional group (FG) interactions, which # requires an additional argument FG to be provided, specifying which group each species present # in 'prop' belongs to. In this case, we group the grasses and the legumes. # We include the treatment Density as an additional fixed effect. # We opt to use the REML estimation method as we will not be doing any model comparisons. # Finally, we specify the data object, dataBEL, through 'data'.  belModel <- DImulti(prop = c(\"G1\", \"G2\", \"L1\", \"L2\"), y = \"Y\", eco_func = c(\"Var\", \"un\"),                     unit_IDs = \"Plot\", theta = c(0.5, 1, 1.2), DImodel = \"FG\",                     FG = c(\"Grass\", \"Grass\", \"Legume\", \"Legume\"), extra_fixed = ~ Density,                     method = \"REML\", data = dataBEL)  # We can now print the output from our model, stored in belModel with class DImulti.  print(belModel) #> Note:  #> Method Used = REML  #> Correlation Structure Used = un #>  Functional Group Model #> Theta value(s) = N:0.5, Sown:1, Weed:1.2 #>  #> Generalized least squares fit by REML #>   Model: Y ~ 0 + Var:((G1_ID + G2_ID + L1_ID + L2_ID + FG.bfg_Grass_Legume +      FG.wfg_Grass + FG.wfg_Legume) + Density)  #>       AIC       BIC    logLik  #>  488.8132  554.5029 -214.4066  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | Plot  #>  Parameter estimate(s): #>  Correlation:  #>   1     2     #> 2 0.797       #> 3 0.065 0.523 #>  #>  #> Table: Fixed Effect Coefficients #>  #>                               Beta       Std. Error   t-value   p-value     Signif  #> ----------------------------  ---------  -----------  --------  ----------  ------- #> VarN:G1_ID                    +44.867    4.209        10.661    5.433e-16   ***     #> VarSown:G1_ID                 +65.337    4.656        14.033    1.745e-21   ***     #> VarWeed:G1_ID                 +79.372    9.039        8.781     1.065e-12   ***     #> VarN:G2_ID                    +28.926    4.209        6.873     2.722e-09   ***     #> VarSown:G2_ID                 +46.808    4.656        10.053    6.096e-15   ***     #> VarWeed:G2_ID                 +90.654    9.039        10.029    6.706e-15   ***     #> VarN:L1_ID                    +98.246    4.209        23.344    1.322e-33   ***     #> VarSown:L1_ID                 +76.396    4.656        16.408    5.561e-25   ***     #> VarWeed:L1_ID                 +50.032    9.039        5.535     5.782e-07   ***     #> VarN:L2_ID                    +77.067    4.209        18.312    1.438e-27   ***     #> VarSown:L2_ID                 +51.062    4.656        10.967    1.629e-16   ***     #> VarWeed:L2_ID                 +33.951    9.039        3.756     0.0003674   ***     #> VarN:FG.bfg_Grass_Legume      +14.538    13.281       1.095     0.2777              #> VarSown:FG.bfg_Grass_Legume   +86.492    18.699       4.625     1.796e-05   ***     #> VarWeed:FG.bfg_Grass_Legume   +152.157   49.542       3.071     0.003095    **      #> VarN:FG.wfg_Grass             +58.483    28.072       2.083     0.0411      *       #> VarSown:FG.wfg_Grass          +107.670   41.360       2.603     0.0114      *       #> VarWeed:FG.wfg_Grass          -9.702     108.079      -0.090    0.9287              #> VarN:FG.wfg_Legume            -16.215    28.072       -0.578    0.5655              #> VarSown:FG.wfg_Legume         +60.847    41.360       1.471     0.146               #> VarWeed:FG.wfg_Legume         +242.472   108.079      2.243     0.02823     *       #> VarN:Density1                 -1.261     2.348        -0.537    0.593               #> VarSown:Density1              +2.290     2.618        0.875     0.3849              #> VarWeed:Density1              +0.991     5.083        0.195     0.846               #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 90 total; 66 residual #> Residual standard error: 6.428977  #>  #> Marginal variance covariance matrix #>            N   Sown     Weed #> N    41.3320 36.716   5.8403 #> Sown 36.7160 51.407  52.2200 #> Weed  5.8403 52.220 193.7900 #>   Standard Deviations: 6.429 7.1699 13.921      ################################################################################################# ## The Sweden dataset # # This real-world dataset contains a single ecosystem function read at multiple time points # (k=1 & t=3). The data contains two treatments, TREAT and DENS, each with two levels # 1 & 2 and High & Low, respectively. # More details can be found at ?dataSWE  data(dataSWE) head(dataSWE) #>   YEARN PLOT TREAT DENS   G1   G2   L1   L2     YIELD #> 1     1    1     1 High 0.70 0.10 0.10 0.10  7.774822 #> 2     1    2     1 High 0.10 0.70 0.10 0.10 10.302994 #> 3     1    3     1 High 0.10 0.10 0.70 0.10 12.643246 #> 4     1    4     1 High 0.10 0.10 0.10 0.70 12.174211 #> 5     1    5     1 High 0.25 0.25 0.25 0.25  9.063782 #> 6     1    6     1 High 0.40 0.40 0.10 0.10  9.148516  # We transform the \"YEARN\" column to factors to better act as groups in our models, giving us a # coefficient per year number as opposed to acting as a continuous scaling factor.  dataSWE$YEARN <- as.factor(dataSWE$YEARN)  # We use the DImulti() function to fit a repeated measures DI model to this data. # We specify the column indices 5 through 8 for our initial species proportions and the response # value column name \"YIELD\". # As there are multiple time points (repeated measures), we use the parameter 'time', providing # the column name containing the time identifier through the first index and the desired Sigma # structure (compound symmetry) through the second. # The experimental unit ID is stored in column index two, which is passed through 'unit_IDs'. # The interaction structure chosen is average interaction term, \"AV\". # We include both of the treatment terms, TREAT and DENS, as extra fixed effects crossed with # each ID effect, the interaction effect, and with each other. # We opt to use the REML estimation method for the model as we will not be doing any model # comparisons. # Finally, we specify the data object, dataSWE, through 'data'  SWEmodel <- DImulti(prop = 5:8, y = c(\"YIELD\"), time = c(\"YEARN\", \"CS\"),                     unit_IDs = 2, DImodel = \"AV\", extra_fixed = ~ 1:(TREAT:DENS),                     method = \"REML\", data = dataSWE)  print(SWEmodel) #> Note:  #> Method Used = REML  #> Correlation Structure Used = CS #>  Average Term Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by REML #>   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID + AV):(TREAT:DENS))  #>       AIC       BIC    logLik  #>  386.0460  536.7567 -131.0230  #>  #>  Repeated Measure Correlation Structure: Compound symmetry #>  Formula: ~0 | PLOT  #>  Parameter estimate(s): #>       Rho  #> 0.5934898  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                                Beta      Std. Error   t-value   p-value     Signif  #> -----------------------------  --------  -----------  --------  ----------  ------- #> YEARN1:G1_ID:TREAT1:DENSHigh   +7.247    1.103        6.569     3.998e-09   ***     #> YEARN2:G1_ID:TREAT1:DENSHigh   +4.404    1.103        3.992     0.0001397   ***     #> YEARN3:G1_ID:TREAT1:DENSHigh   +2.749    1.103        2.492     0.01467     *       #> YEARN1:G1_ID:TREAT2:DENSHigh   +10.605   1.155        9.185     2.52e-14    ***     #> YEARN2:G1_ID:TREAT2:DENSHigh   +7.905    1.155        6.847     1.159e-09   ***     #> YEARN3:G1_ID:TREAT2:DENSHigh   +6.164    1.155        5.339     7.82e-07    ***     #> YEARN1:G1_ID:TREAT1:DENSLow    +7.564    1.103        6.856     1.111e-09   ***     #> YEARN2:G1_ID:TREAT1:DENSLow    +3.748    1.103        3.397     0.001042    **      #> YEARN3:G1_ID:TREAT1:DENSLow    +2.861    1.103        2.593     0.01122     *       #> YEARN1:G1_ID:TREAT2:DENSLow    +9.509    1.155        8.236     2.041e-12   ***     #> YEARN2:G1_ID:TREAT2:DENSLow    +7.103    1.155        6.152     2.498e-08   ***     #> YEARN3:G1_ID:TREAT2:DENSLow    +5.447    1.155        4.717     9.422e-06   ***     #> YEARN1:G2_ID:TREAT1:DENSHigh   +7.412    1.103        6.719     2.057e-09   ***     #> YEARN2:G2_ID:TREAT1:DENSHigh   +5.286    1.103        4.792     7.052e-06   ***     #> YEARN3:G2_ID:TREAT1:DENSHigh   +4.293    1.103        3.891     0.0001991   ***     #> YEARN1:G2_ID:TREAT2:DENSHigh   +12.244   1.155        10.605    3.611e-17   ***     #> YEARN2:G2_ID:TREAT2:DENSHigh   +11.280   1.155        9.770     1.679e-15   ***     #> YEARN3:G2_ID:TREAT2:DENSHigh   +9.434    1.155        8.170     2.763e-12   ***     #> YEARN1:G2_ID:TREAT1:DENSLow    +7.629    1.103        6.915     8.518e-10   ***     #> YEARN2:G2_ID:TREAT1:DENSLow    +6.194    1.103        5.614     2.489e-07   ***     #> YEARN3:G2_ID:TREAT1:DENSLow    +4.791    1.103        4.343     3.907e-05   ***     #> YEARN1:G2_ID:TREAT2:DENSLow    +12.185   1.155        10.553    4.579e-17   ***     #> YEARN2:G2_ID:TREAT2:DENSLow    +10.478   1.155        9.075     4.198e-14   ***     #> YEARN3:G2_ID:TREAT2:DENSLow    +9.152    1.155        7.926     8.516e-12   ***     #> YEARN1:L1_ID:TREAT1:DENSHigh   +9.475    1.103        8.589     3.99e-13    ***     #> YEARN2:L1_ID:TREAT1:DENSHigh   +7.245    1.103        6.567     4.027e-09   ***     #> YEARN3:L1_ID:TREAT1:DENSHigh   +3.269    1.103        2.963     0.003964    **      #> YEARN1:L1_ID:TREAT2:DENSHigh   +11.322   1.155        9.806     1.422e-15   ***     #> YEARN2:L1_ID:TREAT2:DENSHigh   +9.371    1.155        8.116     3.552e-12   ***     #> YEARN3:L1_ID:TREAT2:DENSHigh   +5.873    1.155        5.086     2.19e-06    ***     #> YEARN1:L1_ID:TREAT1:DENSLow    +8.150    1.103        7.388     1.005e-10   ***     #> YEARN2:L1_ID:TREAT1:DENSLow    +5.371    1.103        4.868     5.223e-06   ***     #> YEARN3:L1_ID:TREAT1:DENSLow    +3.773    1.103        3.420     0.0009678   ***     #> YEARN1:L1_ID:TREAT2:DENSLow    +10.581   1.155        9.164     2.773e-14   ***     #> YEARN2:L1_ID:TREAT2:DENSLow    +8.815    1.155        7.634     3.255e-11   ***     #> YEARN3:L1_ID:TREAT2:DENSLow    +6.277    1.155        5.436     5.23e-07    ***     #> YEARN1:L2_ID:TREAT1:DENSHigh   +8.638    1.103        7.829     1.33e-11    ***     #> YEARN2:L2_ID:TREAT1:DENSHigh   +7.772    1.103        7.045     4.749e-10   ***     #> YEARN3:L2_ID:TREAT1:DENSHigh   +5.782    1.103        5.241     1.169e-06   ***     #> YEARN1:L2_ID:TREAT2:DENSHigh   +8.531    1.155        7.389     9.999e-11   ***     #> YEARN2:L2_ID:TREAT2:DENSHigh   +8.047    1.155        6.969     6.685e-10   ***     #> YEARN3:L2_ID:TREAT2:DENSHigh   +6.793    1.155        5.883     7.949e-08   ***     #> YEARN1:L2_ID:TREAT1:DENSLow    +8.184    1.103        7.418     8.741e-11   ***     #> YEARN2:L2_ID:TREAT1:DENSLow    +7.295    1.103        6.613     3.297e-09   ***     #> YEARN3:L2_ID:TREAT1:DENSLow    +6.697    1.103        6.070     3.555e-08   ***     #> YEARN1:L2_ID:TREAT2:DENSLow    +8.235    1.155        7.132     3.201e-10   ***     #> YEARN2:L2_ID:TREAT2:DENSLow    +8.091    1.155        7.007     5.634e-10   ***     #> YEARN3:L2_ID:TREAT2:DENSLow    +7.256    1.155        6.285     1.401e-08   ***     #> YEARN1:AV:TREAT1:DENSHigh      +8.000    2.405        3.326     0.001307    **      #> YEARN2:AV:TREAT1:DENSHigh      +14.532   2.405        6.042     4.02e-08    ***     #> YEARN3:AV:TREAT1:DENSHigh      +16.668   2.405        6.930     7.959e-10   ***     #> YEARN1:AV:TREAT2:DENSHigh      +10.452   3.124        3.346     0.001228    **      #> YEARN2:AV:TREAT2:DENSHigh      +15.438   3.124        4.942     3.895e-06   ***     #> YEARN3:AV:TREAT2:DENSHigh      +15.672   3.124        5.017     2.888e-06   ***     #> YEARN1:AV:TREAT1:DENSLow       +7.187    2.405        2.988     0.003678    **      #> YEARN2:AV:TREAT1:DENSLow       +16.129   2.405        6.706     2.172e-09   ***     #> YEARN3:AV:TREAT1:DENSLow       +15.116   2.405        6.285     1.398e-08   ***     #> YEARN1:AV:TREAT2:DENSLow       +10.213   3.124        3.269     0.001563    **      #> YEARN2:AV:TREAT2:DENSLow       +15.793   3.124        5.056     2.473e-06   ***     #> YEARN3:AV:TREAT2:DENSLow       +14.843   3.124        4.752     8.23e-06    ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 144 total; 84 residual #> Residual standard error: 1.299215  #>  #> Marginal variance covariance matrix #>        1      2      3 #> 1 1.6880 1.0018 1.0018 #> 2 1.0018 1.6880 1.0018 #> 3 1.0018 1.0018 1.6880 #>   Standard Deviations: 1.2992 1.2992 1.2992"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":null,"dir":"Reference","previous_headings":"","what":"The Belgium dataset — dataBEL","title":"The Belgium dataset — dataBEL","text":"Single site dataset containing thirty experimental units (plots), four species seeded two density levels, representing fifteen communities. Three ecosystem function responses recorded plot single time point. Data stacked format.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Belgium dataset — dataBEL","text":"","code":"data(\"dataBEL\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The Belgium dataset — dataBEL","text":"data frame 90 observations following 9 variables. Plot numeric vector indicating ID experimental unit observation recorded G1 numeric vector ranging 0 1, proportion species G1 G2 numeric vector ranging 0 1, proportion species G2 L1 numeric vector ranging 0 1, proportion species L1 L2 numeric vector ranging 0 1, proportion species L2 Density vector factors two levels, -1 1, representing seeding density plot Var character vector indicating ecosystem function recorded VarNum vector factors three levels, 1, 2, 3 indicating ecosystem function recorded Y numeric vector indicating value ecosystem function recorded","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Belgium dataset — dataBEL","text":"Data comes single site wider agrodiversity experiment conducted Belgium, established 2002.  four species used Lolium perenne (G1), Phleum pratense (G2), Trifolium pratense (L1), Trifolium repens (L2). two recommended functional groupings: grouping grasses (G1, G2) legumes (L1, L2), grouping fast-establishing species (G1, L1) temporally persistent species (G2, L2).  Three ecosystem functions recorded summing recordings four harvests first year experiment: (1) aboveground biomass sown species (Sown) (t DM ha-1), (2) aboveground biomass weed species (Weed) (t DM ha-1) (3) total annual yield nitrogen harvested aboveground biomass (N) (t DM ha-1).","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Belgium dataset — dataBEL","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Belgium dataset — dataBEL","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataBEL.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Belgium dataset — dataBEL","text":"","code":"#################################################################################################### #################################################################################################### #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE> ## Modelling Example  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # vignette(\"DImulti_workflow\")  # # In this example, we repeat the analysis in Dooley et al. 2015.  head(dataBEL) #>   Plot  G1  G2  L1  L2 Density  Var VarNum       Y #> 1    1 0.7 0.1 0.1 0.1       1 Sown      1 104.156 #> 2    1 0.7 0.1 0.1 0.1       1 Weed      2 100.058 #> 3    1 0.7 0.1 0.1 0.1       1    N      3  87.996 #> 4    2 0.1 0.7 0.1 0.1       1 Sown      1  82.547 #> 5    2 0.1 0.7 0.1 0.1       1 Weed      2  89.801 #> 6    2 0.1 0.7 0.1 0.1       1    N      3  72.239  # We begin with the main function DImulti(), passing the initial species proportions column names # through 'prop' and the response value column name through 'y'. # As the data is in a long or stacked format, we specify the ecosystem function type through the # first index of the 'eco_func' parameter, along with specifying that we want an unstructured # Sigma for these response types. # The experimental unit ID is stored in the column \"Plot\" and so we pass this to 'unit_IDs'. # Rather than estimating the nonlinear parameter theta, we opt to provide a value for each # ecosystem function type through the parameter 'theta', which will be applied to the # interaction terms as a power. In this case, we use functional group (FG) interactions, which # requires an additional argument FG to be provided, specifying which group each species present # in 'prop' belongs to. In this case, we group the grasses and the legumes. # We include the treatment Density as an additional fixed effect. # We opt to use the REML estimation method as we will not be doing any model comparisons. # Finally, we specify the data object, dataBEL, through 'data'.  belModel <- DImulti(prop = c(\"G1\", \"G2\", \"L1\", \"L2\"), y = \"Y\", eco_func = c(\"Var\", \"un\"),                      unit_IDs = \"Plot\", theta = c(0.5, 1, 1.2), DImodel = \"FG\",                      FG = c(\"Grass\", \"Grass\", \"Legume\", \"Legume\"), extra_fixed = ~ Density,                      method = \"REML\", data = dataBEL)  # We can now print the output from our model, stored in belModel with class DImulti.  print(belModel) #> Note:  #> Method Used = REML  #> Correlation Structure Used = un #>  Functional Group Model #> Theta value(s) = N:0.5, Sown:1, Weed:1.2 #>  #> Generalized least squares fit by REML #>   Model: Y ~ 0 + Var:((G1_ID + G2_ID + L1_ID + L2_ID + FG.bfg_Grass_Legume +      FG.wfg_Grass + FG.wfg_Legume) + Density)  #>       AIC       BIC    logLik  #>  488.8132  554.5029 -214.4066  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | Plot  #>  Parameter estimate(s): #>  Correlation:  #>   1     2     #> 2 0.797       #> 3 0.065 0.523 #>  #>  #> Table: Fixed Effect Coefficients #>  #>                               Beta       Std. Error   t-value   p-value     Signif  #> ----------------------------  ---------  -----------  --------  ----------  ------- #> VarN:G1_ID                    +44.867    4.209        10.661    5.433e-16   ***     #> VarSown:G1_ID                 +65.337    4.656        14.033    1.745e-21   ***     #> VarWeed:G1_ID                 +79.372    9.039        8.781     1.065e-12   ***     #> VarN:G2_ID                    +28.926    4.209        6.873     2.722e-09   ***     #> VarSown:G2_ID                 +46.808    4.656        10.053    6.096e-15   ***     #> VarWeed:G2_ID                 +90.654    9.039        10.029    6.706e-15   ***     #> VarN:L1_ID                    +98.246    4.209        23.344    1.322e-33   ***     #> VarSown:L1_ID                 +76.396    4.656        16.408    5.561e-25   ***     #> VarWeed:L1_ID                 +50.032    9.039        5.535     5.782e-07   ***     #> VarN:L2_ID                    +77.067    4.209        18.312    1.438e-27   ***     #> VarSown:L2_ID                 +51.062    4.656        10.967    1.629e-16   ***     #> VarWeed:L2_ID                 +33.951    9.039        3.756     0.0003674   ***     #> VarN:FG.bfg_Grass_Legume      +14.538    13.281       1.095     0.2777              #> VarSown:FG.bfg_Grass_Legume   +86.492    18.699       4.625     1.796e-05   ***     #> VarWeed:FG.bfg_Grass_Legume   +152.157   49.542       3.071     0.003095    **      #> VarN:FG.wfg_Grass             +58.483    28.072       2.083     0.0411      *       #> VarSown:FG.wfg_Grass          +107.670   41.360       2.603     0.0114      *       #> VarWeed:FG.wfg_Grass          -9.702     108.079      -0.090    0.9287              #> VarN:FG.wfg_Legume            -16.215    28.072       -0.578    0.5655              #> VarSown:FG.wfg_Legume         +60.847    41.360       1.471     0.146               #> VarWeed:FG.wfg_Legume         +242.472   108.079      2.243     0.02823     *       #> VarN:Density1                 -1.261     2.348        -0.537    0.593               #> VarSown:Density1              +2.290     2.618        0.875     0.3849              #> VarWeed:Density1              +0.991     5.083        0.195     0.846               #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 90 total; 66 residual #> Residual standard error: 6.428977  #>  #> Marginal variance covariance matrix #>            N   Sown     Weed #> N    41.3320 36.716   5.8403 #> Sown 36.7160 51.407  52.2200 #> Weed  5.8403 52.220 193.7900 #>   Standard Deviations: 6.429 7.1699 13.921   # We can also retrieve the variance covariance matrix information from this object.  summary(belModel$corr[[1]]) #> Correlation Structure: General #>  Formula: ~0 | Plot  #>  Parameter estimate(s): #>  Correlation:  #>   1     2     #> 2 0.797       #> 3 0.065 0.523 nlme::getVarCov(belModel) #> Marginal variance covariance matrix #>            N   Sown     Weed #> N    41.3320 36.716   5.8403 #> Sown 36.7160 51.407  52.2200 #> Weed  5.8403 52.220 193.7900 #>   Standard Deviations: 6.429 7.1699 13.921"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":null,"dir":"Reference","previous_headings":"","what":"The Sweden dataset — dataSWE","title":"The Sweden dataset — dataSWE","text":"Single site dataset containing 48 experimental units (plots), four species seeded two density levels, representing fifteen communities. One ecosystem function response recorded plot three time points.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Sweden dataset — dataSWE","text":"","code":"data(\"dataSWE\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The Sweden dataset — dataSWE","text":"data frame 432 observations following 9 variables. YEARN numeric vector indicating time point (year) ecosystem     function recording measured PLOT numeric vector indicating ID experimental unit     observation recorded TREAT vector factors two levels, 1 2, indicating treatment     applied plot G1 numeric vector ranging 0 1, proportion species G1 G2 numeric vector ranging 0 1, proportion species G2 L1 numeric vector ranging 0 1, proportion species L1 L2 numeric vector ranging 0 1, proportion species L2 DENS character vector representing seeding density plot (-1 1) YIELD numeric vector indicating value harvest recorded","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Sweden dataset — dataSWE","text":"Data comes single site wider agrodiversity experiment conducted Sweden.  four species used Lolium perenne (G1), Dactylis glomerata (G2), Trifolium pratense (L1), Trifolium repens (L2). two recommended functional groupings: grouping grasses (G1, G2) legumes (L1, L2), grouping fast-establishing species (G1, L1) temporally persistent species (G2, L2).  One ecosystem function (aboveground biomass (t DM ha-1)) recorded summing recordings four harvests year, three years.  treatment applied varied quantity nitrogen applied (core plots quantity 0 units treated plots 180 units applied).","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"The Sweden dataset — dataSWE","text":"Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Sweden dataset — dataSWE","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, ., Carnus, T., Collins, R.P., Cop, J., Delgado, .,  De Vliegher, ., Elgersma ., Frankow-Lindberg, B., Golinski, P., Grieu, P., Gustavsson, .M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadžiulienė, Ž., Lunnan, T., Lüscher, ., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U., Walmsley, D., Finn, J., 2014.  Agrodiversity Experiment: three years data multisite study intensively managed grasslands. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/dataSWE.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Sweden dataset — dataSWE","text":"","code":"#################################################################################################### #################################################################################################### #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE> ## Modelling Example  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # vignette(\"DImulti_workflow\")   head(dataSWE) #>   YEARN PLOT TREAT DENS   G1   G2   L1   L2     YIELD #> 1     1    1     1 High 0.70 0.10 0.10 0.10  7.774822 #> 2     1    2     1 High 0.10 0.70 0.10 0.10 10.302994 #> 3     1    3     1 High 0.10 0.10 0.70 0.10 12.643246 #> 4     1    4     1 High 0.10 0.10 0.10 0.70 12.174211 #> 5     1    5     1 High 0.25 0.25 0.25 0.25  9.063782 #> 6     1    6     1 High 0.40 0.40 0.10 0.10  9.148516  # We begin by transforming the time identifier column to a factor, to better group coefficients  dataSWE$YEARN <- as.factor(dataSWE$YEARN)  # We fit a repeated measures DI model using the main function DImulti(). # We begin by passing the initial species proportions column names through 'prop' and the # response value column name through 'y'. # As the data contains multiple time points, we include the 'time' parameter, through which we # specify the column name containing the repeated measure indicator and the autocorrelation # structure we want to use, in this case, we use compound symmetry (CS). # The experimental unit ID is stored in the column \"PLOT\" and so we pass this to 'unit_IDs'. # We request that the method fits an average interaction structure and we include the treatments # DENS and TREAT as additional fixed effects. # We opt to use the ML estimation method to allow for model comparisons with different fixed # effects. # Finally, we specify the data object, dataSWE, through 'data'.  SWEmodel <- DImulti(y = \"YIELD\", time = c(\"YEARN\", \"CS\"), unit_IDs = \"PLOT\",                     prop = 5:8, data = dataSWE, DImodel = \"AV\",                     extra_fixed = ~ 1:(DENS:TREAT),                     method = \"ML\")  print(SWEmodel) #> Note:  #> Method Used = ML  #> Correlation Structure Used = CS #>  Average Term Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID + AV):(DENS:TREAT))  #>       AIC       BIC    logLik  #>  481.5727  665.7011 -178.7863  #>  #>  Repeated Measure Correlation Structure: Compound symmetry #>  Formula: ~0 | PLOT  #>  Parameter estimate(s): #>       Rho  #> 0.5934976  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                                Beta      Std. Error   t-value   p-value     Signif  #> -----------------------------  --------  -----------  --------  ----------  ------- #> YEARN1:G1_ID:DENSHigh:TREAT1   +7.247    1.103        6.569     3.999e-09   ***     #> YEARN2:G1_ID:DENSHigh:TREAT1   +4.404    1.103        3.992     0.0001397   ***     #> YEARN3:G1_ID:DENSHigh:TREAT1   +2.749    1.103        2.492     0.01467     *       #> YEARN1:G1_ID:DENSLow:TREAT1    +7.564    1.103        6.856     1.111e-09   ***     #> YEARN2:G1_ID:DENSLow:TREAT1    +3.748    1.103        3.397     0.001042    **      #> YEARN3:G1_ID:DENSLow:TREAT1    +2.861    1.103        2.593     0.01122     *       #> YEARN1:G1_ID:DENSHigh:TREAT2   +10.605   1.155        9.185     2.52e-14    ***     #> YEARN2:G1_ID:DENSHigh:TREAT2   +7.905    1.155        6.847     1.159e-09   ***     #> YEARN3:G1_ID:DENSHigh:TREAT2   +6.164    1.155        5.339     7.821e-07   ***     #> YEARN1:G1_ID:DENSLow:TREAT2    +9.509    1.155        8.236     2.041e-12   ***     #> YEARN2:G1_ID:DENSLow:TREAT2    +7.103    1.155        6.152     2.499e-08   ***     #> YEARN3:G1_ID:DENSLow:TREAT2    +5.447    1.155        4.717     9.423e-06   ***     #> YEARN1:G2_ID:DENSHigh:TREAT1   +7.412    1.103        6.718     2.057e-09   ***     #> YEARN2:G2_ID:DENSHigh:TREAT1   +5.286    1.103        4.792     7.053e-06   ***     #> YEARN3:G2_ID:DENSHigh:TREAT1   +4.293    1.103        3.891     0.0001991   ***     #> YEARN1:G2_ID:DENSLow:TREAT1    +7.629    1.103        6.915     8.52e-10    ***     #> YEARN2:G2_ID:DENSLow:TREAT1    +6.194    1.103        5.614     2.489e-07   ***     #> YEARN3:G2_ID:DENSLow:TREAT1    +4.791    1.103        4.343     3.908e-05   ***     #> YEARN1:G2_ID:DENSHigh:TREAT2   +12.244   1.155        10.605    3.612e-17   ***     #> YEARN2:G2_ID:DENSHigh:TREAT2   +11.280   1.155        9.770     1.68e-15    ***     #> YEARN3:G2_ID:DENSHigh:TREAT2   +9.434    1.155        8.170     2.764e-12   ***     #> YEARN1:G2_ID:DENSLow:TREAT2    +12.185   1.155        10.553    4.58e-17    ***     #> YEARN2:G2_ID:DENSLow:TREAT2    +10.478   1.155        9.075     4.199e-14   ***     #> YEARN3:G2_ID:DENSLow:TREAT2    +9.152    1.155        7.926     8.517e-12   ***     #> YEARN1:L1_ID:DENSHigh:TREAT1   +9.475    1.103        8.589     3.991e-13   ***     #> YEARN2:L1_ID:DENSHigh:TREAT1   +7.245    1.103        6.567     4.027e-09   ***     #> YEARN3:L1_ID:DENSHigh:TREAT1   +3.269    1.103        2.963     0.003964    **      #> YEARN1:L1_ID:DENSLow:TREAT1    +8.150    1.103        7.388     1.005e-10   ***     #> YEARN2:L1_ID:DENSLow:TREAT1    +5.371    1.103        4.868     5.223e-06   ***     #> YEARN3:L1_ID:DENSLow:TREAT1    +3.773    1.103        3.420     0.0009679   ***     #> YEARN1:L1_ID:DENSHigh:TREAT2   +11.322   1.155        9.806     1.422e-15   ***     #> YEARN2:L1_ID:DENSHigh:TREAT2   +9.371    1.155        8.116     3.553e-12   ***     #> YEARN3:L1_ID:DENSHigh:TREAT2   +5.873    1.155        5.086     2.19e-06    ***     #> YEARN1:L1_ID:DENSLow:TREAT2    +10.581   1.155        9.164     2.774e-14   ***     #> YEARN2:L1_ID:DENSLow:TREAT2    +8.815    1.155        7.634     3.256e-11   ***     #> YEARN3:L1_ID:DENSLow:TREAT2    +6.277    1.155        5.436     5.231e-07   ***     #> YEARN1:L2_ID:DENSHigh:TREAT1   +8.638    1.103        7.829     1.33e-11    ***     #> YEARN2:L2_ID:DENSHigh:TREAT1   +7.772    1.103        7.045     4.75e-10    ***     #> YEARN3:L2_ID:DENSHigh:TREAT1   +5.782    1.103        5.241     1.169e-06   ***     #> YEARN1:L2_ID:DENSLow:TREAT1    +8.184    1.103        7.418     8.743e-11   ***     #> YEARN2:L2_ID:DENSLow:TREAT1    +7.295    1.103        6.613     3.297e-09   ***     #> YEARN3:L2_ID:DENSLow:TREAT1    +6.697    1.103        6.070     3.556e-08   ***     #> YEARN1:L2_ID:DENSHigh:TREAT2   +8.531    1.155        7.389     1e-10       ***     #> YEARN2:L2_ID:DENSHigh:TREAT2   +8.047    1.155        6.969     6.686e-10   ***     #> YEARN3:L2_ID:DENSHigh:TREAT2   +6.793    1.155        5.883     7.95e-08    ***     #> YEARN1:L2_ID:DENSLow:TREAT2    +8.235    1.155        7.132     3.201e-10   ***     #> YEARN2:L2_ID:DENSLow:TREAT2    +8.091    1.155        7.007     5.635e-10   ***     #> YEARN3:L2_ID:DENSLow:TREAT2    +7.256    1.155        6.284     1.401e-08   ***     #> YEARN1:AV:DENSHigh:TREAT1      +8.000    2.405        3.326     0.001307    **      #> YEARN2:AV:DENSHigh:TREAT1      +14.532   2.405        6.042     4.02e-08    ***     #> YEARN3:AV:DENSHigh:TREAT1      +16.668   2.405        6.930     7.961e-10   ***     #> YEARN1:AV:DENSLow:TREAT1       +7.187    2.405        2.988     0.003678    **      #> YEARN2:AV:DENSLow:TREAT1       +16.129   2.405        6.706     2.173e-09   ***     #> YEARN3:AV:DENSLow:TREAT1       +15.116   2.405        6.285     1.398e-08   ***     #> YEARN1:AV:DENSHigh:TREAT2      +10.452   3.124        3.346     0.001228    **      #> YEARN2:AV:DENSHigh:TREAT2      +15.438   3.124        4.942     3.895e-06   ***     #> YEARN3:AV:DENSHigh:TREAT2      +15.672   3.124        5.017     2.888e-06   ***     #> YEARN1:AV:DENSLow:TREAT2       +10.213   3.124        3.269     0.001563    **      #> YEARN2:AV:DENSLow:TREAT2       +15.793   3.124        5.056     2.473e-06   ***     #> YEARN3:AV:DENSLow:TREAT2       +14.843   3.124        4.752     8.231e-06   ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 144 total; 84 residual #> Residual standard error: 0.9922969  #>  #> Marginal variance covariance matrix #>         1       2       3 #> 1 0.98465 0.58439 0.58439 #> 2 0.58439 0.98465 0.58439 #> 3 0.58439 0.58439 0.98465 #>   Standard Deviations: 0.9923 0.9923 0.9923   # We can now make any changes to the model's fixed effects and use a series of anovas (if the # models are nested) or information criteria such as AIC, AICc, BIC, or BICc to select a final model # We choose to change the interactions structure to functional groups, grouping the grasses and # legumes, and simplify the extra_fixed terms, as an example, by only crossing the ID effect of G1 # with the treatments, and no longer crossing them with each other.  SWEmodel2 <- DImulti(y = \"YIELD\", time = c(\"YEARN\", \"CS\"), unit_IDs = \"PLOT\",                     prop = 5:8, data = dataSWE, DImodel = \"FG\", FG = c(\"G\", \"G\", \"L\", \"L\"),                     extra_fixed = ~ G1_ID:(DENS+TREAT),                     method = \"ML\")  BICc(SWEmodel); BICc(SWEmodel2) #> [1] 905.3566 #> [1] 588.6466  # We select the model with the lower information criteria, which is our functional group model, and # refit it using the \"REML\" estimation method, for unbiased estimates.  SWEmodel2 <- DImulti(y = \"YIELD\", time = c(\"YEARN\", \"CS\"), unit_IDs = \"PLOT\",                     prop = 5:8, data = dataSWE, DImodel = \"FG\", FG = c(\"G\", \"G\", \"L\", \"L\"),                     extra_fixed = ~ G1_ID:(DENS+TREAT),                     method = \"REML\")  # With this model, we can examine the coefficients  coef(SWEmodel2) #>         YEARN1:G1_ID         YEARN2:G1_ID         YEARN3:G1_ID  #>            7.5729869            3.9436908            2.5825595  #>         YEARN1:G2_ID         YEARN2:G2_ID         YEARN3:G2_ID  #>           10.2715952            8.3922725            6.9327048  #>         YEARN1:L1_ID         YEARN2:L1_ID         YEARN3:L1_ID  #>            9.4996347            7.6097151            4.7693333  #>         YEARN1:L2_ID         YEARN2:L2_ID         YEARN3:L2_ID  #>            8.0816864            7.7804133            6.6584057  #>    YEARN1:FG.bfg_G_L    YEARN2:FG.bfg_G_L    YEARN3:FG.bfg_G_L  #>           10.8208347           13.5505353           14.4412685  #>      YEARN1:FG.wfg_G      YEARN2:FG.wfg_G      YEARN3:FG.wfg_G  #>          -10.9099707           11.6936379           12.6962405  #>      YEARN1:FG.wfg_L      YEARN2:FG.wfg_L      YEARN3:FG.wfg_L  #>           10.5492339           17.8021550           15.4746646  #> YEARN1:G1_ID:DENSLow YEARN2:G1_ID:DENSLow YEARN3:G1_ID:DENSLow  #>           -0.7974119           -0.6232490           -0.3472993  #>  YEARN1:G1_ID:TREAT2  YEARN2:G1_ID:TREAT2  YEARN3:G1_ID:TREAT2  #>            4.3168232            4.8914212            4.1921989   # or the variance and correlation structures  SWEmodel2$corr #> $`Repeated Measure` #> Correlation structure of class corCompSymm representing #>       Rho  #> 0.8244173  #>  nlme::getVarCov(SWEmodel2) #> Marginal variance covariance matrix #>        1      2      3 #> 1 2.7966 2.3055 2.3055 #> 2 2.3055 2.7966 2.3055 #> 3 2.3055 2.3055 2.7966 #>   Standard Deviations: 1.6723 1.6723 1.6723"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/getVarCov.DImulti.html","id":null,"dir":"Reference","previous_headings":"","what":"getVarCov.DImulti — getVarCov.DImulti","title":"getVarCov.DImulti — getVarCov.DImulti","text":"Extract variance-covariance matrix fitted DImulti model","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/getVarCov.DImulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getVarCov.DImulti — getVarCov.DImulti","text":"","code":"# S3 method for class 'DImulti' getVarCov(obj, ...)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/getVarCov.DImulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getVarCov.DImulti — getVarCov.DImulti","text":"obj object class DImulti ... methods generic function require additional arguments. None used method.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/getVarCov.DImulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"getVarCov.DImulti — getVarCov.DImulti","text":"variance-covariance matrix named list variance-covariance matrices.","code":""},{"path":[]},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/predict.DImulti.html","id":null,"dir":"Reference","previous_headings":"","what":"predict.DImulti — predict.DImulti","title":"predict.DImulti — predict.DImulti","text":"Predict multivariate repeated measures DI model","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/predict.DImulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"predict.DImulti — predict.DImulti","text":"","code":"# S3 method for class 'DImulti' predict(object, newdata = NULL, stacked = TRUE, ...)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/predict.DImulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"predict.DImulti — predict.DImulti","text":"object object class DImulti newdata optional dataframe containing communities predict. data multivariate wide format, predict subset ecosystem functions, opposed , please include column function numerical value, e.g. newdata$Y2 <- 0. predicting functions, columns may included left . stacked logical value used determine whether output wide stacked format. Defaults TRUE, meaning output stacked/long.  set FALSE, non-unique groups unit_IDs, ecosystem function, time points aggregated upon widening using mean function, please use unique unit_IDs values newdata avoid aggregation. ... methods generic function require additional arguments. None used method.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/predict.DImulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"predict.DImulti — predict.DImulti","text":"predictions supplied fitted DI models provided 'newdata', data used fit model 'newdata' supplied. Predictions returned either stacked wide dataframe format.","code":""},{"path":[]},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.DImulti.html","id":null,"dir":"Reference","previous_headings":"","what":"print.DImulti — print.DImulti","title":"print.DImulti — print.DImulti","text":"Print details fitted DI models supplied","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.DImulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.DImulti — print.DImulti","text":"","code":"# S3 method for class 'DImulti' print(x, ...)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.DImulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.DImulti — print.DImulti","text":"x object class DImulti ... methods generic function require additional arguments. None used method.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.DImulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.DImulti — print.DImulti","text":"object x","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.DImulti.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"print.DImulti — print.DImulti","text":"appearance printed information differ depending whether user installed combination suggested packages \"crayon\", \"cli\", \"fansi\". changes mainly cosmetic, crayon making output easier read, cli providing links help files, fansi enabling reading special characters R markdown (Rmd) files. See 'Examples' suggested code include Rmd files.","code":""},{"path":[]},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.DImulti.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"print.DImulti — print.DImulti","text":"","code":"## Set up for R markdown for crayon and cli output if user has packages installed  if(requireNamespace(\"fansi\", quietly = TRUE) &    requireNamespace(\"crayon\", quietly = TRUE) &    requireNamespace(\"cli\", quietly = TRUE)) {  options(crayon.enabled = TRUE)   ansi_aware_handler <- function(x, options)  {   paste0(     \"<pre class=\\\"r-output\\\"><code>\",     fansi::sgr_to_html(x = x, warn = FALSE, term.cap = \"256\"),     \"<\/code><\/pre>\"   )  }   old_hooks <- fansi::set_knit_hooks(knitr::knit_hooks,                                     which = c(\"output\", \"message\", \"error\", \"warning\"))   knitr::knit_hooks$set(    output = ansi_aware_handler,    message = ansi_aware_handler,    warning = ansi_aware_handler,    error = ansi_aware_handler   )  } #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE> #################################################################################################  ## Usage  model <- DImulti(prop = c(\"G1\", \"G2\", \"L1\", \"L2\"), y = \"Y\", eco_func = c(\"Var\", \"un\"),                  unit_IDs = \"Plot\", theta = c(0.5, 1, 1.2), DImodel = \"FG\",                  FG = c(\"Grass\", \"Grass\", \"Legume\", \"Legume\"), extra_fixed = ~ Density,                  method = \"REML\", data = dataBEL)  print(model) #> Note:  #> Method Used = REML  #> Correlation Structure Used = un #>  Functional Group Model #> Theta value(s) = N:0.5, Sown:1, Weed:1.2 #>  #> Generalized least squares fit by REML #>   Model: Y ~ 0 + Var:((G1_ID + G2_ID + L1_ID + L2_ID + FG.bfg_Grass_Legume +      FG.wfg_Grass + FG.wfg_Legume) + Density)  #>       AIC       BIC    logLik  #>  488.8132  554.5029 -214.4066  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | Plot  #>  Parameter estimate(s): #>  Correlation:  #>   1     2     #> 2 0.797       #> 3 0.065 0.523 #>  #>  #> Table: Fixed Effect Coefficients #>  #>                               Beta       Std. Error   t-value   p-value     Signif  #> ----------------------------  ---------  -----------  --------  ----------  ------- #> VarN:G1_ID                    +44.867    4.209        10.661    5.433e-16   ***     #> VarSown:G1_ID                 +65.337    4.656        14.033    1.745e-21   ***     #> VarWeed:G1_ID                 +79.372    9.039        8.781     1.065e-12   ***     #> VarN:G2_ID                    +28.926    4.209        6.873     2.722e-09   ***     #> VarSown:G2_ID                 +46.808    4.656        10.053    6.096e-15   ***     #> VarWeed:G2_ID                 +90.654    9.039        10.029    6.706e-15   ***     #> VarN:L1_ID                    +98.246    4.209        23.344    1.322e-33   ***     #> VarSown:L1_ID                 +76.396    4.656        16.408    5.561e-25   ***     #> VarWeed:L1_ID                 +50.032    9.039        5.535     5.782e-07   ***     #> VarN:L2_ID                    +77.067    4.209        18.312    1.438e-27   ***     #> VarSown:L2_ID                 +51.062    4.656        10.967    1.629e-16   ***     #> VarWeed:L2_ID                 +33.951    9.039        3.756     0.0003674   ***     #> VarN:FG.bfg_Grass_Legume      +14.538    13.281       1.095     0.2777              #> VarSown:FG.bfg_Grass_Legume   +86.492    18.699       4.625     1.796e-05   ***     #> VarWeed:FG.bfg_Grass_Legume   +152.157   49.542       3.071     0.003095    **      #> VarN:FG.wfg_Grass             +58.483    28.072       2.083     0.0411      *       #> VarSown:FG.wfg_Grass          +107.670   41.360       2.603     0.0114      *       #> VarWeed:FG.wfg_Grass          -9.702     108.079      -0.090    0.9287              #> VarN:FG.wfg_Legume            -16.215    28.072       -0.578    0.5655              #> VarSown:FG.wfg_Legume         +60.847    41.360       1.471     0.146               #> VarWeed:FG.wfg_Legume         +242.472   108.079      2.243     0.02823     *       #> VarN:Density1                 -1.261     2.348        -0.537    0.593               #> VarSown:Density1              +2.290     2.618        0.875     0.3849              #> VarWeed:Density1              +0.991     5.083        0.195     0.846               #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 90 total; 66 residual #> Residual standard error: 6.428977  #>  #> Marginal variance covariance matrix #>            N   Sown     Weed #> N    41.3320 36.716   5.8403 #> Sown 36.7160 51.407  52.2200 #> Weed  5.8403 52.220 193.7900 #>   Standard Deviations: 6.429 7.1699 13.921"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.summary.DImulti.html","id":null,"dir":"Reference","previous_headings":"","what":"print.summary.DImulti — print.summary.DImulti","title":"print.summary.DImulti — print.summary.DImulti","text":"print details object class summary.DImulti","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.summary.DImulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"print.summary.DImulti — print.summary.DImulti","text":"","code":"# S3 method for class 'summary.DImulti' print(x, verbose = FALSE, digits = .Options$digits, ...)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.summary.DImulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"print.summary.DImulti — print.summary.DImulti","text":"x object class DImulti verbose optional logical value used control amount output object printed. Defaults FALSE. digits number significant digits use printing ... methods generic function require additional arguments. None used method.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/print.summary.DImulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"print.summary.DImulti — print.summary.DImulti","text":"object x","code":""},{"path":[]},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMV.html","id":null,"dir":"Reference","previous_headings":"","what":"The simulated multivariate ","title":"The simulated multivariate ","text":"simMV dataset simulated multivariate DI model. contains 192 plots comprising six species vary proportions (p1 - p6). plot replicated testing two-level factor treat, included levels 0 1, resulting total 384 plots. four simulated responses (Y1 - Y4) recorded wide data format (one column per response). data simulated assuming existing covariances responses, additive treatment effect, species identity species interaction effects present.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMV.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The simulated multivariate ","text":"","code":"data(\"simMV\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMV.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The simulated multivariate ","text":"data frame 384 observations following twelve variables. plot numeric vector identifying unique experimental unit p1 numeric vector indicating initial proportion species 1 p2 numeric vector indicating initial proportion species 2 p3 numeric vector indicating initial proportion species 3 p4 numeric vector indicating initial proportion species 4 p5 numeric vector indicating initial proportion species 5 p6 numeric vector indicating initial proportion species 6 treat two-level factor indicating whether treatment applied (1)     (0) Y1 numeric vector giving simulated response ecosystem function 1 Y2 numeric vector giving simulated response ecosystem function 2 Y3 numeric vector giving simulated response ecosystem function 3 Y4 numeric vector giving simulated response ecosystem function 4","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMV.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The simulated multivariate ","text":"Diversity-Interactions (DI) models? Diversity-Interactions (DI) models (Kirwan et al., 2009) set tools analysing interpreting data experiments explore effects species diversity community-level responses. strongly recommend users read short introduction Diversity-Interactions models (available : DImodels). information Diversity-Interactions models also available Kirwan et al 2009 Connolly et al 2013. multivariate DI model developed Dooley et al., 2015. Parameter values simulation Multivariate DI models take general form : $${y}_{km} = {Identities}_{km} + {Interactions}_{km} + {Structures}_{k} + {\\epsilon}_{km}$$ \\(y\\) community-level responses, \\(Identities\\) effects species identities response enter model individual species proportions beginning time period, \\(Interactions\\) interactions among species proportions, \\(Structures\\) include experimental structures blocks, treatments density. dataset simMV simulated : identity effects six species response: Y1 = 6.9, -0.3, 6.6, 1.7, -0.8, 4.3 Y2 = 4.9, 3.6, 4.4, 2.3, 4.3, 6.6 Y3 = -0.3, 4.6, 1.2, 6.8, 1.4, 6.9 Y4 = 4.1, 4.2, -0.5, 4.9, 6.7, -0.9, -1.0 average pairwise interaction effect response: Y1 = 1.8 Y2 = 6.8 Y3 = 1.4 Y4 = 0.3 teatment effect response: Y1 = 3.5 Y2 = -0.3 Y3 = 5.5 Y4 = -1.0 \\(\\epsilon\\) assumed multivaraite normal distribution mean 0 Sigma:","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMV.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The simulated multivariate ","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMV.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The simulated multivariate ","text":"","code":"################################################################################################### ###################################################################################################  #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE>  ## Modelling Example  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # vignette(\"DImulti_workflow\")  # We use head() to view the dataset head(simMV) #>   plot p1 p2 p3 p4 p5 p6 treat        Y1       Y2         Y3         Y4 #> 1    1  1  0  0  0  0  0     0  1.880817 5.108158 -1.9712356  4.8247704 #> 2    2  1  0  0  0  0  0     0  7.103477 5.183822 -4.0598298  3.1094539 #> 3    3  0  1  0  0  0  0     0 -1.444736 6.900983  6.3342200  4.9055054 #> 4    4  0  1  0  0  0  0     0 -1.756776 4.784160  5.2155726  5.3583856 #> 5    5  0  0  1  0  0  0     0  5.311257 4.258924 -0.4694982 -2.3078377 #> 6    6  0  0  1  0  0  0     0  5.975319 3.148215  1.9509040 -0.6064387   # We can use the function DImulti() to fit a multivariate DI model, with an intercept for \"treat\" # for each ecosystem function. The dataset is wide, so the Y columns are all entered through 'y' # and the first index of eco_func is \"NA\". We fit the average interaction structure and use \"ML\" # so that we can perform model comparisons with varying fixed effects MVmodel <- DImulti(y = paste0(\"Y\", 1:4), eco_func = c(\"NA\", \"UN\"), unit_IDs = 1,                    prop = paste0(\"p\", 1:6), data = simMV, DImodel = \"AV\", extra_fixed = ~ treat,                    method = \"ML\") print(MVmodel) #> Note:  #> Method Used = ML  #> Correlation Structure Used = UN #>  Average Term Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: value ~ 0 + func:((p1_ID + p2_ID + p3_ID + p4_ID + p5_ID + p6_ID +      AV) + treat)  #>       AIC       BIC    logLik  #>  5602.953  5827.104 -2759.476  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      3      #> 2 -0.108               #> 3 -0.019 -0.033        #> 4  0.041  0.241 -0.104 #>  #>  #> Table: Fixed Effect Coefficients #>  #>                 Beta     Std. Error   t-value   p-value      Signif  #> --------------  -------  -----------  --------  -----------  ------- #> funcY1:p1_ID    +6.659   0.554        12.025    7.253e-32    ***     #> funcY2:p1_ID    +5.023   0.299        16.784    4.393e-58    ***     #> funcY3:p1_ID    -1.110   0.434        -2.557    0.01065      *       #> funcY4:p1_ID    +4.637   0.331        14.015    4.946e-42    ***     #> funcY1:p2_ID    -0.007   0.558        -0.013    0.9897               #> funcY2:p2_ID    +4.288   0.301        14.229    3.382e-43    ***     #> funcY3:p2_ID    +4.405   0.437        10.082    3.539e-23    ***     #> funcY4:p2_ID    +5.353   0.333        16.070    9.468e-54    ***     #> funcY1:p3_ID    +6.948   0.597        11.640    4.808e-30    ***     #> funcY2:p3_ID    +4.395   0.323        13.624    6.109e-40    ***     #> funcY3:p3_ID    +1.325   0.468        2.831     0.004695     **      #> funcY4:p3_ID    -0.614   0.357        -1.722    0.08536      +       #> funcY1:p4_ID    +2.581   0.545        4.733     2.422e-06    ***     #> funcY2:p4_ID    +1.993   0.295        6.763     1.93e-11     ***     #> funcY3:p4_ID    +5.873   0.427        13.745    1.384e-40    ***     #> funcY4:p4_ID    +5.400   0.326        16.577    8.141e-57    ***     #> funcY1:p5_ID    -1.034   0.581        -1.779    0.07552      +       #> funcY2:p5_ID    +4.733   0.314        15.070    6.646e-48    ***     #> funcY3:p5_ID    +1.448   0.455        3.180     0.001505     **      #> funcY4:p5_ID    +7.225   0.347        20.810    9.933e-85    ***     #> funcY1:p6_ID    +4.374   0.533        8.203     4.99e-16     ***     #> funcY2:p6_ID    +7.332   0.288        25.441    4.79e-119    ***     #> funcY3:p6_ID    +6.508   0.418        15.571    8.463e-51    ***     #> funcY4:p6_ID    -0.146   0.319        -0.458    0.6471               #> funcY1:AV       +2.215   1.085        2.041     0.04144      *       #> funcY2:AV       +7.502   0.586        12.791    1.228e-35    ***     #> funcY3:AV       +2.470   0.850        2.905     0.003727     **      #> funcY4:AV       +0.037   0.648        0.058     0.9541               #> funcY1:treat1   +3.368   0.214        15.702    1.447e-51    ***     #> funcY2:treat1   -0.449   0.116        -3.875    0.0001113    ***     #> funcY3:treat1   +5.602   0.168        33.329    7.422e-183   ***     #> funcY4:treat1   -1.002   0.128        -7.821    9.78e-15     ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 1536 total; 1504 residual #> Residual standard error: 2.079496  #>  #> Marginal variance covariance matrix #>           Y1        Y2        Y3       Y4 #> Y1  4.324300 -0.253190 -0.063976  0.10660 #> Y2 -0.253190  1.263000 -0.059597  0.33650 #> Y3 -0.063976 -0.059597  2.655800 -0.21084 #> Y4  0.106600  0.336500 -0.210840  1.54340 #>   Standard Deviations: 2.0795 1.1238 1.6297 1.2423   # We can adjust the previous model to now cross \"treat\" with each other ID effect. We also specify # different values of theta for each ecosystem function and use the \"REML\" method to get unbiased # estimates. # \\donttest{ MVmodel_theta <- DImulti(y = paste0(\"Y\", 1:4), eco_func = c(\"NA\", \"UN\"), unit_IDs = 1,                    prop = paste0(\"p\", 1:6), data = simMV, DImodel = \"AV\", extra_fixed = ~ 1:treat,                    theta = c(1, 0.5, 0.8, 0.6), method = \"REML\")  summary(MVmodel_theta) #> Generalized least squares fit by REML #>   Model: value ~ 0 + func:((p1_ID + p2_ID + p3_ID + p4_ID + p5_ID + p6_ID +      AV):treat)  #>   Data: data  #>        AIC      BIC    logLik #>   5656.549 6006.336 -2762.275 #>  #> Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      3      #> 2 -0.093               #> 3 -0.015 -0.026        #> 4  0.043  0.241 -0.109 #> Variance function: #>  Structure: Different standard deviations per stratum #>  Formula: ~0 | func  #>  Parameter estimates: #>        Y1        Y2        Y3        Y4  #> 1.0000000 0.5658241 0.7829125 0.5930811  #>  #> Coefficients: #>                         Value Std.Error   t-value p-value #> funcY1:p1_ID:treat0  6.074314 0.7699716  7.889010  0.0000 #> funcY2:p1_ID:treat0  6.281537 0.3739749 16.796678  0.0000 #> funcY3:p1_ID:treat0 -0.887469 0.5551350 -1.598654  0.1101 #> funcY4:p1_ID:treat0  4.824526 0.3988368 12.096491  0.0000 #> funcY1:p1_ID:treat1 10.435051 0.7699716 13.552514  0.0000 #> funcY2:p1_ID:treat1  5.879588 0.3739749 15.721876  0.0000 #> funcY3:p1_ID:treat1  4.650491 0.5551350  8.377225  0.0000 #> funcY4:p1_ID:treat1  3.602901 0.3988368  9.033523  0.0000 #> funcY1:p2_ID:treat0 -0.546413 0.7755777 -0.704524  0.4812 #> funcY2:p2_ID:treat0  4.871846 0.4089567 11.912865  0.0000 #> funcY3:p2_ID:treat0  4.884123 0.5869862  8.320676  0.0000 #> funcY4:p2_ID:treat0  5.533862 0.4329721 12.781106  0.0000 #> funcY1:p2_ID:treat1  3.753696 0.7755777  4.839872  0.0000 #> funcY2:p2_ID:treat1  4.809390 0.4089567 11.760146  0.0000 #> funcY3:p2_ID:treat1  9.723044 0.5869862 16.564347  0.0000 #> funcY4:p2_ID:treat1  4.332442 0.4329721 10.006285  0.0000 #> funcY1:p3_ID:treat0  6.523914 0.8321763  7.839582  0.0000 #> funcY2:p3_ID:treat0  5.022780 0.4179306 12.018214  0.0000 #> funcY3:p3_ID:treat0  1.035904 0.6149437  1.684551  0.0923 #> funcY4:p3_ID:treat0 -1.169494 0.4454722 -2.625291  0.0087 #> funcY1:p3_ID:treat1 10.544432 0.8321763 12.670911  0.0000 #> funcY2:p3_ID:treat1  5.470532 0.4179306 13.089569  0.0000 #> funcY3:p3_ID:treat1  7.494440 0.6149437 12.187196  0.0000 #> funcY4:p3_ID:treat1 -0.847901 0.4454722 -1.903375  0.0572 #> funcY1:p4_ID:treat0  2.921773 0.7576065  3.856584  0.0001 #> funcY2:p4_ID:treat0  2.954543 0.3715477  7.951988  0.0000 #> funcY3:p4_ID:treat0  5.602123 0.5527220 10.135517  0.0000 #> funcY4:p4_ID:treat0  5.373394 0.3970943 13.531782  0.0000 #> funcY1:p4_ID:treat1  5.423992 0.7576065  7.159379  0.0000 #> funcY2:p4_ID:treat1  2.802422 0.3715477  7.542563  0.0000 #> funcY3:p4_ID:treat1 12.046152 0.5527220 21.794232  0.0000 #> funcY4:p4_ID:treat1  4.612772 0.3970943 11.616312  0.0000 #> funcY1:p5_ID:treat0 -1.577562 0.8094772 -1.948865  0.0515 #> funcY2:p5_ID:treat0  5.984675 0.4092022 14.625227  0.0000 #> funcY3:p5_ID:treat0  1.199457 0.5986821  2.003496  0.0453 #> funcY4:p5_ID:treat0  7.751561 0.4352873 17.807918  0.0000 #> funcY1:p5_ID:treat1  2.695421 0.8094772  3.329829  0.0009 #> funcY2:p5_ID:treat1  5.097724 0.4092022 12.457714  0.0000 #> funcY3:p5_ID:treat1  7.577898 0.5986821 12.657633  0.0000 #> funcY4:p5_ID:treat1  5.891723 0.4352873 13.535251  0.0000 #> funcY1:p6_ID:treat0  3.895051 0.7403994  5.260743  0.0000 #> funcY2:p6_ID:treat0  8.300093 0.3688007 22.505633  0.0000 #> funcY3:p6_ID:treat0  6.201641 0.5409894 11.463517  0.0000 #> funcY4:p6_ID:treat0 -0.335013 0.3921846 -0.854224  0.3931 #> funcY1:p6_ID:treat1  8.061220 0.7403994 10.887664  0.0000 #> funcY2:p6_ID:treat1  8.125028 0.3688007 22.030947  0.0000 #> funcY3:p6_ID:treat1 12.741699 0.5409894 23.552587  0.0000 #> funcY4:p6_ID:treat1 -0.810038 0.3921846 -2.065452  0.0391 #> funcY1:AV:treat0     3.458425 1.5363658  2.251043  0.0245 #> funcY2:AV:treat0     1.228740 0.1473665  8.337984  0.0000 #> funcY3:AV:treat0     1.689570 0.5974726  2.827861  0.0047 #> funcY4:AV:treat0    -0.021516 0.2209063 -0.097399  0.9224 #> funcY1:AV:treat1     1.573802 1.5363658  1.024367  0.3058 #> funcY2:AV:treat1     0.993603 0.1473665  6.742389  0.0000 #> funcY3:AV:treat1     0.741279 0.5974726  1.240691  0.2149 #> funcY4:AV:treat1    -0.181836 0.2209063 -0.823135  0.4106 #>  #> Theta values: Y1:1, Y2:0.5, Y3:0.8, Y4:0.6 #>  #>  #>  Correlation:  #>                     fY1:1_ID:0 fY2:1_ID:0 fY3:1_ID:0 fY4:1_ID:0 fY1:1_ID:1 #> funcY2:p1_ID:treat0 -0.086                                                 #> funcY3:p1_ID:treat0 -0.015     -0.025                                      #> funcY4:p1_ID:treat0  0.041      0.241     -0.108                           #> funcY1:p1_ID:treat1  0.000      0.000      0.000      0.000                #> funcY2:p1_ID:treat1  0.000      0.000      0.000      0.000     -0.086     #> funcY3:p1_ID:treat1  0.000      0.000      0.000      0.000     -0.015     #> funcY4:p1_ID:treat1  0.000      0.000      0.000      0.000      0.041     #> funcY1:p2_ID:treat0  0.177     -0.001     -0.002      0.002      0.000     #> funcY2:p2_ID:treat0 -0.005     -0.020     -0.001     -0.001      0.000     #> funcY3:p2_ID:treat0 -0.002      0.000      0.082     -0.003      0.000     #> funcY4:p2_ID:treat0  0.004     -0.003     -0.005      0.008      0.000     #> funcY1:p2_ID:treat1  0.000      0.000      0.000      0.000      0.177     #> funcY2:p2_ID:treat1  0.000      0.000      0.000      0.000     -0.005     #> funcY3:p2_ID:treat1  0.000      0.000      0.000      0.000     -0.002     #> funcY4:p2_ID:treat1  0.000      0.000      0.000      0.000      0.004     #> funcY1:p3_ID:treat0  0.256     -0.005     -0.003      0.004      0.000     #> funcY2:p3_ID:treat0 -0.010      0.018     -0.002      0.009      0.000     #> funcY3:p3_ID:treat0 -0.003     -0.001      0.142     -0.009      0.000     #> funcY4:p3_ID:treat0  0.006      0.007     -0.011      0.052      0.000     #> funcY1:p3_ID:treat1  0.000      0.000      0.000      0.000      0.256     #> funcY2:p3_ID:treat1  0.000      0.000      0.000      0.000     -0.010     #> funcY3:p3_ID:treat1  0.000      0.000      0.000      0.000     -0.003     #> funcY4:p3_ID:treat1  0.000      0.000      0.000      0.000      0.006     #> funcY1:p4_ID:treat0  0.342     -0.014     -0.004      0.008      0.000     #> funcY2:p4_ID:treat0 -0.018      0.112     -0.004      0.032      0.000     #> funcY3:p4_ID:treat0 -0.004     -0.004      0.232     -0.019      0.000     #> funcY4:p4_ID:treat0  0.010      0.030     -0.021      0.145      0.000     #> funcY1:p4_ID:treat1  0.000      0.000      0.000      0.000      0.342     #> funcY2:p4_ID:treat1  0.000      0.000      0.000      0.000     -0.018     #> funcY3:p4_ID:treat1  0.000      0.000      0.000      0.000     -0.004     #> funcY4:p4_ID:treat1  0.000      0.000      0.000      0.000      0.010     #> funcY1:p5_ID:treat0  0.159      0.004     -0.001      0.000      0.000     #> funcY2:p5_ID:treat0  0.000     -0.100      0.001     -0.019      0.000     #> funcY3:p5_ID:treat0 -0.001      0.001      0.033      0.004      0.000     #> funcY4:p5_ID:treat0  0.002     -0.021      0.001     -0.064      0.000     #> funcY1:p5_ID:treat1  0.000      0.000      0.000      0.000      0.159     #> funcY2:p5_ID:treat1  0.000      0.000      0.000      0.000      0.000     #> funcY3:p5_ID:treat1  0.000      0.000      0.000      0.000     -0.001     #> funcY4:p5_ID:treat1  0.000      0.000      0.000      0.000      0.002     #> funcY1:p6_ID:treat0  0.215     -0.003     -0.002      0.003      0.000     #> funcY2:p6_ID:treat0 -0.004     -0.038      0.000     -0.005      0.000     #> funcY3:p6_ID:treat0 -0.002      0.000      0.087     -0.003      0.000     #> funcY4:p6_ID:treat0  0.003     -0.006     -0.004     -0.006      0.000     #> funcY1:p6_ID:treat1  0.000      0.000      0.000      0.000      0.215     #> funcY2:p6_ID:treat1  0.000      0.000      0.000      0.000     -0.004     #> funcY3:p6_ID:treat1  0.000      0.000      0.000      0.000     -0.002     #> funcY4:p6_ID:treat1  0.000      0.000      0.000      0.000      0.003     #> funcY1:AV:treat0    -0.583      0.026      0.007     -0.015      0.000     #> funcY2:AV:treat0     0.047     -0.323      0.012     -0.089      0.000     #> funcY3:AV:treat0     0.008      0.008     -0.471      0.039      0.000     #> funcY4:AV:treat0    -0.023     -0.078      0.051     -0.367      0.000     #> funcY1:AV:treat1     0.000      0.000      0.000      0.000     -0.583     #> funcY2:AV:treat1     0.000      0.000      0.000      0.000      0.047     #> funcY3:AV:treat1     0.000      0.000      0.000      0.000      0.008     #> funcY4:AV:treat1     0.000      0.000      0.000      0.000     -0.023     #>                     fY2:1_ID:1 fY3:1_ID:1 fY4:1_ID:1 fY1:2_ID:0 fY2:2_ID:0 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1 -0.025                                                 #> funcY4:p1_ID:treat1  0.241     -0.108                                      #> funcY1:p2_ID:treat0  0.000      0.000      0.000                           #> funcY2:p2_ID:treat0  0.000      0.000      0.000     -0.089                #> funcY3:p2_ID:treat0  0.000      0.000      0.000     -0.015     -0.026     #> funcY4:p2_ID:treat0  0.000      0.000      0.000      0.042      0.241     #> funcY1:p2_ID:treat1 -0.001     -0.002      0.002      0.000      0.000     #> funcY2:p2_ID:treat1 -0.020     -0.001     -0.001      0.000      0.000     #> funcY3:p2_ID:treat1  0.000      0.082     -0.003      0.000      0.000     #> funcY4:p2_ID:treat1 -0.003     -0.005      0.008      0.000      0.000     #> funcY1:p3_ID:treat0  0.000      0.000      0.000      0.139     -0.001     #> funcY2:p3_ID:treat0  0.000      0.000      0.000     -0.001     -0.035     #> funcY3:p3_ID:treat0  0.000      0.000      0.000     -0.001      0.000     #> funcY4:p3_ID:treat0  0.000      0.000      0.000      0.002     -0.005     #> funcY1:p3_ID:treat1 -0.005     -0.003      0.004      0.000      0.000     #> funcY2:p3_ID:treat1  0.018     -0.002      0.009      0.000      0.000     #> funcY3:p3_ID:treat1 -0.001      0.142     -0.009      0.000      0.000     #> funcY4:p3_ID:treat1  0.007     -0.011      0.052      0.000      0.000     #> funcY1:p4_ID:treat0  0.000      0.000      0.000      0.201     -0.007     #> funcY2:p4_ID:treat0  0.000      0.000      0.000     -0.006      0.024     #> funcY3:p4_ID:treat0  0.000      0.000      0.000     -0.002     -0.002     #> funcY4:p4_ID:treat0  0.000      0.000      0.000      0.004      0.009     #> funcY1:p4_ID:treat1 -0.014     -0.004      0.008      0.000      0.000     #> funcY2:p4_ID:treat1  0.112     -0.004      0.032      0.000      0.000     #> funcY3:p4_ID:treat1 -0.004      0.232     -0.019      0.000      0.000     #> funcY4:p4_ID:treat1  0.030     -0.021      0.145      0.000      0.000     #> funcY1:p5_ID:treat0  0.000      0.000      0.000      0.231     -0.011     #> funcY2:p5_ID:treat0  0.000      0.000      0.000     -0.011      0.081     #> funcY3:p5_ID:treat0  0.000      0.000      0.000     -0.003     -0.003     #> funcY4:p5_ID:treat0  0.000      0.000      0.000      0.006      0.022     #> funcY1:p5_ID:treat1  0.004     -0.001      0.000      0.000      0.000     #> funcY2:p5_ID:treat1 -0.100      0.001     -0.019      0.000      0.000     #> funcY3:p5_ID:treat1  0.001      0.033      0.004      0.000      0.000     #> funcY4:p5_ID:treat1 -0.021      0.001     -0.064      0.000      0.000     #> funcY1:p6_ID:treat0  0.000      0.000      0.000      0.194     -0.008     #> funcY2:p6_ID:treat0  0.000      0.000      0.000     -0.005      0.022     #> funcY3:p6_ID:treat0  0.000      0.000      0.000     -0.002     -0.002     #> funcY4:p6_ID:treat0  0.000      0.000      0.000      0.003      0.009     #> funcY1:p6_ID:treat1 -0.003     -0.002      0.003      0.000      0.000     #> funcY2:p6_ID:treat1 -0.038      0.000     -0.005      0.000      0.000     #> funcY3:p6_ID:treat1  0.000      0.087     -0.003      0.000      0.000     #> funcY4:p6_ID:treat1 -0.006     -0.004     -0.006      0.000      0.000     #> funcY1:AV:treat0     0.000      0.000      0.000     -0.480      0.027     #> funcY2:AV:treat0     0.000      0.000      0.000      0.038     -0.337     #> funcY3:AV:treat0     0.000      0.000      0.000      0.007      0.009     #> funcY4:AV:treat0     0.000      0.000      0.000     -0.019     -0.081     #> funcY1:AV:treat1     0.026      0.007     -0.015      0.000      0.000     #> funcY2:AV:treat1    -0.323      0.012     -0.089      0.000      0.000     #> funcY3:AV:treat1     0.008     -0.471      0.039      0.000      0.000     #> funcY4:AV:treat1    -0.078      0.051     -0.367      0.000      0.000     #>                     fY3:2_ID:0 fY4:2_ID:0 fY1:2_ID:1 fY2:2_ID:1 fY3:2_ID:1 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0 -0.109                                                 #> funcY1:p2_ID:treat1  0.000      0.000                                      #> funcY2:p2_ID:treat1  0.000      0.000     -0.089                           #> funcY3:p2_ID:treat1  0.000      0.000     -0.015     -0.026                #> funcY4:p2_ID:treat1  0.000      0.000      0.042      0.241     -0.109     #> funcY1:p3_ID:treat0 -0.001      0.002      0.000      0.000      0.000     #> funcY2:p3_ID:treat0  0.000     -0.005      0.000      0.000      0.000     #> funcY3:p3_ID:treat0  0.059     -0.002      0.000      0.000      0.000     #> funcY4:p3_ID:treat0 -0.002     -0.008      0.000      0.000      0.000     #> funcY1:p3_ID:treat1  0.000      0.000      0.139     -0.001     -0.001     #> funcY2:p3_ID:treat1  0.000      0.000     -0.001     -0.035      0.000     #> funcY3:p3_ID:treat1  0.000      0.000     -0.001      0.000      0.059     #> funcY4:p3_ID:treat1  0.000      0.000      0.002     -0.005     -0.002     #> funcY1:p4_ID:treat0 -0.002      0.005      0.000      0.000      0.000     #> funcY2:p4_ID:treat0 -0.002      0.009      0.000      0.000      0.000     #> funcY3:p4_ID:treat0  0.119     -0.009      0.000      0.000      0.000     #> funcY4:p4_ID:treat0 -0.008      0.051      0.000      0.000      0.000     #> funcY1:p4_ID:treat1  0.000      0.000      0.201     -0.007     -0.002     #> funcY2:p4_ID:treat1  0.000      0.000     -0.006      0.024     -0.002     #> funcY3:p4_ID:treat1  0.000      0.000     -0.002     -0.002      0.119     #> funcY4:p4_ID:treat1  0.000      0.000      0.004      0.009     -0.008     #> funcY1:p5_ID:treat0 -0.003      0.006      0.000      0.000      0.000     #> funcY2:p5_ID:treat0 -0.003      0.022      0.000      0.000      0.000     #> funcY3:p5_ID:treat0  0.161     -0.014      0.000      0.000      0.000     #> funcY4:p5_ID:treat0 -0.014      0.103      0.000      0.000      0.000     #> funcY1:p5_ID:treat1  0.000      0.000      0.231     -0.011     -0.003     #> funcY2:p5_ID:treat1  0.000      0.000     -0.011      0.081     -0.003     #> funcY3:p5_ID:treat1  0.000      0.000     -0.003     -0.003      0.161     #> funcY4:p5_ID:treat1  0.000      0.000      0.006      0.022     -0.014     #> funcY1:p6_ID:treat0 -0.002      0.005      0.000      0.000      0.000     #> funcY2:p6_ID:treat0 -0.001      0.007      0.000      0.000      0.000     #> funcY3:p6_ID:treat0  0.110     -0.009      0.000      0.000      0.000     #> funcY4:p6_ID:treat0 -0.007      0.045      0.000      0.000      0.000     #> funcY1:p6_ID:treat1  0.000      0.000      0.194     -0.008     -0.002     #> funcY2:p6_ID:treat1  0.000      0.000     -0.005      0.022     -0.001     #> funcY3:p6_ID:treat1  0.000      0.000     -0.002     -0.002      0.110     #> funcY4:p6_ID:treat1  0.000      0.000      0.003      0.009     -0.007     #> funcY1:AV:treat0     0.006     -0.014      0.000      0.000      0.000     #> funcY2:AV:treat0     0.011     -0.087      0.000      0.000      0.000     #> funcY3:AV:treat0    -0.420      0.039      0.000      0.000      0.000     #> funcY4:AV:treat0     0.045     -0.362      0.000      0.000      0.000     #> funcY1:AV:treat1     0.000      0.000     -0.480      0.027      0.006     #> funcY2:AV:treat1     0.000      0.000      0.038     -0.337      0.011     #> funcY3:AV:treat1     0.000      0.000      0.007      0.009     -0.420     #> funcY4:AV:treat1     0.000      0.000     -0.019     -0.081      0.045     #>                     fY4:2_ID:1 fY1:3_ID:0 fY2:3_ID:0 fY3:3_ID:0 fY4:3_ID:0 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0                                                        #> funcY1:p2_ID:treat1                                                        #> funcY2:p2_ID:treat1                                                        #> funcY3:p2_ID:treat1                                                        #> funcY4:p2_ID:treat1                                                        #> funcY1:p3_ID:treat0  0.000                                                 #> funcY2:p3_ID:treat0  0.000     -0.087                                      #> funcY3:p3_ID:treat0  0.000     -0.015     -0.026                           #> funcY4:p3_ID:treat0  0.000      0.042      0.241     -0.109                #> funcY1:p3_ID:treat1  0.002      0.000      0.000      0.000      0.000     #> funcY2:p3_ID:treat1 -0.005      0.000      0.000      0.000      0.000     #> funcY3:p3_ID:treat1 -0.002      0.000      0.000      0.000      0.000     #> funcY4:p3_ID:treat1 -0.008      0.000      0.000      0.000      0.000     #> funcY1:p4_ID:treat0  0.000      0.307     -0.015     -0.004      0.008     #> funcY2:p4_ID:treat0  0.000     -0.013      0.100     -0.004      0.028     #> funcY3:p4_ID:treat0  0.000     -0.004     -0.004      0.213     -0.018     #> funcY4:p4_ID:treat0  0.000      0.008      0.028     -0.018      0.132     #> funcY1:p4_ID:treat1  0.005      0.000      0.000      0.000      0.000     #> funcY2:p4_ID:treat1  0.009      0.000      0.000      0.000      0.000     #> funcY3:p4_ID:treat1 -0.009      0.000      0.000      0.000      0.000     #> funcY4:p4_ID:treat1  0.051      0.000      0.000      0.000      0.000     #> funcY1:p5_ID:treat0  0.000      0.332     -0.019     -0.004      0.010     #> funcY2:p5_ID:treat0  0.000     -0.018      0.158     -0.005      0.041     #> funcY3:p5_ID:treat0  0.000     -0.004     -0.005      0.251     -0.023     #> funcY4:p5_ID:treat0  0.000      0.010      0.041     -0.023      0.184     #> funcY1:p5_ID:treat1  0.006      0.000      0.000      0.000      0.000     #> funcY2:p5_ID:treat1  0.022      0.000      0.000      0.000      0.000     #> funcY3:p5_ID:treat1 -0.014      0.000      0.000      0.000      0.000     #> funcY4:p5_ID:treat1  0.103      0.000      0.000      0.000      0.000     #> funcY1:p6_ID:treat0  0.000      0.237     -0.009     -0.003      0.006     #> funcY2:p6_ID:treat0  0.000     -0.006      0.019     -0.001      0.008     #> funcY3:p6_ID:treat0  0.000     -0.002     -0.002      0.132     -0.010     #> funcY4:p6_ID:treat0  0.000      0.004      0.009     -0.008      0.050     #> funcY1:p6_ID:treat1  0.005      0.000      0.000      0.000      0.000     #> funcY2:p6_ID:treat1  0.007      0.000      0.000      0.000      0.000     #> funcY3:p6_ID:treat1 -0.009      0.000      0.000      0.000      0.000     #> funcY4:p6_ID:treat1  0.045      0.000      0.000      0.000      0.000     #> funcY1:AV:treat0     0.000     -0.598      0.034      0.008     -0.018     #> funcY2:AV:treat0     0.000      0.048     -0.429      0.014     -0.111     #> funcY3:AV:treat0     0.000      0.009      0.011     -0.528      0.049     #> funcY4:AV:treat0     0.000     -0.024     -0.104      0.057     -0.460     #> funcY1:AV:treat1    -0.014      0.000      0.000      0.000      0.000     #> funcY2:AV:treat1    -0.087      0.000      0.000      0.000      0.000     #> funcY3:AV:treat1     0.039      0.000      0.000      0.000      0.000     #> funcY4:AV:treat1    -0.362      0.000      0.000      0.000      0.000     #>                     fY1:3_ID:1 fY2:3_ID:1 fY3:3_ID:1 fY4:3_ID:1 fY1:4_ID:0 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0                                                        #> funcY1:p2_ID:treat1                                                        #> funcY2:p2_ID:treat1                                                        #> funcY3:p2_ID:treat1                                                        #> funcY4:p2_ID:treat1                                                        #> funcY1:p3_ID:treat0                                                        #> funcY2:p3_ID:treat0                                                        #> funcY3:p3_ID:treat0                                                        #> funcY4:p3_ID:treat0                                                        #> funcY1:p3_ID:treat1                                                        #> funcY2:p3_ID:treat1 -0.087                                                 #> funcY3:p3_ID:treat1 -0.015     -0.026                                      #> funcY4:p3_ID:treat1  0.042      0.241     -0.109                           #> funcY1:p4_ID:treat0  0.000      0.000      0.000      0.000                #> funcY2:p4_ID:treat0  0.000      0.000      0.000      0.000     -0.087     #> funcY3:p4_ID:treat0  0.000      0.000      0.000      0.000     -0.015     #> funcY4:p4_ID:treat0  0.000      0.000      0.000      0.000      0.042     #> funcY1:p4_ID:treat1  0.307     -0.015     -0.004      0.008      0.000     #> funcY2:p4_ID:treat1 -0.013      0.100     -0.004      0.028      0.000     #> funcY3:p4_ID:treat1 -0.004     -0.004      0.213     -0.018      0.000     #> funcY4:p4_ID:treat1  0.008      0.028     -0.018      0.132      0.000     #> funcY1:p5_ID:treat0  0.000      0.000      0.000      0.000      0.197     #> funcY2:p5_ID:treat0  0.000      0.000      0.000      0.000     -0.003     #> funcY3:p5_ID:treat0  0.000      0.000      0.000      0.000     -0.002     #> funcY4:p5_ID:treat0  0.000      0.000      0.000      0.000      0.003     #> funcY1:p5_ID:treat1  0.332     -0.019     -0.004      0.010      0.000     #> funcY2:p5_ID:treat1 -0.018      0.158     -0.005      0.041      0.000     #> funcY3:p5_ID:treat1 -0.004     -0.005      0.251     -0.023      0.000     #> funcY4:p5_ID:treat1  0.010      0.041     -0.023      0.184      0.000     #> funcY1:p6_ID:treat0  0.000      0.000      0.000      0.000      0.228     #> funcY2:p6_ID:treat0  0.000      0.000      0.000      0.000     -0.004     #> funcY3:p6_ID:treat0  0.000      0.000      0.000      0.000     -0.002     #> funcY4:p6_ID:treat0  0.000      0.000      0.000      0.000      0.003     #> funcY1:p6_ID:treat1  0.237     -0.009     -0.003      0.006      0.000     #> funcY2:p6_ID:treat1 -0.006      0.019     -0.001      0.008      0.000     #> funcY3:p6_ID:treat1 -0.002     -0.002      0.132     -0.010      0.000     #> funcY4:p6_ID:treat1  0.004      0.009     -0.008      0.050      0.000     #> funcY1:AV:treat0     0.000      0.000      0.000      0.000     -0.616     #> funcY2:AV:treat0     0.000      0.000      0.000      0.000      0.049     #> funcY3:AV:treat0     0.000      0.000      0.000      0.000      0.009     #> funcY4:AV:treat0     0.000      0.000      0.000      0.000     -0.025     #> funcY1:AV:treat1    -0.598      0.034      0.008     -0.018      0.000     #> funcY2:AV:treat1     0.048     -0.429      0.014     -0.111      0.000     #> funcY3:AV:treat1     0.009      0.011     -0.528      0.049      0.000     #> funcY4:AV:treat1    -0.024     -0.104      0.057     -0.460      0.000     #>                     fY2:4_ID:0 fY3:4_ID:0 fY4:4_ID:0 fY1:4_ID:1 fY2:4_ID:1 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0                                                        #> funcY1:p2_ID:treat1                                                        #> funcY2:p2_ID:treat1                                                        #> funcY3:p2_ID:treat1                                                        #> funcY4:p2_ID:treat1                                                        #> funcY1:p3_ID:treat0                                                        #> funcY2:p3_ID:treat0                                                        #> funcY3:p3_ID:treat0                                                        #> funcY4:p3_ID:treat0                                                        #> funcY1:p3_ID:treat1                                                        #> funcY2:p3_ID:treat1                                                        #> funcY3:p3_ID:treat1                                                        #> funcY4:p3_ID:treat1                                                        #> funcY1:p4_ID:treat0                                                        #> funcY2:p4_ID:treat0                                                        #> funcY3:p4_ID:treat0 -0.026                                                 #> funcY4:p4_ID:treat0  0.241     -0.108                                      #> funcY1:p4_ID:treat1  0.000      0.000      0.000                           #> funcY2:p4_ID:treat1  0.000      0.000      0.000     -0.087                #> funcY3:p4_ID:treat1  0.000      0.000      0.000     -0.015     -0.026     #> funcY4:p4_ID:treat1  0.000      0.000      0.000      0.042      0.241     #> funcY1:p5_ID:treat0 -0.002     -0.002      0.003      0.000      0.000     #> funcY2:p5_ID:treat0 -0.036     -0.001     -0.004      0.000      0.000     #> funcY3:p5_ID:treat0  0.000      0.088     -0.004      0.000      0.000     #> funcY4:p5_ID:treat0 -0.005     -0.004     -0.001      0.000      0.000     #> funcY1:p5_ID:treat1  0.000      0.000      0.000      0.197     -0.002     #> funcY2:p5_ID:treat1  0.000      0.000      0.000     -0.003     -0.036     #> funcY3:p5_ID:treat1  0.000      0.000      0.000     -0.002      0.000     #> funcY4:p5_ID:treat1  0.000      0.000      0.000      0.003     -0.005     #> funcY1:p6_ID:treat0 -0.006     -0.002      0.005      0.000      0.000     #> funcY2:p6_ID:treat0 -0.013     -0.001      0.000      0.000      0.000     #> funcY3:p6_ID:treat0 -0.001      0.111     -0.007      0.000      0.000     #> funcY4:p6_ID:treat0  0.001     -0.006      0.021      0.000      0.000     #> funcY1:p6_ID:treat1  0.000      0.000      0.000      0.228     -0.006     #> funcY2:p6_ID:treat1  0.000      0.000      0.000     -0.004     -0.013     #> funcY3:p6_ID:treat1  0.000      0.000      0.000     -0.002     -0.001     #> funcY4:p6_ID:treat1  0.000      0.000      0.000      0.003      0.001     #> funcY1:AV:treat0     0.033      0.008     -0.018      0.000      0.000     #> funcY2:AV:treat0    -0.417      0.014     -0.109      0.000      0.000     #> funcY3:AV:treat0     0.011     -0.534      0.049      0.000      0.000     #> funcY4:AV:treat0    -0.101      0.057     -0.453      0.000      0.000     #> funcY1:AV:treat1     0.000      0.000      0.000     -0.616      0.033     #> funcY2:AV:treat1     0.000      0.000      0.000      0.049     -0.417     #> funcY3:AV:treat1     0.000      0.000      0.000      0.009      0.011     #> funcY4:AV:treat1     0.000      0.000      0.000     -0.025     -0.101     #>                     fY3:4_ID:1 fY4:4_ID:1 fY1:5_ID:0 fY2:5_ID:0 fY3:5_ID:0 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0                                                        #> funcY1:p2_ID:treat1                                                        #> funcY2:p2_ID:treat1                                                        #> funcY3:p2_ID:treat1                                                        #> funcY4:p2_ID:treat1                                                        #> funcY1:p3_ID:treat0                                                        #> funcY2:p3_ID:treat0                                                        #> funcY3:p3_ID:treat0                                                        #> funcY4:p3_ID:treat0                                                        #> funcY1:p3_ID:treat1                                                        #> funcY2:p3_ID:treat1                                                        #> funcY3:p3_ID:treat1                                                        #> funcY4:p3_ID:treat1                                                        #> funcY1:p4_ID:treat0                                                        #> funcY2:p4_ID:treat0                                                        #> funcY3:p4_ID:treat0                                                        #> funcY4:p4_ID:treat0                                                        #> funcY1:p4_ID:treat1                                                        #> funcY2:p4_ID:treat1                                                        #> funcY3:p4_ID:treat1                                                        #> funcY4:p4_ID:treat1 -0.108                                                 #> funcY1:p5_ID:treat0  0.000      0.000                                      #> funcY2:p5_ID:treat0  0.000      0.000     -0.088                           #> funcY3:p5_ID:treat0  0.000      0.000     -0.015     -0.026                #> funcY4:p5_ID:treat0  0.000      0.000      0.042      0.241     -0.109     #> funcY1:p5_ID:treat1 -0.002      0.003      0.000      0.000      0.000     #> funcY2:p5_ID:treat1 -0.001     -0.004      0.000      0.000      0.000     #> funcY3:p5_ID:treat1  0.088     -0.004      0.000      0.000      0.000     #> funcY4:p5_ID:treat1 -0.004     -0.001      0.000      0.000      0.000     #> funcY1:p6_ID:treat0  0.000      0.000      0.270     -0.013     -0.003     #> funcY2:p6_ID:treat0  0.000      0.000     -0.010      0.068     -0.003     #> funcY3:p6_ID:treat0  0.000      0.000     -0.003     -0.003      0.170     #> funcY4:p6_ID:treat0  0.000      0.000      0.006      0.020     -0.013     #> funcY1:p6_ID:treat1 -0.002      0.005      0.000      0.000      0.000     #> funcY2:p6_ID:treat1 -0.001      0.000      0.000      0.000      0.000     #> funcY3:p6_ID:treat1  0.111     -0.007      0.000      0.000      0.000     #> funcY4:p6_ID:treat1 -0.006      0.021      0.000      0.000      0.000     #> funcY1:AV:treat0     0.000      0.000     -0.575      0.032      0.007     #> funcY2:AV:treat0     0.000      0.000      0.046     -0.402      0.013     #> funcY3:AV:treat0     0.000      0.000      0.008      0.010     -0.500     #> funcY4:AV:treat0     0.000      0.000     -0.023     -0.097      0.054     #> funcY1:AV:treat1     0.008     -0.018      0.000      0.000      0.000     #> funcY2:AV:treat1     0.014     -0.109      0.000      0.000      0.000     #> funcY3:AV:treat1    -0.534      0.049      0.000      0.000      0.000     #> funcY4:AV:treat1     0.057     -0.453      0.000      0.000      0.000     #>                     fY4:5_ID:0 fY1:5_ID:1 fY2:5_ID:1 fY3:5_ID:1 fY4:5_ID:1 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0                                                        #> funcY1:p2_ID:treat1                                                        #> funcY2:p2_ID:treat1                                                        #> funcY3:p2_ID:treat1                                                        #> funcY4:p2_ID:treat1                                                        #> funcY1:p3_ID:treat0                                                        #> funcY2:p3_ID:treat0                                                        #> funcY3:p3_ID:treat0                                                        #> funcY4:p3_ID:treat0                                                        #> funcY1:p3_ID:treat1                                                        #> funcY2:p3_ID:treat1                                                        #> funcY3:p3_ID:treat1                                                        #> funcY4:p3_ID:treat1                                                        #> funcY1:p4_ID:treat0                                                        #> funcY2:p4_ID:treat0                                                        #> funcY3:p4_ID:treat0                                                        #> funcY4:p4_ID:treat0                                                        #> funcY1:p4_ID:treat1                                                        #> funcY2:p4_ID:treat1                                                        #> funcY3:p4_ID:treat1                                                        #> funcY4:p4_ID:treat1                                                        #> funcY1:p5_ID:treat0                                                        #> funcY2:p5_ID:treat0                                                        #> funcY3:p5_ID:treat0                                                        #> funcY4:p5_ID:treat0                                                        #> funcY1:p5_ID:treat1  0.000                                                 #> funcY2:p5_ID:treat1  0.000     -0.088                                      #> funcY3:p5_ID:treat1  0.000     -0.015     -0.026                           #> funcY4:p5_ID:treat1  0.000      0.042      0.241     -0.109                #> funcY1:p6_ID:treat0  0.007      0.000      0.000      0.000      0.000     #> funcY2:p6_ID:treat0  0.019      0.000      0.000      0.000      0.000     #> funcY3:p6_ID:treat0 -0.015      0.000      0.000      0.000      0.000     #> funcY4:p6_ID:treat0  0.095      0.000      0.000      0.000      0.000     #> funcY1:p6_ID:treat1  0.000      0.270     -0.013     -0.003      0.007     #> funcY2:p6_ID:treat1  0.000     -0.010      0.068     -0.003      0.019     #> funcY3:p6_ID:treat1  0.000     -0.003     -0.003      0.170     -0.015     #> funcY4:p6_ID:treat1  0.000      0.006      0.020     -0.013      0.095     #> funcY1:AV:treat0    -0.017      0.000      0.000      0.000      0.000     #> funcY2:AV:treat0    -0.104      0.000      0.000      0.000      0.000     #> funcY3:AV:treat0     0.046      0.000      0.000      0.000      0.000     #> funcY4:AV:treat0    -0.431      0.000      0.000      0.000      0.000     #> funcY1:AV:treat1     0.000     -0.575      0.032      0.007     -0.017     #> funcY2:AV:treat1     0.000      0.046     -0.402      0.013     -0.104     #> funcY3:AV:treat1     0.000      0.008      0.010     -0.500      0.046     #> funcY4:AV:treat1     0.000     -0.023     -0.097      0.054     -0.431     #>                     fY1:6_ID:0 fY2:6_ID:0 fY3:6_ID:0 fY4:6_ID:0 fY1:6_ID:1 #> funcY2:p1_ID:treat0                                                        #> funcY3:p1_ID:treat0                                                        #> funcY4:p1_ID:treat0                                                        #> funcY1:p1_ID:treat1                                                        #> funcY2:p1_ID:treat1                                                        #> funcY3:p1_ID:treat1                                                        #> funcY4:p1_ID:treat1                                                        #> funcY1:p2_ID:treat0                                                        #> funcY2:p2_ID:treat0                                                        #> funcY3:p2_ID:treat0                                                        #> funcY4:p2_ID:treat0                                                        #> funcY1:p2_ID:treat1                                                        #> funcY2:p2_ID:treat1                                                        #> funcY3:p2_ID:treat1                                                        #> funcY4:p2_ID:treat1                                                        #> funcY1:p3_ID:treat0                                                        #> funcY2:p3_ID:treat0                                                        #> funcY3:p3_ID:treat0                                                        #> funcY4:p3_ID:treat0                                                        #> funcY1:p3_ID:treat1                                                        #> funcY2:p3_ID:treat1                                                        #> funcY3:p3_ID:treat1                                                        #> funcY4:p3_ID:treat1                                                        #> funcY1:p4_ID:treat0                                                        #> funcY2:p4_ID:treat0                                                        #> funcY3:p4_ID:treat0                                                        #> funcY4:p4_ID:treat0                                                        #> funcY1:p4_ID:treat1                                                        #> funcY2:p4_ID:treat1                                                        #> funcY3:p4_ID:treat1                                                        #> funcY4:p4_ID:treat1                                                        #> funcY1:p5_ID:treat0                                                        #> funcY2:p5_ID:treat0                                                        #> funcY3:p5_ID:treat0                                                        #> funcY4:p5_ID:treat0                                                        #> funcY1:p5_ID:treat1                                                        #> funcY2:p5_ID:treat1                                                        #> funcY3:p5_ID:treat1                                                        #> funcY4:p5_ID:treat1                                                        #> funcY1:p6_ID:treat0                                                        #> funcY2:p6_ID:treat0 -0.087                                                 #> funcY3:p6_ID:treat0 -0.015     -0.026                                      #> funcY4:p6_ID:treat0  0.042      0.241     -0.108                           #> funcY1:p6_ID:treat1  0.000      0.000      0.000      0.000                #> funcY2:p6_ID:treat1  0.000      0.000      0.000      0.000     -0.087     #> funcY3:p6_ID:treat1  0.000      0.000      0.000      0.000     -0.015     #> funcY4:p6_ID:treat1  0.000      0.000      0.000      0.000      0.042     #> funcY1:AV:treat0    -0.552      0.026      0.006     -0.014      0.000     #> funcY2:AV:treat0     0.044     -0.320      0.011     -0.086      0.000     #> funcY3:AV:treat0     0.008      0.008     -0.449      0.038      0.000     #> funcY4:AV:treat0    -0.022     -0.077      0.048     -0.358      0.000     #> funcY1:AV:treat1     0.000      0.000      0.000      0.000     -0.552     #> funcY2:AV:treat1     0.000      0.000      0.000      0.000      0.044     #> funcY3:AV:treat1     0.000      0.000      0.000      0.000      0.008     #> funcY4:AV:treat1     0.000      0.000      0.000      0.000     -0.022     #>                     fY2:6_ID:1 fY3:6_ID:1 fY4:6_ID:1 fY1:AV:0 fY2:AV:0 fY3:AV:0 #> funcY2:p1_ID:treat0                                                             #> funcY3:p1_ID:treat0                                                             #> funcY4:p1_ID:treat0                                                             #> funcY1:p1_ID:treat1                                                             #> funcY2:p1_ID:treat1                                                             #> funcY3:p1_ID:treat1                                                             #> funcY4:p1_ID:treat1                                                             #> funcY1:p2_ID:treat0                                                             #> funcY2:p2_ID:treat0                                                             #> funcY3:p2_ID:treat0                                                             #> funcY4:p2_ID:treat0                                                             #> funcY1:p2_ID:treat1                                                             #> funcY2:p2_ID:treat1                                                             #> funcY3:p2_ID:treat1                                                             #> funcY4:p2_ID:treat1                                                             #> funcY1:p3_ID:treat0                                                             #> funcY2:p3_ID:treat0                                                             #> funcY3:p3_ID:treat0                                                             #> funcY4:p3_ID:treat0                                                             #> funcY1:p3_ID:treat1                                                             #> funcY2:p3_ID:treat1                                                             #> funcY3:p3_ID:treat1                                                             #> funcY4:p3_ID:treat1                                                             #> funcY1:p4_ID:treat0                                                             #> funcY2:p4_ID:treat0                                                             #> funcY3:p4_ID:treat0                                                             #> funcY4:p4_ID:treat0                                                             #> funcY1:p4_ID:treat1                                                             #> funcY2:p4_ID:treat1                                                             #> funcY3:p4_ID:treat1                                                             #> funcY4:p4_ID:treat1                                                             #> funcY1:p5_ID:treat0                                                             #> funcY2:p5_ID:treat0                                                             #> funcY3:p5_ID:treat0                                                             #> funcY4:p5_ID:treat0                                                             #> funcY1:p5_ID:treat1                                                             #> funcY2:p5_ID:treat1                                                             #> funcY3:p5_ID:treat1                                                             #> funcY4:p5_ID:treat1                                                             #> funcY1:p6_ID:treat0                                                             #> funcY2:p6_ID:treat0                                                             #> funcY3:p6_ID:treat0                                                             #> funcY4:p6_ID:treat0                                                             #> funcY1:p6_ID:treat1                                                             #> funcY2:p6_ID:treat1                                                             #> funcY3:p6_ID:treat1 -0.026                                                      #> funcY4:p6_ID:treat1  0.241     -0.108                                           #> funcY1:AV:treat0     0.000      0.000      0.000                                #> funcY2:AV:treat0     0.000      0.000      0.000     -0.080                     #> funcY3:AV:treat0     0.000      0.000      0.000     -0.014   -0.026            #> funcY4:AV:treat0     0.000      0.000      0.000      0.040    0.242   -0.107   #> funcY1:AV:treat1     0.026      0.006     -0.014      0.000    0.000    0.000   #> funcY2:AV:treat1    -0.320      0.011     -0.086      0.000    0.000    0.000   #> funcY3:AV:treat1     0.008     -0.449      0.038      0.000    0.000    0.000   #> funcY4:AV:treat1    -0.077      0.048     -0.358      0.000    0.000    0.000   #>                     fY4:AV:0 fY1:AV:1 fY2:AV:1 fY3:AV:1 #> funcY2:p1_ID:treat0                                     #> funcY3:p1_ID:treat0                                     #> funcY4:p1_ID:treat0                                     #> funcY1:p1_ID:treat1                                     #> funcY2:p1_ID:treat1                                     #> funcY3:p1_ID:treat1                                     #> funcY4:p1_ID:treat1                                     #> funcY1:p2_ID:treat0                                     #> funcY2:p2_ID:treat0                                     #> funcY3:p2_ID:treat0                                     #> funcY4:p2_ID:treat0                                     #> funcY1:p2_ID:treat1                                     #> funcY2:p2_ID:treat1                                     #> funcY3:p2_ID:treat1                                     #> funcY4:p2_ID:treat1                                     #> funcY1:p3_ID:treat0                                     #> funcY2:p3_ID:treat0                                     #> funcY3:p3_ID:treat0                                     #> funcY4:p3_ID:treat0                                     #> funcY1:p3_ID:treat1                                     #> funcY2:p3_ID:treat1                                     #> funcY3:p3_ID:treat1                                     #> funcY4:p3_ID:treat1                                     #> funcY1:p4_ID:treat0                                     #> funcY2:p4_ID:treat0                                     #> funcY3:p4_ID:treat0                                     #> funcY4:p4_ID:treat0                                     #> funcY1:p4_ID:treat1                                     #> funcY2:p4_ID:treat1                                     #> funcY3:p4_ID:treat1                                     #> funcY4:p4_ID:treat1                                     #> funcY1:p5_ID:treat0                                     #> funcY2:p5_ID:treat0                                     #> funcY3:p5_ID:treat0                                     #> funcY4:p5_ID:treat0                                     #> funcY1:p5_ID:treat1                                     #> funcY2:p5_ID:treat1                                     #> funcY3:p5_ID:treat1                                     #> funcY4:p5_ID:treat1                                     #> funcY1:p6_ID:treat0                                     #> funcY2:p6_ID:treat0                                     #> funcY3:p6_ID:treat0                                     #> funcY4:p6_ID:treat0                                     #> funcY1:p6_ID:treat1                                     #> funcY2:p6_ID:treat1                                     #> funcY3:p6_ID:treat1                                     #> funcY4:p6_ID:treat1                                     #> funcY1:AV:treat0                                        #> funcY2:AV:treat0                                        #> funcY3:AV:treat0                                        #> funcY4:AV:treat0                                        #> funcY1:AV:treat1     0.000                              #> funcY2:AV:treat1     0.000   -0.080                     #> funcY3:AV:treat1     0.000   -0.014   -0.026            #> funcY4:AV:treat1     0.000    0.040    0.242   -0.107   #>  #> Standardized residuals: #>         Min          Q1         Med          Q3         Max  #> -2.94493716 -0.65287965 -0.01437135  0.67321174  3.86323102  #>  #> Residual standard error: 2.1071  #> Degrees of freedom: 1536 total; 1480 residual   # We can now use any S3 method compatible with a gls object, for example, predict()  predict(MVmodel_theta, newdata = simMV[which(simMV$plot == 1), ]) #>   plot     Yvalue func #> 1    1  6.0743137   Y1 #> 2    1  6.2815368   Y2 #> 3    1 -0.8874687   Y3 #> 4    1  4.8245259   Y4 # }  ################################################################################################## # ################################################################################################## ## Code to simulate data # # # \\donttest{ set.seed(412)  props <- data.frame(plot = integer(),                     p1 = integer(),                     p2 = integer(),                     p3 = integer(),                     p4 = integer(),                     p5 = integer(),                     p6 = integer())  index <- 1 #row number  #Monocultures for(i in 1:6) #6 species {   for(j in 1:2) #2 technical reps   {     props[index, i+1] <- 1     index <- index + 1   } }   #Equal Mixtures for(rich in sort(rep(2:6, 3))) #3 reps at each richness level {   sp <- sample(1:6, rich) #randomly pick species from pool    for(j in 1:2) #2 technical reps   {     for(i in sp)     {       props[index, i+1] <- 1/rich #equal proportions     }     index <- index + 1   } }   #Unequal Mixtures for(rich in sort(rep(c(2, 3, 4, 5, 6), 15))) #15 reps at each richness level {   sp <- sample(1:6, rich, replace = TRUE) #randomly pick species from pool    for(j in 1:2) #2 technical reps   {     for(i in 1:6)     {       props[index, i+1] <- sum(sp==i)/rich #equal proportions     }     index <- index + 1   } }   props[is.na(props)] <- 0  mySimData <- props  mySimData$treat <- 0 mySimDataDupe <- mySimData mySimDataDupe$treat <- 1 mySimData <- rbind(mySimData, mySimDataDupe)  mySimData$plot <- 1:nrow(mySimData)  mySimData$Y1 <- NA mySimData$Y2 <- NA mySimData$Y3 <- NA mySimData$Y4 <- NA  ADDs <- DImodels::DI_data(prop=2:7, what=c(\"ADD\"), data=mySimData) mySimData <- cbind(mySimData, ADDs)  E_AV <- DImodels::DI_data(prop=2:7, what=c(\"E\", \"AV\"), data=mySimData) mySimData <- cbind(mySimData, E_AV)  n <- 4 #Number of Ys p <- qr.Q(qr(matrix(stats::rnorm(n^2), n))) #Principal Components (make sure it's positive definite) S <- crossprod(p, p*(n:1)) #Sigma m <- stats::runif(n, -0.25, 1.5)  #runif(8, -1, 7) #decide on betas randomly  for(i in 1:nrow(mySimData)) {   #Within subject error   error <- MASS::mvrnorm(n=1, mu=m, Sigma=S)   mySimData$Y1[i] <- 6.9*mySimData$p1[i] + -0.3*mySimData$p2[i] + 6.6*mySimData$p3[i] +   1.7*mySimData$p4[i] + -0.8*mySimData$p5[i] + 4.3*mySimData$p6[i] + 3.5*mySimData$treat[i] +   1.8*mySimData$AV[i] + error[1]   mySimData$Y2[i] <- 4.9*mySimData$p1[i] + 3.6*mySimData$p2[i] + 4.4*mySimData$p3[i] +   2.3*mySimData$p4[i] + 4.3*mySimData$p5[i] + 6.6*mySimData$p6[i] + -0.3*mySimData$treat[i] +   6.8*mySimData$AV[i] + error[2]   mySimData$Y3[i] <- -0.3*mySimData$p1[i] + 4.6*mySimData$p2[i] + 1.2*mySimData$p3[i] +   6.8*mySimData$p4[i] + 1.4*mySimData$p5[i] + 6.9*mySimData$p6[i] + 5.5*mySimData$treat[i] +   1.4*mySimData$AV[i] + error[3]   mySimData$Y4[i] <- 4.1*mySimData$p1[i] + 4.2*mySimData$p2[i] + -0.5*mySimData$p3[i] +   4.9*mySimData$p4[i] + 6.7*mySimData$p5[i] + -0.9*mySimData$p6[i] + -1.0*mySimData$treat[i] +   0.3*mySimData$AV[i] + error[4] }  mySimData$treat <- as.factor(mySimData$treat) # }"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMVRM.html","id":null,"dir":"Reference","previous_headings":"","what":"The simulated multivariate repeated measures ","title":"The simulated multivariate repeated measures ","text":"simMVRM dataset simulated multivariate repeated measures DI model. contains 336 plots comprising four species vary proportions (p1 - p4). three simulated responses (Y1, Y2, Y3), taken two differing time points, recorded wide data format (one column per response type). data simulated assuming existing covariances responses time pointsand species identity species interaction effects present.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMVRM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The simulated multivariate repeated measures ","text":"","code":"data(\"simMVRM\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMVRM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The simulated multivariate repeated measures ","text":"data frame 672 observations following 9 variables. plot factor vector indicating ID experimental unit p1 numeric vector indicating initial proportion species 1 p2 numeric vector indicating initial proportion species 2 p3 numeric vector indicating initial proportion species 3 p4 numeric vector indicating initial proportion species 4 Y1 numeric vector indicating response ecosystem function 1 Y2 numeric vector indicating response ecosystem function 2 Y3 numeric vector indicating response ecosystem function 3 time factor levels 1 2","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMVRM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The simulated multivariate repeated measures ","text":"Diversity-Interactions (DI) models? Diversity-Interactions (DI) models (Kirwan et al., 2009) set tools analysing interpreting data experiments explore effects species diversity community-level responses. strongly recommend users read short introduction Diversity-Interactions models (available : DImodels). information Diversity-Interactions models also available Kirwan et al., 2009 Connolly et al., 2013. Parameter values simulation Multivariate repeated measures DI models take general form : $${y}_{kmt} = {Identities}_{kmt} + {Interactions}_{kmt} + {Structures}_{kt} + {\\epsilon}_{kmt}$$ \\(y\\) community-level responses, \\(Identities\\) effects species identities response enter model individual species proportions measured beginning time period, \\(Interactions\\) interactions among species proportions, \\(Structures\\) include experimental structures blocks, treatments, density. dataset simRM simulated : identity effects four species time ecosystem function: Y1time1 = -1.0, 5.0, 2.8, -0.9 Y1time2 = 0.5, 5.4, 4.9, -2.1 Y2time1 = 0.1, 4.1, -0.5, 0.3 Y2time2 = 2.3, 3.2, -3.1, 2.1 Y3time1 = 0.9, 6.6, 3.5, 6.1 Y3time2 = -0.1, 7.0, 2.8, 4.0 evenness interaction effect time ecosystem function: Y1time1 = -0.1 Y1time2 = 12.0 Y2time1 = 2.3 Y2time2 = 1.6 Y3time1 = 2.1 Y3time2 = 6.8 \\(\\epsilon\\) assumed multivaraite normal distribution mean 0. ecosystem   function matrix Sigma: time matrix Sigma:","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMVRM.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The simulated multivariate repeated measures ","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simMVRM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The simulated multivariate repeated measures ","text":"","code":"################################################################################################### ################################################################################################### #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE> ## Modelling Example  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # vignette(\"DImulti_workflow\")  head(simMVRM) #>   plot p1 p2 p3 p4         Y1          Y2        Y3 time #> 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1 #> 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1 #> 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1 #> 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1 #> 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1 #> 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1  # We call DImulti() to fit a series of models, with increasing complexity, and test whether the # additional terms are worth keeping.  # We begin with an ID DI model, ensuring to use method = \"ML\" as we will be comparing fixed effects  MVRMmodel <- DImulti(y = 6:8, eco_func = c(\"Na\", \"un\"), time = c(\"time\", \"CS\"), unit_IDs = 1,                    prop = 2:5, data = simMVRM, DImodel = \"ID\",                    method = \"ML\") print(MVRMmodel) #> Note:  #> Method Used = ML  #> Correlation Structure Used = un@CS #>  Identity Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID))  #>       AIC       BIC    logLik  #>  9670.780  9811.002 -4810.390  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      #> 2  0.606        #> 3 -0.246 -0.168 #>  #>  Repeated Measure Correlation Structure: Compound symmetry #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>       Rho  #> 0.2275234  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                      Beta      Std. Error   t-value   p-value      Signif  #> -------------------  --------  -----------  --------  -----------  ------- #> funcY1:time1:p1_ID   -0.709    0.485        -1.462    0.144                #> funcY2:time1:p1_ID   +2.271    0.485        4.681     3.045e-06    ***     #> funcY3:time1:p1_ID   +2.440    0.485        5.030     5.343e-07    ***     #> funcY1:time2:p1_ID   +8.372    0.485        17.260    2.537e-62    ***     #> funcY2:time2:p1_ID   +3.795    0.485        7.825     8.197e-15    ***     #> funcY3:time2:p1_ID   +4.023    0.485        8.294     1.992e-16    ***     #> funcY1:time1:p2_ID   +5.375    0.464        11.577    4.797e-30    ***     #> funcY2:time1:p2_ID   +5.934    0.464        12.781    5.209e-36    ***     #> funcY3:time1:p2_ID   +7.998    0.464        17.226    4.229e-62    ***     #> funcY1:time2:p2_ID   +12.106   0.464        26.075    3.365e-129   ***     #> funcY2:time2:p2_ID   +3.717    0.464        8.007     1.981e-15    ***     #> funcY3:time2:p2_ID   +10.769   0.464        23.196    1.459e-105   ***     #> funcY1:time1:p3_ID   +3.383    0.482        7.025     2.935e-12    ***     #> funcY2:time1:p3_ID   +1.205    0.482        2.503     0.0124       *       #> funcY3:time1:p3_ID   +4.856    0.482        10.083    2.367e-23    ***     #> funcY1:time2:p3_ID   +12.855   0.482        26.691    1.959e-134   ***     #> funcY2:time2:p3_ID   -2.152    0.482        -4.468    8.356e-06    ***     #> funcY3:time2:p3_ID   +7.712    0.482        16.012    2.241e-54    ***     #> funcY1:time1:p4_ID   -0.104    0.545        -0.191    0.8488               #> funcY2:time1:p4_ID   +2.510    0.545        4.604     4.399e-06    ***     #> funcY3:time1:p4_ID   +6.626    0.545        12.156    7.556e-33    ***     #> funcY1:time2:p4_ID   +6.875    0.545        12.612    3.845e-35    ***     #> funcY2:time2:p4_ID   +3.348    0.545        6.141     9.874e-10    ***     #> funcY3:time2:p4_ID   +8.758    0.545        16.067    1.031e-54    ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 2016 total; 1992 residual #> Residual standard error: 2.906918  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]     [,2]     [,3] #> [1,]  4.9364  2.60580 -1.14680 #> [2,]  2.6058  3.75180 -0.68183 #> [3,] -1.1468 -0.68183  4.39700 #>   Standard Deviations: 2.2218 1.937 2.0969  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>         [,1]    [,2] #> [1,] 11.3980  2.5933 #> [2,]  2.5933 11.3980 #>   Standard Deviations: 3.3761 3.3761  #>  #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  8.45020  1.92260  5.11670  1.16420 -2.08000 -0.47325 #> Y1:2  1.92260  8.45020  1.16420  5.11670 -0.47325 -2.08000 #> Y2:1  5.11670  1.16420  8.45020  1.92260 -1.41850 -0.32275 #> Y2:2  1.16420  5.11670  1.92260  8.45020 -0.32275 -1.41850 #> Y3:1 -2.08000 -0.47325 -1.41850 -0.32275  8.45020  1.92260 #> Y3:2 -0.47325 -2.08000 -0.32275 -1.41850  1.92260  8.45020 #>   Standard Deviations: 2.9069 2.9069 2.9069 2.9069 2.9069 2.9069  #>   # Next, we include the simplest interaction structure available in this package, \"AV\", which adds # a single extra term per ecosystem function and time point  MVRMmodel_AV <- DImulti(y = 6:8, eco_func = c(\"Na\", \"un\"), time = c(\"time\", \"CS\"), unit_IDs = 1,                    prop = 2:5, data = simMVRM, DImodel = \"AV\",                    method = \"ML\")  anova(MVRMmodel, MVRMmodel_AV) #>              Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> MVRMmodel        1 25 9670.780 9811.002 -4810.390                         #> MVRMmodel_AV     2 31 7921.064 8094.939 -3929.532 1 vs 2 1761.716  <.0001  # We select the more model with the lower AIC/BIC value or we use the p-value of the likelihood # ratio test to determine if we reject the null hypothesis that the extra terms in the model are # equal to zero, which in this case is lower than our alpha value of 0.05, so we do reject this # hypothesis and continue with our more complex model. # # We can continue increasing the complexity of the interaction structure in the same fashion, this # time we elect to use the additive interaction structure  MVRMmodel_ADD <- DImulti(y = 6:8, eco_func = c(\"Na\", \"un\"), time = c(\"time\", \"CS\"), unit_IDs = 1,                    prop = 2:5, data = simMVRM, DImodel = \"ADD\",                    method = \"ML\")  anova(MVRMmodel_AV, MVRMmodel_ADD) #>               Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> MVRMmodel_AV      1 31 7921.064 8094.939 -3929.532                         #> MVRMmodel_ADD     2 49 7948.032 8222.867 -3925.016 1 vs 2 9.031852   0.959  # We fail to reject the null hypothesis and so we select the average interaction structure. # # Finally, we can also increase the model complexity via the inclusion of the non-linear parameter # theta, which we can estimate, or select a value for. We also choose to estimate using the \"REML\" # method as we will do no further fixed effect model comparisons  # \\donttest{ MVRMmodel_theta <- DImulti(y = 6:8, eco_func = c(\"Na\", \"un\"), time = c(\"time\", \"CS\"), unit_IDs = 1,                    prop = 2:5, data = simMVRM, DImodel = \"AV\",                    estimate_theta = TRUE, method = \"REML\")  print(MVRMmodel_theta) #> Note:  #> Method Used = REML  #> Correlation Structure Used = un@CS #>  Average Term Model #> Theta estimate(s) = Y1:0.9704, Y2:0.7538, Y3:1.0089 #>  #> Generalized least squares fit by REML #>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + AV))  #>       AIC       BIC    logLik  #>  7933.636  8107.046 -3935.818  #>  #>  Multivariate Correlation Structure: General #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>  Correlation:  #>   1      2      #> 2  0.609        #> 3 -0.310 -0.363 #>  #>  Repeated Measure Correlation Structure: Compound symmetry #>  Formula: ~0 | plot  #>  Parameter estimate(s): #>       Rho  #> 0.3126024  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                      Beta      Std. Error   t-value   p-value      Signif  #> -------------------  --------  -----------  --------  -----------  ------- #> funcY1:time1:p1_ID   -1.364    0.397        -3.431    0.0006143    ***     #> funcY2:time1:p1_ID   +0.594    0.384        1.549     0.1216               #> funcY3:time1:p1_ID   +0.915    0.401        2.283     0.02253      *       #> funcY1:time2:p1_ID   +0.202    0.397        0.509     0.6111               #> funcY2:time2:p1_ID   +2.666    0.384        6.947     5.054e-12    ***     #> funcY3:time2:p1_ID   -0.542    0.401        -1.352    0.1767               #> funcY1:time1:p2_ID   +4.810    0.368        13.062    1.822e-37    ***     #> funcY2:time1:p2_ID   +4.523    0.355        12.737    8.871e-36    ***     #> funcY3:time1:p2_ID   +6.675    0.371        17.977    4.537e-67    ***     #> funcY1:time2:p2_ID   +5.052    0.368        13.720    5.335e-41    ***     #> funcY2:time2:p2_ID   +2.767    0.355        7.792     1.056e-14    ***     #> funcY3:time2:p2_ID   +6.811    0.371        18.343    1.514e-69    ***     #> funcY1:time1:p3_ID   +2.711    0.399        6.790     1.48e-11     ***     #> funcY2:time1:p3_ID   -0.498    0.384        -1.298    0.1945               #> funcY3:time1:p3_ID   +3.288    0.403        8.160     5.882e-16    ***     #> funcY1:time2:p3_ID   +4.467    0.399        11.187    3.234e-28    ***     #> funcY2:time2:p3_ID   -3.299    0.384        -8.597    1.633e-17    ***     #> funcY3:time2:p3_ID   +3.017    0.403        7.489     1.04e-13     ***     #> funcY1:time1:p4_ID   -0.853    0.449        -1.897    0.05792      +       #> funcY2:time1:p4_ID   +0.543    0.437        1.242     0.2143               #> funcY3:time1:p4_ID   +4.890    0.452        10.811    1.649e-26    ***     #> funcY1:time2:p4_ID   -2.469    0.449        -5.493    4.453e-08    ***     #> funcY2:time2:p4_ID   +2.023    0.437        4.628     3.926e-06    ***     #> funcY3:time2:p4_ID   +3.562    0.452        7.875     5.58e-15     ***     #> funcY1:time1:AV      +2.560    0.905        2.828     0.004729     **      #> funcY2:time1:AV      +4.283    0.529        8.091     1.021e-15    ***     #> funcY3:time1:AV      +6.424    0.998        6.436     1.531e-10    ***     #> funcY1:time2:AV      +31.946   0.905        35.291    3.302e-212   ***     #> funcY2:time2:AV      +2.885    0.529        5.450     5.669e-08    ***     #> funcY3:time2:AV      +19.229   0.998        19.264    5.916e-76    ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 2016 total; 1986 residual #> Residual standard error: 1.948135  #>  #> $Multivariate #> Marginal variance covariance matrix #>         [,1]    [,2]    [,3] #> [1,]  4.9095  2.3475 -1.3752 #> [2,]  2.3475  3.0305 -1.2650 #> [3,] -1.3752 -1.2650  4.0087 #>   Standard Deviations: 2.2157 1.7408 2.0022  #>  #> $`Repeated Measure` #> Marginal variance covariance matrix #>        [,1]   [,2] #> [1,] 4.6330 1.4483 #> [2,] 1.4483 4.6330 #>   Standard Deviations: 2.1524 2.1524  #>  #> $Combined #> Marginal variance covariance matrix #>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2 #> Y1:1  3.79520  1.18640  2.30980  0.72204 -1.17640 -0.36776 #> Y1:2  1.18640  3.79520  0.72204  2.30980 -0.36776 -1.17640 #> Y2:1  2.30980  0.72204  3.79520  1.18640 -1.37740 -0.43059 #> Y2:2  0.72204  2.30980  1.18640  3.79520 -0.43059 -1.37740 #> Y3:1 -1.17640 -0.36776 -1.37740 -0.43059  3.79520  1.18640 #> Y3:2 -0.36776 -1.17640 -0.43059 -1.37740  1.18640  3.79520 #>   Standard Deviations: 1.9481 1.9481 1.9481 1.9481 1.9481 1.9481  #>    #Finally, we can utilise this model for our interpretation and predictions  head(predict(MVRMmodel_theta)) #>   plot     Yvalue Ytype #> 1    1 -1.3637130  Y1:1 #> 2    1  0.2021854  Y1:2 #> 3    1  0.5944749  Y2:1 #> 4    1  2.6663312  Y2:2 #> 5    1  0.9148420  Y3:1 #> 6    1 -0.5415428  Y3:2 # }  ################################################################################################## # ##################################################################################################  ## Code to simulate data # \\donttest{ set.seed(746)  props <- data.frame(plot = integer(),                     p1 = integer(),                     p2 = integer(),                     p3 = integer(),                     p4 = integer())  index <- 1 #row number  #Monocultures for(i in 1:4) #6 species {   for(j in 1:3) #2 technical reps   {     props[index, i+1] <- 1     index <- index + 1   } }   #Equal Mixtures for(rich in sort(rep(2:4, 4))) #3 reps at each richness level {   sp <- sample(1:4, rich) #randomly pick species from pool    for(j in 1:2) #2 technical reps   {     for(i in sp)     {       props[index, i+1] <- 1/rich #equal proportions     }     index <- index + 1   } }   #Unequal Mixtures for(rich in sort(rep(c(2, 3, 4), 50))) #15 reps at each richness level {   sp <- sample(1:4, rich, replace = TRUE) #randomly pick species from pool    for(j in 1:2) #2 technical reps   {     for(i in 1:4)     {       props[index, i+1] <- sum(sp==i)/rich #equal proportions     }     index <- index + 1   } }   props[is.na(props)] <- 0  mySimData <- props  ADDs <- DImodels::DI_data(prop=2:5, what=c(\"ADD\"), data=mySimData) mySimData <- cbind(mySimData, ADDs)  E_AV <- DImodels::DI_data(prop=2:5, what=c(\"E\", \"AV\"), data=mySimData) mySimData <- cbind(mySimData, E_AV)  mySimData$plot <- 1:nrow(mySimData)  mySimData$Y1 <- NA mySimData$Y2 <- NA mySimData$Y3 <- NA  mySimData$time <- 1 mySimDataT1 <- mySimData mySimDataT2 <- mySimData mySimDataT2$time <- 2   nT <- 2 #Number of s #Principal Components (make sure it's positive definite) pT <- qr.Q(qr(matrix(stats::rnorm(nT^2), nT))) ST <- crossprod(pT, pT*(nT:1)) #Sigma mT <- stats::runif(nT, -0.25, 1.5)  nY <- 3 #Number of Ys #Principal Components (make sure it's positive definite) pY <- qr.Q(qr(matrix(stats::rnorm(nY^2), nY))) SY <- crossprod(pY, pY*(nY:1)) #Sigma mY <- stats::runif(nY, -0.25, 1.5)   #runif(7, -1, 7) #decide on betas randomly for(i in 1:nrow(mySimData)) {   #Within subject error   errorT <- MASS::mvrnorm(n=1, mu=mT, Sigma=ST)   errorY <- MASS::mvrnorm(n=1, mu=mY, Sigma=SY)   mySimDataT1$Y1[i] <- -1.0*mySimDataT1$p1[i] + 5.0*mySimDataT1$p2[i] + 2.8*mySimDataT1$p3[i] +   -0.9*mySimDataT1$p4[i] + -0.1*mySimDataT1$E[i] + errorT[1]*errorY[1]   mySimDataT2$Y1[i] <- 0.5*mySimDataT2$p1[i] + 5.4*mySimDataT2$p2[i] + 4.9*mySimDataT2$p3[i] +   -2.1*mySimDataT2$p4[i] + 12.0*mySimDataT1$E[i] + errorT[2]*errorY[1]    mySimDataT1$Y2[i] <- 0.1*mySimDataT1$p1[i] + 4.1*mySimDataT1$p2[i] + -0.5*mySimDataT1$p3[i] +   0.3*mySimDataT1$p4[i] + 2.3*mySimDataT1$E[i] + errorT[1]*errorY[2]   mySimDataT2$Y2[i] <- 2.3*mySimDataT2$p1[i] + 3.2*mySimDataT2$p2[i] + -3.1*mySimDataT2$p3[i] +   2.1*mySimDataT2$p4[i] + 1.6*mySimDataT2$E[i] + errorT[2]*errorY[2]    mySimDataT1$Y3[i] <- 0.9*mySimDataT1$p1[i] + 6.6*mySimDataT1$p2[i] + 3.5*mySimDataT1$p3[i] +   6.1*mySimDataT1$p4[i] + 2.1*mySimDataT1$E[i] + errorT[1]*errorY[3]   mySimDataT2$Y3[i] <- -0.1*mySimDataT2$p1[i] + 7.0*mySimDataT2$p2[i] + 2.8*mySimDataT2$p3[i] +   4.0*mySimDataT2$p4[i] + 6.8*mySimDataT2$E[i] + errorT[2]*errorY[3] }  mySimData <- rbind(mySimDataT1, mySimDataT2)  mySimData$time <- as.factor(mySimData$time) mySimData$plot <- as.factor(mySimData$plot) # }"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simRM.html","id":null,"dir":"Reference","previous_headings":"","what":"The simulated repeated measures ","title":"The simulated repeated measures ","text":"simRM dataset simulated repeated measures DI model. contains 116 plots comprising four species vary proportions (p1 - p4). one simulated response (Y), taken three differing time points, recorded stacked data format (one row per response value). data simulated assuming existing covariances responses species identity species interaction effects present.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simRM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The simulated repeated measures ","text":"","code":"data(\"simRM\")"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simRM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"The simulated repeated measures ","text":"data frame 384 observations following seven variables. plot numeric vector identifying unique experimental unit p1 numeric vector indicating initial proportion species 1 p2 numeric vector indicating initial proportion species 2 p3 numeric vector indicating initial proportion species 3 p4 numeric vector indicating initial proportion species 4 Y numeric vector giving simulated response ecosystem function time three-level factor indicating time point response Y recorded","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simRM.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The simulated repeated measures ","text":"Diversity-Interactions (DI) models? Diversity-Interactions (DI) models (Kirwan et al., 2009) set tools analysing interpreting data experiments explore effects species diversity community-level responses. strongly recommend users read short introduction Diversity-Interactions models (available : DImodels). information Diversity-Interactions models also available Kirwan et al., 2009 Connolly et al., 2013. Parameter values simulation Repeated measures DI models take general form : $${y}_{mt} = {Identities}_{mt} + {Interactions}_{mt} + {Structures}_{t} + {\\epsilon}_{mt}$$ \\(y\\) community-level responses, \\(Identities\\) effects species identities response enter model individual species proportions measured beginning time period, \\(Interactions\\) interactions among species proportions, \\(Structures\\) include experimental structures blocks, treatments, density. dataset simRM simulated : identity effects four species time: time1 = 4.1, 2.1, 3.6, 4.8 time2 = 2.3, 2.4, 5.1, 5.0 time3 = 0.7, 2.3, 6.5, 5.9 additive interaction effects time: time1 = 3.3, 4.0, 1.3, 5.2 time2 = 3.6, 4.5, 0.5, 6.5 time3 = 4.5, 5.2, 0.6, 7.8 \\(\\epsilon\\) assumed multivaraite normal distribution mean 0 Sigma:","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simRM.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The simulated repeated measures ","text":"Dooley, ., Isbell, F., Kirwan, L., Connolly, J., Finn, J.. Brophy, C., 2015.  Testing effects diversity ecosystem multifunctionality using multivariate model.  Ecology Letters, 18(11), pp.1242-1251. Finn, J.., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, ., Baadshaug, O.H., Belanger, G., Black, ., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, ., Elgersma, ., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, ., Golinska, B., Golinski, P., Grieu, P., Gustavsson, .M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z., Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., Lüscher, ., 2013.  Ecosystem function enhanced combining four functional types plant species intensively managed grassland mixtures: 3-year continental-scale field experiment. Journal Applied Ecology, 50(2), pp.365-375 . Kirwan, L., Connolly, J., Finn, J.., Brophy, C., Luscher, ., Nyfeler, D. Sebastia, M.T., 2009.  Diversity-interaction modeling: estimating contributions species identities interactions ecosystem function.  Ecology, 90(8), pp.2032-2038.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/simRM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The simulated repeated measures ","text":"","code":"################################################################################################### ################################################################################################### #> <STYLE type='text/css' scoped> #> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em}; #> <\/STYLE> ## Modelling Example  # For a more thorough example of the workflow of this package, please see vignette # DImulti_workflow using the following code:  # vignette(\"DImulti_workflow\")   head(simRM) #>   plot p1 p2 p3 p4        Y time #> 1    1  1  0  0  0 4.763873    1 #> 2    2  1  0  0  0 4.762302    1 #> 3    3  0  1  0  0 2.413846    1 #> 4    4  0  1  0  0 1.929837    1 #> 5    5  0  0  1  0 2.750093    1 #> 6    6  0  0  1  0 5.071534    1  # We call DImulti() to fit a series of models, with increasing complexity, and test whether the # additional terms are worth keeping.  # We begin with an ID DI model, ensuring to use method = \"ML\" as we will be comparing fixed effects  RMmodel <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                    prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"ID\",                    method = \"ML\") print(RMmodel) #> Note:  #> Method Used = ML  #> Correlation Structure Used = AR1 #>  Identity Model #> Theta value(s) = 1 #>  #> Generalized least squares fit by maximum likelihood #>   Model: Y ~ 0 + time:((p1_ID + p2_ID + p3_ID + p4_ID))  #>       AIC       BIC    logLik  #> 1316.8028 1370.7336 -644.4014  #>  #>  Repeated Measure Correlation Structure: AR(1) #>  Formula: ~0 + as.numeric(time) | plot  #>  Parameter estimate(s): #>       Phi  #> 0.2206503  #>  #>  #> Table: Fixed Effect Coefficients #>  #>               Beta      Std. Error   t-value   p-value     Signif  #> ------------  --------  -----------  --------  ----------  ------- #> time1:p1_ID   +6.151    0.482        12.765    1.076e-30   ***     #> time2:p1_ID   +5.320    0.482        11.042    2.154e-24   ***     #> time3:p1_ID   +3.443    0.482        7.145     5.624e-12   ***     #> time1:p2_ID   +4.794    0.504        9.513     3.724e-19   ***     #> time2:p2_ID   +6.381    0.504        12.662    2.614e-30   ***     #> time3:p2_ID   +5.137    0.504        10.192    1.957e-21   ***     #> time1:p3_ID   +4.791    0.431        11.124    1.101e-24   ***     #> time2:p3_ID   +7.442    0.431        17.277    2.612e-48   ***     #> time3:p3_ID   +7.227    0.431        16.779    2.512e-46   ***     #> time1:p4_ID   +7.099    0.459        15.457    4.348e-41   ***     #> time2:p4_ID   +10.485   0.459        22.830    2.578e-70   ***     #> time3:p4_ID   +9.100    0.459        19.814    1.988e-58   ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 348 total; 336 residual #> Residual standard error: 1.567414  #>  #> Marginal variance covariance matrix #>         1       2       3 #> 1 2.45680 0.54209 0.11961 #> 2 0.54209 2.45680 0.54209 #> 3 0.11961 0.54209 2.45680 #>   Standard Deviations: 1.5674 1.5674 1.5674   # We can simplify the above model by grouping the ID effect terms into two categories, G1 and G2  RMmodel_ID <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                    prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"ID\",                    ID = c(\"G1\", \"G1\", \"G2\", \"G2\"),                    method = \"ML\")  # We can compare the two models by calling the anova function to perform a likelihood ratio test  anova(RMmodel, RMmodel_ID) #>            Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> RMmodel        1 14 1316.803 1370.734 -644.4014                         #> RMmodel_ID     2  8 1344.644 1375.462 -664.3221 1 vs 2 39.84144  <.0001  # As the p-value < an alpha value of 0.05, we reject the null hypthesis that the extra terms are # equal to zero, therefore we continue with the larger model. # We can confirm this result by selecting the model with the lower AIC value.  AIC(RMmodel); AIC(RMmodel_ID) #> [1] 1316.803 #> [1] 1344.644  # Next, we include the simplest interaction structure available in this package, \"AV\", which adds # a single extra term per ecosystem function  RMmodel_AV <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                    prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"AV\",                    method = \"ML\")  anova(RMmodel, RMmodel_AV) #>            Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> RMmodel        1 14 1316.803 1370.734 -644.4014                         #> RMmodel_AV     2 17 1255.744 1321.232 -610.8722 1 vs 2 67.05833  <.0001  # Once again, we select the more complex model. # # We can continue increasing the complexity of the interaction structure in the same fashion, this # time we elect to use the additive interaction structure  RMmodel_ADD <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                    prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"ADD\",                    method = \"ML\")  anova(RMmodel_AV, RMmodel_ADD) #>             Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> RMmodel_AV      1 17 1255.744 1321.232 -610.8722                         #> RMmodel_ADD     2 26 1236.971 1337.128 -592.4856 1 vs 2 36.77332  <.0001  # We continue with the additive interactions structure, the next interaction structure to test # functional group interactions, is not nested with our additive model, so we compare th two using # information criterion. In this case we choose to use AICc, to better penalise extra terms, as AIC # becomes biased towards the more complex model as parameters numbers increase. # The functional group strcuture requires an additional parameter, FG, to specify groups.  RMmodel_FG <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                    prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"FG\",                    FG = c(\"G1\", \"G1\", \"G2\", \"G2\"),                    method = \"ML\")  AICc(RMmodel_ADD); AICc(RMmodel_FG) #> [1] 1243.351 #> [1] 1263.574  # In this case, we choose the lower valued model, which is the additive structure. # # The last interaction structure to test is the full pairwise model. Which we can see is not worth # the extra terms. So our final interaction structure chosen is additive.  RMmodel_FULL <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                    prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"FULL\",                    method = \"ML\")  anova(RMmodel_ADD, RMmodel_FULL) #>              Model df      AIC      BIC    logLik   Test  L.Ratio p-value #> RMmodel_ADD      1 26 1236.971 1337.128 -592.4856                         #> RMmodel_FULL     2 32 1237.600 1360.870 -586.7999 1 vs 2 11.37142  0.0776  # Finally, we can also increase the model complexity via the inclusion of the non-linear parameter # theta, which we can estimate, or select a value for. We also choose to estimate using the \"REML\" # method as we will do no further fixed effect model comparisons  RMmodel_theta <- DImulti(y = \"Y\", time = c(\"time\", \"AR1\"), unit_IDs = \"plot\",                       prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"ADD\",                       estimate_theta = TRUE, method = \"REML\")  print(RMmodel_theta) #> Note:  #> Method Used = REML  #> Correlation Structure Used = AR1 #>  Additive Interactions Model #> Theta estimate(s) = 0.9991 #>  #> Generalized least squares fit by REML #>   Model: Y ~ 0 + time:((p1_ID + p2_ID + p3_ID + p4_ID + p1_add + p2_add +      p3_add + p4_add))  #>       AIC       BIC    logLik  #> 1203.6852 1301.9845 -575.8426  #>  #>  Repeated Measure Correlation Structure: AR(1) #>  Formula: ~0 + as.numeric(time) | plot  #>  Parameter estimate(s): #>        Phi  #> 0.01150876  #>  #>  #> Table: Fixed Effect Coefficients #>  #>                Beta      Std. Error   t-value   p-value     Signif  #> -------------  --------  -----------  --------  ----------  ------- #> time1:p1_ID    +4.882    0.817        5.975     6.07e-09    ***     #> time2:p1_ID    +4.292    0.817        5.252     2.727e-07   ***     #> time3:p1_ID    +1.231    0.817        1.507     0.1328              #> time1:p2_ID    +2.119    0.815        2.600     0.009763    **      #> time2:p2_ID    +4.398    0.815        5.395     1.326e-07   ***     #> time3:p2_ID    +2.290    0.815        2.808     0.00528     **      #> time1:p3_ID    +3.657    0.531        6.882     3.068e-11   ***     #> time2:p3_ID    +7.043    0.531        13.252    2.505e-32   ***     #> time3:p3_ID    +6.442    0.531        12.121    3.868e-28   ***     #> time1:p4_ID    +4.988    0.819        6.094     3.128e-09   ***     #> time2:p4_ID    +5.933    0.819        7.248     3.125e-12   ***     #> time3:p4_ID    +4.975    0.819        6.078     3.423e-09   ***     #> time1:p1_add   +2.245    1.835        1.224     0.2219              #> time2:p1_add   +2.006    1.835        1.093     0.2751              #> time3:p1_add   +4.825    1.835        2.630     0.008949    **      #> time1:p2_add   +5.517    1.866        2.956     0.00334     **      #> time2:p2_add   +3.227    1.866        1.729     0.08469     +       #> time3:p2_add   +5.291    1.866        2.835     0.004869    **      #> time1:p3_add   +2.354    1.444        1.630     0.1041              #> time2:p3_add   -0.857    1.444        -0.593    0.5534              #> time3:p3_add   +0.238    1.444        0.165     0.869               #> time1:p4_add   +4.256    1.892        2.250     0.02515     *       #> time2:p4_add   +11.096   1.892        5.865     1.111e-08   ***     #> time3:p4_add   +9.209    1.892        4.867     1.769e-06   ***     #>  #> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' ' #>  #> Degrees of freedom: 348 total; 324 residual #> Residual standard error: 1.376275  #>  #> Marginal variance covariance matrix #>            1        2          3 #> 1 1.89410000 0.021799 0.00025088 #> 2 0.02179900 1.894100 0.02179900 #> 3 0.00025088 0.021799 1.89410000 #>   Standard Deviations: 1.3763 1.3763 1.3763   # We can however test changes to the correlation structure, testing the AR(1) structure we have been # using against the simpler CS strcuture.  RMmodel_CS <- DImulti(y = \"Y\", time = c(\"time\", \"CS\"), unit_IDs = \"plot\",                       prop = paste0(\"p\", 1:4), data = simRM, DImodel = \"ADD\",                       theta = 0.9991, method = \"REML\")  AICc(RMmodel_theta); AICc(RMmodel_CS) #> [1] 1210.065 #> [1] 1210.1  # We see that they are practically identical, but the AR(1) strcuture is preferred.  ################################################################################################## # ##################################################################################################  ## Code to simulate data # \\donttest{ set.seed(523)  props <- data.frame(plot = integer(),                     p1 = integer(),                     p2 = integer(),                     p3 = integer(),                     p4 = integer())  index <- 1 #row number  #Monocultures for(i in 1:4) #4 species {   for(j in 1:2) #2 technical reps   {     props[index, i+1] <- 1     index <- index + 1   } }   #Equal Mixtures for(rich in sort(rep(2:4, 3))) #3 reps at each richness level {   sp <- sample(1:4, rich) #randomly pick species from pool    for(j in 1:2) #2 technical reps   {     for(i in sp)     {       props[index, i+1] <- 1/rich #equal proportions     }     index <- index + 1   } }   #Unequal Mixtures for(rich in sort(rep(c(2, 3, 4), 15))) #15 reps at each richness level {   sp <- sample(1:4, rich, replace = TRUE) #randomly pick species from pool    for(j in 1:2) #2 technical reps   {     for(i in 1:4)     {       props[index, i+1] <- sum(sp==i)/rich #equal proportions     }     index <- index + 1   } }   props[is.na(props)] <- 0  mySimData <- props mySimData$Y <- NA  ADDs <- DImodels::DI_data(prop=2:5, what=c(\"ADD\"), data=mySimData) mySimData <- cbind(mySimData, ADDs)  E_AV <- DImodels::DI_data(prop=2:5, what=c(\"E\", \"AV\"), data=mySimData) mySimData <- cbind(mySimData, E_AV)  mySimData$plot <- 1:nrow(mySimData)  mySimData$time <- 1 mySimDataT1 <- mySimData mySimDataT2 <- mySimData mySimDataT3 <- mySimData mySimDataT2$time <- 2 mySimDataT3$time <- 3   n <- 3 #Number of Ys p <- qr.Q(qr(matrix(stats::rnorm(n^2), n))) #Principal Components (make sure it's positive definite) S <- crossprod(p, p*(n:1)) #Sigma m <- stats::runif(n, -0.25, 1.5)  #runif(11, -1, 7) #decide on betas randomly  for(i in 1:nrow(mySimData)) {   #Within subject error   error <- MASS::mvrnorm(n=1, mu=m, Sigma=S)   mySimDataT1$Y[i] <- 4.1*mySimDataT1$p1[i] + 2.1*mySimDataT1$p2[i] + 3.6*mySimDataT1$p3[i] +   4.8*mySimDataT1$p4[i] + 3.3*mySimDataT1$p1_add[i] + 4.0*mySimDataT1$p2_add[i] +   1.3*mySimDataT1$p3_add[i] + 5.2*mySimDataT1$p4_add[i] + error[1]   mySimDataT2$Y[i] <- 2.3*mySimDataT2$p1[i] + 2.4*mySimDataT2$p2[i] + 5.1*mySimDataT2$p3[i] +   5.0*mySimDataT2$p4[i] + 3.6*mySimDataT2$p1_add[i] + 4.5*mySimDataT2$p2_add[i] +   0.5*mySimDataT2$p3_add[i] + 6.5*mySimDataT2$p4_add[i] + error[2]   mySimDataT3$Y[i] <- 0.7*mySimDataT3$p1[i] + 2.3*mySimDataT3$p2[i] + 6.5*mySimDataT3$p3[i] +   5.9*mySimDataT3$p4[i] + 4.5*mySimDataT3$p1_add[i] + 5.2*mySimDataT3$p2_add[i] +   0.6*mySimDataT3$p3_add[i] + 7.8*mySimDataT3$p4_add[i] + error[3] }  mySimData <- rbind(mySimDataT1, mySimDataT2) mySimData <- rbind(mySimData, mySimDataT3)  mySimData$time <- as.factor(mySimData$time) mySimData$plot <- as.factor(mySimData$plot) # }"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/summary.DImulti.html","id":null,"dir":"Reference","previous_headings":"","what":"summary.DImulti — summary.DImulti","title":"summary.DImulti — summary.DImulti","text":"Print summary fitted DI models supplied","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/summary.DImulti.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summary.DImulti — summary.DImulti","text":"","code":"# S3 method for class 'DImulti' summary(object, verbose = FALSE, ...)"},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/summary.DImulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summary.DImulti — summary.DImulti","text":"object object inheriting class DImulti, representing generalized least squared fitted linear model using Diversity-Interactions framework verbose optional logical value used control amount output object printed. Defaults FALSE. ... methods generic function require additional arguments. None used method.","code":""},{"path":"https://di-laurabyrne.github.io/DImodelsMulti/reference/summary.DImulti.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summary.DImulti — summary.DImulti","text":"object inheriting class summary.gls components included object (see glsObject full description components) plus following components: corBeta, approximate correlation matrix coefficients estimates tTable, matrix columns Value, Std. Error, t-value, p-value representing respectively coefficients estimates, approximate standard errors, ratios estimates standard errors, associated p-value t approximation. Rows correspond different coefficients. residuals, five observations used gls fit, vector minimum, first quartile, median, third quartile, maximum residuals distribution; else residuals. AIC, Akaike Information Criterion corresponding object. BIC, Bayesian Information Criterion corresponding object. theta, values non-linear parameter theta used model","code":""},{"path":[]}]
