<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The recommended workflow of DImulti() analyses • DImodelsMulti</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The recommended workflow of DImulti() analyses">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsMulti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/DImulti_commonErrors.html">Common errors &amp; warnings encountered in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_onTheta.html">On the usage and estimation of theta in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_prediction.html">On prediction from multivariate repeated measures DI models</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_workflow.html">The recommended workflow of DImulti() analyses</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DI-LauraByrne/DImodelsMulti/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The recommended workflow of DImulti() analyses</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DI-LauraByrne/DImodelsMulti/blob/master/vignettes/DImulti_workflow.Rmd" class="external-link"><code>vignettes/DImulti_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>DImulti_workflow.Rmd</code></div>
    </div>

    
    
<style type="text/css">
span.R {
  font-family: Courier New;
}
</style>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com" class="external-link">DImodelsMulti</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette aims to give a rough outline for the process to be
followed when examining multivariate and/or repeated measures BEF
relationship study data using the <span class="R">DImulti()</span>
function from the <span class="R">DImodelsMulti</span> R package.</p>
<p>We will use the dataset <span class="R">simMVRM</span>, which is
included in the package, to illustrate the workflow of the package.</p>
<h2>
Examining the data
</h2>
<p>We always start by looking at our data using <span class="R">View()</span> or <span class="R">head()</span>, to make sure
it is as expected and includes all required information.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;   plot p1 p2 p3 p4         Y1          Y2        Y3 time</span></span>
<span><span class="co">#&gt; 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1</span></span>
<span><span class="co">#&gt; 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1</span></span>
<span><span class="co">#&gt; 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1</span></span>
<span><span class="co">#&gt; 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1</span></span>
<span><span class="co">#&gt; 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1</span></span>
<span><span class="co">#&gt; 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1</span></span></code></pre>
<p>We can then look at some summarising metrics, such as the mean of
each ecosystem function, separated by time as below, which can help us
know what to expect in the analysis, in this case we see that ecosystem
functioning improves at time point 2 for the average multifunctionality
index, <span class="R">MFindex</span>, but the function &lt;span
class”R”&gt;Y2 performs better at time 1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simMVRM_group</span> <span class="op">&lt;-</span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">simMVRM</span>, <span class="va">time</span><span class="op">)</span>,</span>
<span>                                   Y1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y1</span><span class="op">)</span>,</span>
<span>                                   Y2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,</span>
<span>                                   Y3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">)</span>,</span>
<span>                                   MFindex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">+</span> <span class="va">Y2</span> <span class="op">+</span> <span class="va">Y3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">simMVRM_group</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   time     Y1    Y2    Y3 MFindex</span></span>
<span><span class="co">#&gt;         </span></span>
<span><span class="co">#&gt; 1 1      2.21  3.07  5.53    10.8</span></span>
<span><span class="co">#&gt; 2 2     10.3   2.11  7.90    20.3</span></span></code></pre>
<p>We can also produce plots to the same effect.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span><span class="op">$</span><span class="va">Y1</span>, main <span class="op">=</span> <span class="st">"Y1 at time 1"</span>, xlab <span class="op">=</span> <span class="st">"Y1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImulti_workflow_files/figure-html/data_hist-1.png" alt="A histogram of the raw data" width="75%"></p>
<h2>
Fitting the first model
</h2>
<p>We use the main function of the <span class="R">DImodelsMulti</span>
R package, <span class="R">DImulti()</span>, to fit a repeated measures
Diversity-Interactions model to the data.</p>
<p>It is recommended to begin with the simplest model options and
increase complexity as model selection/comparisons permit. The simplest
model available to be fit by the package is the structural model, <span class="R">“STR”</span>, which only includes an intercept for each time
and ecosystem function.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>k</mi><mi>m</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>k</mi><mi>t</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>k</mi><mi>m</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> y_{kmt} =  \beta_{0kt} + \epsilon_{kmt} </annotation></semantics></math></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelSTR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"STR"</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></code></pre></div>
<p>As our dataset is multivariate and in a wide format, we specify our
response columns through the parameter <span class="R">y</span>, “NA”
through the first index of the vector <span class="R">eco_func</span>,
and select the unstructured (<span class="R">“UN”</span>)
autocorrelation structure for our ecosystem functions through the second
index of <span class="R">eco_func</span>. The data also contains
multiple time points, so we pass the column holding the time point
indicator through the parameter <span class="R">time</span>, along with
the chosen autocorrelation structure, in this case we use compound
symmetry, <span class="R">“CS”</span>. To facilitate grouping the
recorded responses, a column index for the unique identifier of the
experimental units is passed through <span class="R">unit_IDs</span>. We
choose to use the maximum likelihood (<span class="R">“ML”</span>)
estimation method as we intend to compare models with differing fixed
effects.</p>
<p>We can use <span class="R">print()</span> or <span class="R">summary()</span> to view information on the model in our
console.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">modelSTR</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Note: </span></span>
<span><span class="co">#&gt; Method Used = ML </span></span>
<span><span class="co">#&gt; Correlation Structure Used = UN@CS</span></span>
<span><span class="co">#&gt;  Structure Model</span></span>
<span><span class="co">#&gt; Theta value(s) = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generalized least squares fit by maximum likelihood</span></span>
<span><span class="co">#&gt;   Model: value ~ 0 + func:time </span></span>
<span><span class="co">#&gt;       AIC       BIC    logLik </span></span>
<span><span class="co">#&gt; 10020.215 10059.477 -5003.108 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Multivariate Correlation Structure: General</span></span>
<span><span class="co">#&gt;  Formula: ~0 | plot </span></span>
<span><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span><span class="co">#&gt;  Correlation: </span></span>
<span><span class="co">#&gt;   1     2    </span></span>
<span><span class="co">#&gt; 2 0.603      </span></span>
<span><span class="co">#&gt; 3 0.031 0.064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Repeated Measure Correlation Structure: Compound symmetry</span></span>
<span><span class="co">#&gt;  Formula: ~0 | plot </span></span>
<span><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span><span class="co">#&gt;       Rho </span></span>
<span><span class="co">#&gt; 0.3287314 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Fixed Effect Coefficients</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Beta      Std. Error   t-value   p-value      Signif </span></span>
<span><span class="co">#&gt; -------------  --------  -----------  --------  -----------  -------</span></span>
<span><span class="co">#&gt; funcY1:time1   +2.210    0.176        12.585    5.172e-35    ***    </span></span>
<span><span class="co">#&gt; funcY2:time1   +3.068    0.176        17.474    9.193e-64    ***    </span></span>
<span><span class="co">#&gt; funcY3:time1   +5.530    0.176        31.492    2.749e-177   ***    </span></span>
<span><span class="co">#&gt; funcY1:time2   +10.287   0.176        58.583    0            ***    </span></span>
<span><span class="co">#&gt; funcY2:time2   +2.106    0.176        11.992    4.702e-32    ***    </span></span>
<span><span class="co">#&gt; funcY3:time2   +7.900    0.176        44.989    2.22e-306    ***    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of freedom: 2016 total; 2010 residual</span></span>
<span><span class="co">#&gt; Residual standard error: 3.213922 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Multivariate</span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;        [,1]    [,2]    [,3]</span></span>
<span><span class="co">#&gt; [1,] 7.1668 3.59190 0.20620</span></span>
<span><span class="co">#&gt; [2,] 3.5919 4.94460 0.34982</span></span>
<span><span class="co">#&gt; [3,] 0.2062 0.34982 6.09090</span></span>
<span><span class="co">#&gt;   Standard Deviations: 2.6771 2.2236 2.468 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Repeated Measure`</span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;         [,1]    [,2]</span></span>
<span><span class="co">#&gt; [1,] 13.5390  4.4509</span></span>
<span><span class="co">#&gt; [2,]  4.4509 13.5390</span></span>
<span><span class="co">#&gt;   Standard Deviations: 3.6796 3.6796 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Combined</span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span></span>
<span><span class="co">#&gt; Y1:1 10.32900  3.39560  6.23260  2.04890  0.32238  0.10598</span></span>
<span><span class="co">#&gt; Y1:2  3.39560 10.32900  2.04890  6.23260  0.10598  0.32238</span></span>
<span><span class="co">#&gt; Y2:1  6.23260  2.04890 10.32900  3.39560  0.65843  0.21645</span></span>
<span><span class="co">#&gt; Y2:2  2.04890  6.23260  3.39560 10.32900  0.21645  0.65843</span></span>
<span><span class="co">#&gt; Y3:1  0.32238  0.10598  0.65843  0.21645 10.32900  3.39560</span></span>
<span><span class="co">#&gt; Y3:2  0.10598  0.32238  0.21645  0.65843  3.39560 10.32900</span></span>
<span><span class="co">#&gt;   Standard Deviations: 3.2139 3.2139 3.2139 3.2139 3.2139 3.2139</span></span></code></pre>
<p>From this evaluation, we can see that each of our coefficients are
significant at an alpha significance level of 0.05
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.05</annotation></semantics></math>).
We can also see the variance covariance matrices for our repeated
measures and multiple ecosystem functions, along with the combined
matrix, from which we can see the estimated strength and direction of
the covarying relationships between response types.</p>
<h2>
Fitting a Diversity-Interactions model
</h2>
<p>The next model to be fit is the simplest Diversity-Interactions (DI)
model available in the package, the identity (<span class="R">“ID”</span>) structure.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>k</mi><mi>m</mi><mi>t</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>S</mi></munderover><mrow><msub><mi>β</mi><mrow><mi>i</mi><mi>k</mi><mi>t</mi></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>k</mi><mi>m</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> y_{kmt} =  \sum^{S}_{i=1}{\beta_{ikt} p_{im}} + \epsilon_{kmt} </annotation></semantics></math>
The DI modelling framework assumes that the main driver behind changes
in ecosystem functioning is the initial relative abundance/proportion of
the species.To reflect this, the intercept from the structural model we
fit previously is replaced by the initial proportion of the species in
the study, each with their own
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
coefficient. These fixed effects form a simplex space. The only code
that we need to change for this model is the <span class="R">DImodel</span> tag, from <span class="R">“STR”</span> to <span class="R">“ID”</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"ID"</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></code></pre></div>
<p>We can now view this model, as before. In this case, we simply
extract the t-table from the model summary.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelID</span><span class="op">)</span><span class="op">$</span><span class="va">tTable</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;                         Value Std.Error    t-value       p-value</span></span>
<span><span class="co">#&gt; funcY1:time1:p1_ID -0.7089886 0.4850517 -1.4616764  1.439876e-01</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID  2.2706049 0.4850517  4.6811605  3.044755e-06</span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID  2.4398359 0.4850517  5.0300533  5.343174e-07</span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID  8.3721996 0.4850517 17.2604275  2.537220e-62</span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID  3.7953423 0.4850517  7.8246139  8.196811e-15</span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID  4.0229523 0.4850517  8.2938629  1.992354e-16</span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID  5.3748998 0.4642573 11.5774151  4.797017e-30</span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID  5.9337382 0.4642573 12.7811407  5.208852e-36</span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID  7.9975235 0.4642573 17.2264884  4.229086e-62</span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID 12.1055179 0.4642573 26.0750174 3.365045e-129</span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID  3.7172258 0.4642573  8.0068220  1.981376e-15</span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID 10.7688254 0.4642573 23.1958114 1.458556e-105</span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID  3.3833228 0.4816376  7.0246237  2.934612e-12</span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID  1.2053951 0.4816376  2.5027016  1.240448e-02</span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID  4.8562397 0.4816376 10.0827675  2.366669e-23</span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID 12.8552387 0.4816376 26.6906886 1.958774e-134</span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID -2.1517318 0.4816376 -4.4675331  8.356377e-06</span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID  7.7120367 0.4816376 16.0121158  2.241213e-54</span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID -0.1039377 0.5451144 -0.1906714  8.488025e-01</span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID  2.5098803 0.5451144  4.6043189  4.399390e-06</span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID  6.6262284 0.5451144 12.1556668  7.555809e-33</span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID  6.8749751 0.5451144 12.6119869  3.845165e-35</span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID  3.3475340 0.5451144  6.1409757  9.873634e-10</span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID  8.7581311 0.5451144 16.0665942  1.030638e-54</span></span></code></pre>
<p>The models within the DI modelling framework can be easily compared
as they are hierarchical in nature, i.e. they are nested within one
another. We can compare nested models using a likelihood ratio test,
through <span class="R">anova()</span>, or information criteria, such as
<span class="R">AIC()</span> or <span class="R">BIC()</span> (the
correct versions of which, <span class="R">AICc()</span> or <span class="R">BICc()</span> should be used in the cased of models with a
large number of terms).</p>
<p><img src="Hierarchy.png" style="width:100.0%" alt="An image from Kirwan et al. 2009 showing the hierarchical order of DI models">
Image Credit: Kirwan <em>et al.</em> 2009</p>
<p>We choose to compare these models using a likelihood ratio test,
where the null hypothesis states that the likelihoods of the two models
do not significantly differ from one another, i.e. the extra terms in
our larger model are not worth the added complexity.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">modelSTR</span>, <span class="va">modelID</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;          Model df      AIC       BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">#&gt; modelSTR     1  7 10020.22 10059.477 -5003.108                        </span></span>
<span><span class="co">#&gt; modelID      2 25  9670.78  9811.002 -4810.390 1 vs 2 385.4351  &lt;.0001</span></span></code></pre>
<p>As the p-value of the test is less than our chosen
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
value of 0.05, we reject the null hypothesis and proceed with the more
complex model. We can confirm this selection by choosing the model with
the lower AIC and BIC values, which are also printed by the <span class="R">anova()</span> call.</p>
<h2>
Fitting and comparing interactions structures
</h2>
<p>We continue to increase the complexity of the models by fitting the
next interaction structure in the nesting series, the average
interaction model, <span class="R">“AV”</span>, a reparameterisation of
the evenness model, <span class="R">“E”</span>. Again, the only code
change required is the change of the <span class="R">DImodel</span> tag.
We then compare the two models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelAV</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">modelAV</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; funcY1:time1:p1_ID funcY2:time1:p1_ID funcY3:time1:p1_ID funcY1:time2:p1_ID </span></span>
<span><span class="co">#&gt;         -1.4073525          0.3535514          0.9463605          0.1419124 </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID funcY3:time2:p1_ID funcY1:time1:p2_ID funcY2:time1:p2_ID </span></span>
<span><span class="co">#&gt;          2.6296879         -0.5521430          4.7699282          4.2730527 </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID funcY1:time2:p2_ID funcY2:time2:p2_ID funcY3:time2:p2_ID </span></span>
<span><span class="co">#&gt;          6.7037708          4.9758685          2.7074546          6.8055585 </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID funcY2:time1:p3_ID funcY3:time1:p3_ID funcY1:time2:p3_ID </span></span>
<span><span class="co">#&gt;          2.6653214         -0.7655644          3.3207690          4.3935222 </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID funcY3:time2:p3_ID funcY1:time1:p4_ID funcY2:time1:p4_ID </span></span>
<span><span class="co">#&gt;         -3.3501635          3.0082933         -0.8997879          0.3252207 </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID funcY1:time2:p4_ID funcY2:time2:p4_ID funcY3:time2:p4_ID </span></span>
<span><span class="co">#&gt;          4.9242752         -2.5041979          2.0191631          3.5443872 </span></span>
<span><span class="co">#&gt;    funcY1:time1:AV    funcY2:time1:AV    funcY3:time1:AV    funcY1:time2:AV </span></span>
<span><span class="co">#&gt;          2.8917739          7.9381038          6.1841587         34.0798392 </span></span>
<span><span class="co">#&gt;    funcY2:time2:AV    funcY3:time2:AV </span></span>
<span><span class="co">#&gt;          4.8267227         18.9444801</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">modelID</span>, <span class="va">modelAV</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;         Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">#&gt; modelID     1 25 9670.780 9811.002 -4810.390                        </span></span>
<span><span class="co">#&gt; modelAV     2 31 7921.064 8094.939 -3929.532 1 vs 2 1761.716  &lt;.0001</span></span></code></pre>
<p>Once again, as our p-value &lt; 0.05, we select the more complex
model and continue increasing complexity.</p>
<h3>
Estimating theta
</h3>
<p>Now that we are fitting interactions, we may elect to estimate the
non-linear parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
see vignette <a href="DImulti_onTheta.html">onTheta</a> for a more in
depth look at this process. We include the parameter <span class="R">estimate_theta</span> with argument <span class="R">TRUE</span> to have <span class="R">DImulti()</span>
automatically fit and compare different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
or if a user has <em>a priori</em> information on the nature of the
term, they may pass values through the parameter <span class="R">theta</span>. We can then test the two models against one
another using information criteria, to see if the theta values
significantly differ from 1.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelAV_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>                    estimate_theta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">thetaVals</span> <span class="op">&lt;-</span> <span class="va">modelAV_theta</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="va">thetaVals</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;        Y1        Y2        Y3 </span></span>
<span><span class="co">#&gt; 0.9704075 0.7538283 1.0089178</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/AICc.html">AICc</a></span><span class="op">(</span><span class="va">modelAV</span><span class="op">)</span> </span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; [1] 7924.065</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/AICc.html">AICc</a></span><span class="op">(</span><span class="va">modelAV_theta</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; [1] 7925.468</span></span></code></pre>
<p>In this case, the inclusion of theta does improve the model.</p>
<p>The next models in the series are not nested within one another, so
either can be used next but they cannot be compared to one another using
a likelihood ratio test. As this dataset was simulated without any
functional groupings, i.e. any groupings would be arbitrary, we choose
to fit the additive interaction structure, <span class="R">“ADD”</span>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelADD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>                    theta <span class="op">=</span> <span class="va">thetaVals</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modelADD</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;  funcY1:time1:p1_ID  funcY2:time1:p1_ID  funcY3:time1:p1_ID  funcY1:time2:p1_ID </span></span>
<span><span class="co">#&gt;          -1.7359116           0.6220873           0.8306034           0.5333102 </span></span>
<span><span class="co">#&gt;  funcY2:time2:p1_ID  funcY3:time2:p1_ID  funcY1:time1:p2_ID  funcY2:time1:p2_ID </span></span>
<span><span class="co">#&gt;           3.1536780          -0.5191246           5.0712439           4.5957336 </span></span>
<span><span class="co">#&gt;  funcY3:time1:p2_ID  funcY1:time2:p2_ID  funcY2:time2:p2_ID  funcY3:time2:p2_ID </span></span>
<span><span class="co">#&gt;           6.5331291           5.0338021           2.6914905           6.6839494 </span></span>
<span><span class="co">#&gt;  funcY1:time1:p3_ID  funcY2:time1:p3_ID  funcY3:time1:p3_ID  funcY1:time2:p3_ID </span></span>
<span><span class="co">#&gt;           2.8007941          -0.3963605           3.1524650           4.1615837 </span></span>
<span><span class="co">#&gt;  funcY2:time2:p3_ID  funcY3:time2:p3_ID  funcY1:time1:p4_ID  funcY2:time1:p4_ID </span></span>
<span><span class="co">#&gt;          -3.6600896           2.8228767          -0.8927389           0.2904958 </span></span>
<span><span class="co">#&gt;  funcY3:time1:p4_ID  funcY1:time2:p4_ID  funcY2:time2:p4_ID  funcY3:time2:p4_ID </span></span>
<span><span class="co">#&gt;           5.3335244          -2.5160788           1.9271926           3.9338629 </span></span>
<span><span class="co">#&gt; funcY1:time1:p1_add funcY2:time1:p1_add funcY3:time1:p1_add funcY1:time2:p1_add </span></span>
<span><span class="co">#&gt;           2.5644430           2.0773752           3.4983147          14.8080294 </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_add funcY3:time2:p1_add funcY1:time1:p2_add funcY2:time1:p2_add </span></span>
<span><span class="co">#&gt;           0.2523371           9.5105902           0.3056735           1.9357991 </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_add funcY1:time2:p2_add funcY2:time2:p2_add funcY3:time2:p2_add </span></span>
<span><span class="co">#&gt;           3.8167351          15.9865187           1.5840093          10.1416728 </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_add funcY2:time1:p3_add funcY3:time1:p3_add funcY1:time2:p3_add </span></span>
<span><span class="co">#&gt;           0.9518601           1.9226222           3.6292397          17.0451438 </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_add funcY3:time2:p3_add funcY1:time1:p4_add funcY2:time1:p4_add </span></span>
<span><span class="co">#&gt;           2.3401579          10.2709728           1.5179191           2.6992333 </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_add funcY1:time2:p4_add funcY2:time2:p4_add funcY3:time2:p4_add </span></span>
<span><span class="co">#&gt;           1.7085512          16.0514375           1.5748809           8.3374370</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">modelAV_theta</span>, <span class="va">modelADD</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;               Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">#&gt; modelAV_theta     1 31 7922.467 8096.342 -3930.233                        </span></span>
<span><span class="co">#&gt; modelADD          2 49 7949.478 8224.313 -3925.739 1 vs 2 8.988271    0.96</span></span></code></pre>
<p>In this case, the p-value is greater than our chosen alpha level of
0.05, therefore we fail to reject the null hypothesis that the added
complexity of the model does not significantly increase the model
likelihood, and proceed in our analysis with the simpler model, <span class="R">modelAV</span>.</p>
<p>As we do not need to increase the complexity of the model through the
interaction structures any further, we turn to other options. It is at
this stage that one could introduce treatment effects or environmental
variables. As the <span class="R">simMVRM</span> dataset does not
contain any such information, example code is included below, where
model <span class="R">modelAV_treat1</span> includes an intercept for
<span class="R">treat</span> for each level of ecosystem function and
time point, while <span class="R">modelAV_treat2</span> crosses <span class="R">treat</span> with each other fixed effect term.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelAV_treat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>                    theta <span class="op">=</span> <span class="va">thetaVals</span>, extra_fixed <span class="op">=</span> <span class="op">~</span><span class="va">treat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modelAV_treat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>                    theta <span class="op">=</span> <span class="va">thetaVals</span>, extra_fixed <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">:</span><span class="va">treat</span><span class="op">)</span></span></code></pre></div>
<p>The model could also alternatively be simplified here, by adding ID
grouping, i.e. introducing functional redundancy within species ID
effects. As <span class="R">simMVRM</span> is simulated with no ID
grouping in mind, any groups selected would be arbitrary and thus not
recommended, however, example code for doing so is included below. These
groupings do not affect the interaction term(s).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelAV_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span>
<span>                    theta <span class="op">=</span> <span class="va">thetaVals</span>, ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group1"</span>, <span class="st">"Group1"</span>, <span class="st">"Group2"</span>, <span class="st">"Group2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelAV_ID</span><span class="op">)</span><span class="op">$</span><span class="va">tTable</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;                          Value Std.Error    t-value       p-value</span></span>
<span><span class="co">#&gt; funcY1:time1:Group1  2.0780193 0.3969589  5.2348481  1.824551e-07</span></span>
<span><span class="co">#&gt; funcY2:time1:Group1  2.6856632 0.3737420  7.1858750  9.387971e-13</span></span>
<span><span class="co">#&gt; funcY3:time1:Group1  4.0570266 0.4036703 10.0503471  3.226440e-23</span></span>
<span><span class="co">#&gt; funcY1:time2:Group1  2.9615550 0.3969589  7.4606095  1.277413e-13</span></span>
<span><span class="co">#&gt; funcY2:time2:Group1  2.5432807 0.3737420  6.8049102  1.331950e-11</span></span>
<span><span class="co">#&gt; funcY3:time2:Group1  3.4510622 0.4036703  8.5492100  2.422939e-17</span></span>
<span><span class="co">#&gt; funcY1:time1:Group2  1.5061043 0.4436609  3.3947194  7.004175e-04</span></span>
<span><span class="co">#&gt; funcY2:time1:Group2  0.1131795 0.4196658  0.2696895  7.874270e-01</span></span>
<span><span class="co">#&gt; funcY3:time1:Group2  4.3034644 0.4508442  9.5453482  3.801181e-21</span></span>
<span><span class="co">#&gt; funcY1:time2:Group2  1.7204619 0.4436609  3.8778758  1.087797e-04</span></span>
<span><span class="co">#&gt; funcY2:time2:Group2 -1.1051468 0.4196658 -2.6333972  8.518732e-03</span></span>
<span><span class="co">#&gt; funcY3:time2:Group2  3.6166744 0.4508442  8.0220058  1.755195e-15</span></span>
<span><span class="co">#&gt; funcY1:time1:AV      1.5835003 1.2085830  1.3102123  1.902746e-01</span></span>
<span><span class="co">#&gt; funcY2:time1:AV      4.1273242 0.7073168  5.8351847  6.253811e-09</span></span>
<span><span class="co">#&gt; funcY3:time1:AV      5.7111829 1.3409952  4.2589139  2.149532e-05</span></span>
<span><span class="co">#&gt; funcY1:time2:AV     30.9819704 1.2085830 25.6349556 1.527227e-125</span></span>
<span><span class="co">#&gt; funcY2:time2:AV      3.3411099 0.7073168  4.7236399  2.477868e-06</span></span>
<span><span class="co">#&gt; funcY3:time2:AV     18.4144193 1.3409952 13.7319060  4.504825e-41</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">modelAV_ID</span>, <span class="va">modelAV</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;            Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">#&gt; modelAV_ID     1 19 8936.491 9043.060 -4449.246                        </span></span>
<span><span class="co">#&gt; modelAV        2 31 7921.064 8094.939 -3929.532 1 vs 2 1039.428  &lt;.0001</span></span></code></pre>
<p>As the p-value is lower than 0.05, we reject the null hypothesis and
continue with the more complex model, without any ID groupings.</p>
<p>If any errors are encountered in the process of fitting these models,
please see vignette <a href="DImulti_commonErrors.html">commonErrors</a>
for a guide.</p>
<h2>
Final model
</h2>
<p>As we have concluded our model selection process, the final step
before interpretation is to refit the chosen model design using the
method <span class="R">“REML”</span>, for unbiased estimates.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelFinal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span><span class="op">)</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span>
<span>                    unit_IDs <span class="op">=</span> <span class="fl">1</span>, prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, method <span class="op">=</span> <span class="st">"REML"</span>,</span>
<span>                    theta <span class="op">=</span> <span class="va">thetaVals</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelFinal</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Generalized least squares fit by REML</span></span>
<span><span class="co">#&gt;   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + AV)) </span></span>
<span><span class="co">#&gt;   Data: data </span></span>
<span><span class="co">#&gt;        AIC      BIC    logLik</span></span>
<span><span class="co">#&gt;   7933.636 8107.046 -3935.818</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation Structure: General</span></span>
<span><span class="co">#&gt;  Formula: ~0 | plot </span></span>
<span><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span><span class="co">#&gt;  Correlation: </span></span>
<span><span class="co">#&gt;   1      2      3      4      5     </span></span>
<span><span class="co">#&gt; 2  0.313                            </span></span>
<span><span class="co">#&gt; 3  0.609  0.190                     </span></span>
<span><span class="co">#&gt; 4  0.190  0.609  0.313              </span></span>
<span><span class="co">#&gt; 5 -0.310 -0.097 -0.363 -0.113       </span></span>
<span><span class="co">#&gt; 6 -0.097 -0.310 -0.113 -0.363  0.313</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                       Value Std.Error  t-value p-value</span></span>
<span><span class="co">#&gt; funcY1:time1:p1_ID -1.36371 0.3974983 -3.43074  0.0006</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID  0.59447 0.3838339  1.54878  0.1216</span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID  0.91484 0.4006889  2.28317  0.0225</span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID  0.20219 0.3974983  0.50864  0.6111</span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID  2.66633 0.3838339  6.94658  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID -0.54154 0.4006889 -1.35153  0.1767</span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID  4.80967 0.3682312 13.06155  0.0000</span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID  4.52253 0.3550687 12.73704  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID  6.67510 0.3713043 17.97745  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID  5.05228 0.3682312 13.72040  0.0000</span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID  2.76666 0.3550687  7.79189  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID  6.81066 0.3713043 18.34252  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID  2.71111 0.3993022  6.78961  0.0000</span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID -0.49800 0.3837593 -1.29768  0.1945</span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID  3.28772 0.4029109  8.15992  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID  4.46694 0.3993022 11.18688  0.0000</span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID -3.29911 0.3837593 -8.59681  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID  3.01727 0.4029109  7.48868  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID -0.85272 0.4494086 -1.89742  0.0579</span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID  0.54286 0.4370084  1.24222  0.2143</span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID  4.89022 0.4523511 10.81068  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID -2.46873 0.4494086 -5.49328  0.0000</span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID  2.02259 0.4370084  4.62825  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID  3.56205 0.4523511  7.87453  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time1:AV     2.56005 0.9052026  2.82815  0.0047</span></span>
<span><span class="co">#&gt; funcY2:time1:AV     4.28277 0.5293371  8.09082  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time1:AV     6.42445 0.9981712  6.43622  0.0000</span></span>
<span><span class="co">#&gt; funcY1:time2:AV    31.94569 0.9052026 35.29120  0.0000</span></span>
<span><span class="co">#&gt; funcY2:time2:AV     2.88480 0.5293371  5.44983  0.0000</span></span>
<span><span class="co">#&gt; funcY3:time2:AV    19.22917 0.9981712 19.26440  0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Theta values: Y1:0.9704, Y2:0.7538, Y3:1.0089</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Correlation: </span></span>
<span><span class="co">#&gt;                    fY1:1:1 fY2:1:1 fY3:1:1 fY1:2:1 fY2:2:1 fY3:2:1 fY1:1:2</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID  0.604                                                 </span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID -0.306  -0.358                                         </span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID  0.313   0.189  -0.096                                 </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID  0.189   0.313  -0.112   0.604                         </span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID -0.096  -0.112   0.313  -0.306  -0.358                 </span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID  0.205   0.104  -0.062   0.064   0.033  -0.019         </span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID  0.100   0.146  -0.060   0.031   0.046  -0.019   0.604 </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID -0.062  -0.063   0.218  -0.019  -0.020   0.068  -0.307 </span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID  0.064   0.033  -0.019   0.205   0.104  -0.062   0.313 </span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID  0.031   0.046  -0.019   0.100   0.146  -0.060   0.189 </span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID -0.019  -0.020   0.068  -0.062  -0.063   0.218  -0.096 </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID  0.202   0.100  -0.061   0.063   0.031  -0.019   0.174 </span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID  0.099   0.140  -0.059   0.031   0.044  -0.019   0.083 </span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID -0.061  -0.060   0.216  -0.019  -0.019   0.067  -0.052 </span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID  0.063   0.031  -0.019   0.202   0.100  -0.061   0.054 </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID  0.031   0.044  -0.019   0.099   0.140  -0.059   0.026 </span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID -0.019  -0.019   0.067  -0.061  -0.060   0.216  -0.016 </span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID  0.255   0.134  -0.077   0.080   0.042  -0.024   0.154 </span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID  0.138   0.206  -0.083   0.043   0.065  -0.026   0.076 </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID -0.077  -0.080   0.266  -0.024  -0.025   0.083  -0.046 </span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID  0.080   0.042  -0.024   0.255   0.134  -0.077   0.048 </span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID  0.043   0.065  -0.026   0.138   0.206  -0.083   0.024 </span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID -0.024  -0.025   0.083  -0.077  -0.080   0.266  -0.014 </span></span>
<span><span class="co">#&gt; funcY1:time1:AV    -0.582  -0.321   0.177  -0.182  -0.100   0.055  -0.543 </span></span>
<span><span class="co">#&gt; funcY2:time1:AV    -0.347  -0.540   0.207  -0.108  -0.169   0.065  -0.323 </span></span>
<span><span class="co">#&gt; funcY3:time1:AV     0.174   0.189  -0.591   0.054   0.059  -0.185   0.162 </span></span>
<span><span class="co">#&gt; funcY1:time2:AV    -0.182  -0.100   0.055  -0.582  -0.321   0.177  -0.170 </span></span>
<span><span class="co">#&gt; funcY2:time2:AV    -0.108  -0.169   0.065  -0.347  -0.540   0.207  -0.101 </span></span>
<span><span class="co">#&gt; funcY3:time2:AV     0.054   0.059  -0.185   0.174   0.189  -0.591   0.051 </span></span>
<span><span class="co">#&gt;                    fY2:1:2 fY3:1:2 fY1:2:2 fY2:2:2 fY3:2:2 fY1:1:3 fY2:1:3</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID -0.358                                                 </span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID  0.189  -0.096                                         </span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID  0.313  -0.112   0.604                                 </span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID -0.112   0.313  -0.307  -0.358                         </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID  0.080  -0.053   0.054   0.025  -0.016                 </span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID  0.109  -0.051   0.026   0.034  -0.016   0.603         </span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID -0.049   0.188  -0.016  -0.015   0.059  -0.306  -0.358 </span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID  0.025  -0.016   0.174   0.080  -0.053   0.313   0.189 </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID  0.034  -0.016   0.083   0.109  -0.051   0.189   0.313 </span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID -0.015   0.059  -0.052  -0.049   0.188  -0.096  -0.112 </span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID  0.068  -0.047   0.048   0.021  -0.015   0.240   0.122 </span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID  0.096  -0.046   0.024   0.030  -0.015   0.128   0.187 </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID -0.041   0.167  -0.014  -0.013   0.052  -0.072  -0.073 </span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID  0.021  -0.015   0.154   0.068  -0.047   0.075   0.038 </span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID  0.030  -0.015   0.076   0.096  -0.046   0.040   0.058 </span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID -0.013   0.052  -0.046  -0.041   0.167  -0.023  -0.023 </span></span>
<span><span class="co">#&gt; funcY1:time1:AV    -0.292   0.165  -0.170  -0.091   0.052  -0.595  -0.327 </span></span>
<span><span class="co">#&gt; funcY2:time1:AV    -0.491   0.194  -0.101  -0.154   0.061  -0.354  -0.549 </span></span>
<span><span class="co">#&gt; funcY3:time1:AV     0.172  -0.553   0.051   0.054  -0.173   0.178   0.192 </span></span>
<span><span class="co">#&gt; funcY1:time2:AV    -0.091   0.052  -0.543  -0.292   0.165  -0.186  -0.102 </span></span>
<span><span class="co">#&gt; funcY2:time2:AV    -0.154   0.061  -0.323  -0.491   0.194  -0.111  -0.171 </span></span>
<span><span class="co">#&gt; funcY3:time2:AV     0.054  -0.173   0.162   0.172  -0.553   0.056   0.060 </span></span>
<span><span class="co">#&gt;                    fY3:1:3 fY1:2:3 fY2:2:3 fY3:2:3 fY1:1:4 fY2:1:4 fY3:1:4</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID -0.096                                                 </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID -0.112   0.603                                         </span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID  0.313  -0.306  -0.358                                 </span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID -0.073   0.075   0.038  -0.023                         </span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID -0.077   0.040   0.058  -0.024   0.604                 </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID  0.252  -0.023  -0.023   0.079  -0.306  -0.358         </span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID -0.023   0.240   0.122  -0.073   0.313   0.189  -0.096 </span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID -0.024   0.128   0.187  -0.077   0.189   0.313  -0.112 </span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID  0.079  -0.072  -0.073   0.252  -0.096  -0.112   0.313 </span></span>
<span><span class="co">#&gt; funcY1:time1:AV     0.181  -0.186  -0.102   0.057  -0.589  -0.331   0.178 </span></span>
<span><span class="co">#&gt; funcY2:time1:AV     0.212  -0.111  -0.171   0.066  -0.351  -0.556   0.209 </span></span>
<span><span class="co">#&gt; funcY3:time1:AV    -0.605   0.056   0.060  -0.189   0.176   0.195  -0.596 </span></span>
<span><span class="co">#&gt; funcY1:time2:AV     0.057  -0.595  -0.327   0.181  -0.184  -0.104   0.056 </span></span>
<span><span class="co">#&gt; funcY2:time2:AV     0.066  -0.354  -0.549   0.212  -0.110  -0.174   0.065 </span></span>
<span><span class="co">#&gt; funcY3:time2:AV    -0.189   0.178   0.192  -0.605   0.055   0.061  -0.186 </span></span>
<span><span class="co">#&gt;                    fY1:2:4 fY2:2:4 fY3:2:4 fY1:1:A fY2:1:A fY3:1:A fY1:2:A</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID                                                        </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID                                                        </span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID                                                        </span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID  0.604                                                 </span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID -0.306  -0.358                                         </span></span>
<span><span class="co">#&gt; funcY1:time1:AV    -0.184  -0.104   0.056                                 </span></span>
<span><span class="co">#&gt; funcY2:time1:AV    -0.110  -0.174   0.065   0.595                         </span></span>
<span><span class="co">#&gt; funcY3:time1:AV     0.055   0.061  -0.186  -0.299  -0.350                 </span></span>
<span><span class="co">#&gt; funcY1:time2:AV    -0.589  -0.331   0.178   0.313   0.186  -0.093         </span></span>
<span><span class="co">#&gt; funcY2:time2:AV    -0.351  -0.556   0.209   0.186   0.313  -0.109   0.595 </span></span>
<span><span class="co">#&gt; funcY3:time2:AV     0.176   0.195  -0.596  -0.093  -0.109   0.313  -0.299 </span></span>
<span><span class="co">#&gt;                    fY2:2:A</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID        </span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID        </span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID        </span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID        </span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID        </span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID        </span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID        </span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID        </span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID        </span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID        </span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID        </span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID        </span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID        </span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID        </span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID        </span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID        </span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID        </span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID        </span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID        </span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID        </span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID        </span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID        </span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID        </span></span>
<span><span class="co">#&gt; funcY1:time1:AV           </span></span>
<span><span class="co">#&gt; funcY2:time1:AV           </span></span>
<span><span class="co">#&gt; funcY3:time1:AV           </span></span>
<span><span class="co">#&gt; funcY1:time2:AV           </span></span>
<span><span class="co">#&gt; funcY2:time2:AV           </span></span>
<span><span class="co">#&gt; funcY3:time2:AV    -0.350 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized residuals:</span></span>
<span><span class="co">#&gt;         Min          Q1         Med          Q3         Max </span></span>
<span><span class="co">#&gt; -4.14701963 -0.38462918 -0.03745628  0.33589476  6.84115299 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.948135 </span></span>
<span><span class="co">#&gt; Degrees of freedom: 2016 total; 1986 residual</span></span></code></pre>
<h2>
Interpretation
</h2>
<p>The final and most important step in the workflow of any analysis is
the interpretation of the final model.</p>
<p>We first look at the fixed effect coefficients, their significance
and direction. For example, we can see that the identity effect of
species <span class="R">p1</span> has a significant, negative effect on
ecosystem function <span class="R">Y1</span> at time point <span class="R">1</span>, but a significant positive effect on ecosystem
function <span class="R">Y3</span> at the same time point. We can also
see that the interaction effect <span class="R">AV</span> has a
significant positive effect on all ecosystem functions at both time
points. As this interaction term is maxmimised in an ecosystem design
where all four species are represented evenly, it may be beneficial to
include species <span class="R">p1</span> despite its negative effect on
<span class="R">Y1</span>, the presence of other species, which have a
positive effect on this ecosystem function could also ‘make up’ for this
fault of species <span class="R">p1</span> (assuming that our goal is
the maximisation of all ecosystem functions).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelFinal</span><span class="op">)</span><span class="op">$</span><span class="va">tTable</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;                         Value Std.Error    t-value       p-value</span></span>
<span><span class="co">#&gt; funcY1:time1:p1_ID -1.3637130 0.3974983 -3.4307392  6.142533e-04</span></span>
<span><span class="co">#&gt; funcY2:time1:p1_ID  0.5944749 0.3838339  1.5487816  1.215936e-01</span></span>
<span><span class="co">#&gt; funcY3:time1:p1_ID  0.9148420 0.4006889  2.2831729  2.252540e-02</span></span>
<span><span class="co">#&gt; funcY1:time2:p1_ID  0.2021854 0.3974983  0.5086446  6.110578e-01</span></span>
<span><span class="co">#&gt; funcY2:time2:p1_ID  2.6663312 0.3838339  6.9465760  5.053735e-12</span></span>
<span><span class="co">#&gt; funcY3:time2:p1_ID -0.5415428 0.4006889 -1.3515295  1.766798e-01</span></span>
<span><span class="co">#&gt; funcY1:time1:p2_ID  4.8096710 0.3682312 13.0615511  1.822351e-37</span></span>
<span><span class="co">#&gt; funcY2:time1:p2_ID  4.5225251 0.3550687 12.7370419  8.870783e-36</span></span>
<span><span class="co">#&gt; funcY3:time1:p2_ID  6.6751033 0.3713043 17.9774456  4.537068e-67</span></span>
<span><span class="co">#&gt; funcY1:time2:p2_ID  5.0522785 0.3682312 13.7203966  5.334921e-41</span></span>
<span><span class="co">#&gt; funcY2:time2:p2_ID  2.7666580 0.3550687  7.7918946  1.055885e-14</span></span>
<span><span class="co">#&gt; funcY3:time2:p2_ID  6.8106584 0.3713043 18.3425237  1.513944e-69</span></span>
<span><span class="co">#&gt; funcY1:time1:p3_ID  2.7111060 0.3993022  6.7896098  1.479985e-11</span></span>
<span><span class="co">#&gt; funcY2:time1:p3_ID -0.4979964 0.3837593 -1.2976790  1.945484e-01</span></span>
<span><span class="co">#&gt; funcY3:time1:p3_ID  3.2877219 0.4029109  8.1599233  5.882415e-16</span></span>
<span><span class="co">#&gt; funcY1:time2:p3_ID  4.4669443 0.3993022 11.1868768  3.234081e-28</span></span>
<span><span class="co">#&gt; funcY2:time2:p3_ID -3.2991057 0.3837593 -8.5968099  1.632662e-17</span></span>
<span><span class="co">#&gt; funcY3:time2:p3_ID  3.0172689 0.4029109  7.4886757  1.040397e-13</span></span>
<span><span class="co">#&gt; funcY1:time1:p4_ID -0.8527184 0.4494086 -1.8974232  5.791702e-02</span></span>
<span><span class="co">#&gt; funcY2:time1:p4_ID  0.5428615 0.4370084  1.2422222  2.143012e-01</span></span>
<span><span class="co">#&gt; funcY3:time1:p4_ID  4.8902225 0.4523511 10.8106795  1.649308e-26</span></span>
<span><span class="co">#&gt; funcY1:time2:p4_ID -2.4687264 0.4494086 -5.4932775  4.452542e-08</span></span>
<span><span class="co">#&gt; funcY2:time2:p4_ID  2.0225855 0.4370084  4.6282534  3.925934e-06</span></span>
<span><span class="co">#&gt; funcY3:time2:p4_ID  3.5620509 0.4523511  7.8745272  5.579900e-15</span></span>
<span><span class="co">#&gt; funcY1:time1:AV     2.5600468 0.9052026  2.8281478  4.728785e-03</span></span>
<span><span class="co">#&gt; funcY2:time1:AV     4.2827687 0.5293371  8.0908159  1.021049e-15</span></span>
<span><span class="co">#&gt; funcY3:time1:AV     6.4244491 0.9981712  6.4362198  1.531270e-10</span></span>
<span><span class="co">#&gt; funcY1:time2:AV    31.9456872 0.9052026 35.2911999 3.302215e-212</span></span>
<span><span class="co">#&gt; funcY2:time2:AV     2.8847960 0.5293371  5.4498281  5.669183e-08</span></span>
<span><span class="co">#&gt; funcY3:time2:AV    19.2291701 0.9981712 19.2644013  5.916403e-76</span></span></code></pre>
<p>Next we could examine the variance covariance matrices of the model.
These can be extracted from the model by either using the function <span class="R">getVarCov()</span> from the R package <span class="R">nlme</span> or by using the <span class="R">$</span> operator
(the components of a model in R can be viewed using <span class="R">View(model)</span>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getVarCov.html" class="external-link">getVarCov</a></span><span class="op">(</span><span class="va">modelFinal</span><span class="op">)</span></span>
<span></span>
<span><span class="va">modelFinal</span><span class="op">$</span><span class="va">vcov</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; $Multivariate</span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;         [,1]    [,2]    [,3]</span></span>
<span><span class="co">#&gt; [1,]  4.9095  2.3475 -1.3752</span></span>
<span><span class="co">#&gt; [2,]  2.3475  3.0305 -1.2650</span></span>
<span><span class="co">#&gt; [3,] -1.3752 -1.2650  4.0087</span></span>
<span><span class="co">#&gt;   Standard Deviations: 2.2157 1.7408 2.0022 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Repeated Measure`</span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;        [,1]   [,2]</span></span>
<span><span class="co">#&gt; [1,] 4.6330 1.4483</span></span>
<span><span class="co">#&gt; [2,] 1.4483 4.6330</span></span>
<span><span class="co">#&gt;   Standard Deviations: 2.1524 2.1524 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Combined</span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span></span>
<span><span class="co">#&gt; Y1:1  3.79520  1.18640  2.30980  0.72204 -1.17640 -0.36776</span></span>
<span><span class="co">#&gt; Y1:2  1.18640  3.79520  0.72204  2.30980 -0.36776 -1.17640</span></span>
<span><span class="co">#&gt; Y2:1  2.30980  0.72204  3.79520  1.18640 -1.37740 -0.43059</span></span>
<span><span class="co">#&gt; Y2:2  0.72204  2.30980  1.18640  3.79520 -0.43059 -1.37740</span></span>
<span><span class="co">#&gt; Y3:1 -1.17640 -0.36776 -1.37740 -0.43059  3.79520  1.18640</span></span>
<span><span class="co">#&gt; Y3:2 -0.36776 -1.17640 -0.43059 -1.37740  1.18640  3.79520</span></span>
<span><span class="co">#&gt;   Standard Deviations: 1.9481 1.9481 1.9481 1.9481 1.9481 1.9481</span></span></code></pre>
<p>An example of an interpretation that we can make from these variance
covariance matrices, is that the ecosystem functions <span class="R">Y1</span> and <span class="R">Y3</span> are negatively
correlated, therefore would likely result in trade-offs when trying to
maximise one over the other.</p>
<p>As multivariate repeated measures DI models can contain a large
number of fixed effects, they can be difficult to interpret from. Our
suggestion to circumvent this issue is to first predict from the model
for community designs of interest, using the predict() function, as seen
below, see vignette <a href="DImulti_prediction.html">prediction</a> for
further details on this.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comms</span> <span class="op">&lt;-</span> <span class="va">simMVRM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">21</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comms</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;    plot        p1        p2        p3 p4         Y1          Y2       Y3 time</span></span>
<span><span class="co">#&gt; 1     1 1.0000000 0.0000000 0.0000000  0 -3.2201614 -0.28424570 4.035400    1</span></span>
<span><span class="co">#&gt; 4     4 0.0000000 1.0000000 0.0000000  0  5.3908779  4.08309086 6.533252    1</span></span>
<span><span class="co">#&gt; 7     7 0.0000000 0.0000000 1.0000000  0  4.3064636  0.05409463 3.529927    1</span></span>
<span><span class="co">#&gt; 10   10 0.0000000 0.0000000 0.0000000  1 -0.9378472  0.30317782 6.102071    1</span></span>
<span><span class="co">#&gt; 21   21 0.3333333 0.3333333 0.3333333  0  1.7765221  2.99030627 5.650826    1</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">commPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">modelFinal</span>, newdata <span class="op">=</span> <span class="va">comms</span><span class="op">)</span></span>
<span><span class="va">commPred</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;    plot     Yvalue Ytype</span></span>
<span><span class="co">#&gt; 1     1 -1.3637130  Y1:1</span></span>
<span><span class="co">#&gt; 2     1  0.5944749  Y2:1</span></span>
<span><span class="co">#&gt; 3     1  0.9148420  Y3:1</span></span>
<span><span class="co">#&gt; 4     4  4.8096710  Y1:1</span></span>
<span><span class="co">#&gt; 5     4  4.5225251  Y2:1</span></span>
<span><span class="co">#&gt; 6     4  6.6751033  Y3:1</span></span>
<span><span class="co">#&gt; 7     7  2.7111060  Y1:1</span></span>
<span><span class="co">#&gt; 8     7 -0.4979964  Y2:1</span></span>
<span><span class="co">#&gt; 9     7  3.2877219  Y3:1</span></span>
<span><span class="co">#&gt; 10   10 -0.8527184  Y1:1</span></span>
<span><span class="co">#&gt; 11   10  0.5428615  Y2:1</span></span>
<span><span class="co">#&gt; 12   10  4.8902225  Y3:1</span></span>
<span><span class="co">#&gt; 13   21  2.9630332  Y1:1</span></span>
<span><span class="co">#&gt; 14   21  3.0631656  Y2:1</span></span>
<span><span class="co">#&gt; 15   21  5.9112410  Y3:1</span></span></code></pre>
<p>Then, with these predictions, we can employ summarising metrics, such
as a multifunctionality index, to summarise our findings while
maintaining the benefits of having modelled each ecosystem function
separately but simultaneously, alla Suter <em>et al</em> 2021. We could
also use these predictions to generate a plot/graph to display our
findings, such as a histogram, grouped bar chart, or ternary
diagram.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">commPred</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">Ytype</span>, y<span class="op">=</span><span class="va">Yvalue</span>, x<span class="op">=</span><span class="va">plot</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span>, stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="DImulti_workflow_files/figure-html/DImulti_modelFinal_grouped-1.png" alt="An example histogram" width="75%"></p>
<p>The R package, <span class="R">DImodelsVis</span>, is available on
CRAN and makes plotting DI models fit using the R packages <span class="R">DImodels</span> or <span class="R">DImodelsMulti</span> a
simple process.</p>
<h2>
References
</h2>
<p>Suter, M., Huguenin-Elie, O. and Lüscher, A., 2021. Multispecies for
multifunctions: combining four complementary species enhances
multifunctionality of sown grassland. Scientific Reports, 11(1),
p.3835.</p>
<p>Kirwan, L., Connolly, J., Finn, J.A., Brophy, C., Lüscher, A.,
Nyfeler, D. and Sebastià, M.T., 2009. Diversity-interaction modeling:
estimating contributions of species identities and interactions to
ecosystem function. Ecology, 90(8), pp.2032-2038.</p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laura Byrne, Rishabh Vishwakarma, Rafael de Andrade Moral, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
