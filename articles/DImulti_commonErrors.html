<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Common errors &amp; warnings encountered in DImulti() • DImodelsMulti</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Common errors &amp; warnings encountered in DImulti()">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsMulti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/DImulti_workflow.html">The recommended workflow of DImulti() analyses</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_onTheta.html">On the usage and estimation of theta in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_prediction.html">On prediction from multivariate repeated measures DI models</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_commonErrors.html">Common errors &amp; warnings encountered in DImulti()</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DI-LauraByrne/DImodelsMulti/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Common errors &amp; warnings encountered in DImulti()</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DI-LauraByrne/DImodelsMulti/blob/master/vignettes/DImulti_commonErrors.Rmd" class="external-link"><code>vignettes/DImulti_commonErrors.Rmd</code></a></small>
      <div class="d-none name"><code>DImulti_commonErrors.Rmd</code></div>
    </div>

    
    
<style type="text/css">
span.R {
  font-family: Courier New;
}

span.bad {
  color: red;
}

</style>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dimodels.com" class="external-link">DImodelsMulti</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dataBEL"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dataSWE"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simMV"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simRM"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simMVRM"</span><span class="op">)</span></span></code></pre></div>
<h2>
Incorrect argument specifications
</h2>
<p>The <span class="R">DImulti()</span> function has a long list of
possible parameters, which can make it difficult to ensure that all
arguments supplied are in the requested format. See below for an example
of each parameter and the included datasets, <span class="R">dataBEL</span>, <span class="R">dataSWE</span>, <span class="R">simMV</span>, <span class="R">simRM</span> and <span class="R">simMVRM</span>, for examples of dataset formatting.</p>
<h3>
<span class="R">y</span>
</h3>
<p>This is a required argument. It can be passed in three forms, using
either column names or indices:</p>
<ul>
<li><h4>
Univariate
</h4></li>
</ul>
<p>In this case, we pass a single name or index of a numerical column
containing the ecosystem function response value. See <span class="R">?dataSWE</span> for an example of a univariate dataset
suitable for use with DImulti().</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"YIELD"</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">9</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;       YIELD</span></span>
<span><span class="co">#&gt; 1  7.774822</span></span>
<span><span class="co">#&gt; 2 10.302994</span></span>
<span><span class="co">#&gt; 3 12.643246</span></span>
<span><span class="co">#&gt; 4 12.174211</span></span>
<span><span class="co">#&gt; 5  9.063782</span></span>
<span><span class="co">#&gt; 6  9.148516</span></span></code></pre>
<ul>
<li><h4>
Multivariate stacked
</h4></li>
</ul>
<p>In this case, we pass a single name or index of a numerical column
containing the ecosystem function response value. See <span class="R">?dataBEL</span> for an example of a multivariate stacked
dataset suitable for use with DImulti().</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">9</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;         Y</span></span>
<span><span class="co">#&gt; 1 104.156</span></span>
<span><span class="co">#&gt; 2 100.058</span></span>
<span><span class="co">#&gt; 3  87.996</span></span>
<span><span class="co">#&gt; 4  82.547</span></span>
<span><span class="co">#&gt; 5  89.801</span></span>
<span><span class="co">#&gt; 6  72.239</span></span></code></pre>
<ul>
<li><h4>
Multivariate wide
</h4></li>
</ul>
<p>In this case, we pass multiple names or indices of numerical columns
containing the ecosystem function response values. See <span class="R">?simMV</span> for an example of a multivariate wide dataset
suitable for use with DImulti().</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span>, <span class="st">"Y4"</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMV</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMV</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;          Y1       Y2         Y3         Y4</span></span>
<span><span class="co">#&gt; 1  1.880817 5.108158 -1.9712356  4.8247704</span></span>
<span><span class="co">#&gt; 2  7.103477 5.183822 -4.0598298  3.1094539</span></span>
<span><span class="co">#&gt; 3 -1.444736 6.900983  6.3342200  4.9055054</span></span>
<span><span class="co">#&gt; 4 -1.756776 4.784160  5.2155726  5.3583856</span></span>
<span><span class="co">#&gt; 5  5.311257 4.258924 -0.4694982 -2.3078377</span></span>
<span><span class="co">#&gt; 6  5.975319 3.148215  1.9509040 -0.6064387</span></span></code></pre>
<h3>
<span class="R">eco_func</span>
</h3>
<p>This is a required argument for multivariate data and excluded for
univariate data. It can be passed in two forms:</p>
<ul>
<li><h4>
Multivariate stacked
</h4></li>
</ul>
<p>In this case, we pass a vector of size two. The first index contains
a single column name for the ecosystem function response type, a factor,
the second contains the autocorrelation structure desired, either <span class="R">“UN”</span> or <span class="R">“CS”</span>. See <span class="R">?dataBEL</span> for an example of a multivariate stacked
dataset suitable for use with DImulti().</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var"</span>, <span class="st">"UN"</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;    Var</span></span>
<span><span class="co">#&gt; 1 Sown</span></span>
<span><span class="co">#&gt; 2 Weed</span></span>
<span><span class="co">#&gt; 3    N</span></span>
<span><span class="co">#&gt; 4 Sown</span></span>
<span><span class="co">#&gt; 5 Weed</span></span>
<span><span class="co">#&gt; 6    N</span></span></code></pre>
<ul>
<li><h4>
Multivariate wide
</h4></li>
</ul>
<p>In this case, we pass a vector of size two. The first index contains
the string “NA”, the second contains the autocorrelation structure
desired, either <span class="R">“UN”</span> or <span class="R">“CS”</span>. See <span class="R">?simMV</span> for an example
of a multivariate stacked dataset suitable for use with DImulti().</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"UN"</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMV</span><span class="op">)</span></span></code></pre></div>
<h3>
<span class="R">time</span>
</h3>
<p>This is a required argument for repeated measures data and excluded
for data taken at a single time point. It can be passed in the following
form:</p>
<ul>
<li><h4>
Repeated Measures
</h4></li>
</ul>
<p>In this case, we pass a vector of size two. The first index contains
a single column name for the time point reference, a factor, the second
contains the autocorrelation structure desired, either <span class="R">“UN”</span>, <span class="R">“CS”</span>, or <span class="R">“AR1”</span>. See <span class="R">?dataSWE</span> for an
example of a repeated measures dataset suitable for use with
DImulti().</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"AR1"</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;    YEARN</span></span>
<span><span class="co">#&gt; 1      1</span></span>
<span><span class="co">#&gt; 49     2</span></span>
<span><span class="co">#&gt; 97     3</span></span>
<span><span class="co">#&gt; 2      1</span></span>
<span><span class="co">#&gt; 50     2</span></span>
<span><span class="co">#&gt; 98     3</span></span></code></pre>
<h3>
<span class="R">unit_IDs</span>
</h3>
<p>This is a required argument for any data.</p>
<p>It can be passed a column name or index, referencing a unique
reference for each experimental unit, used for grouping responses from
different ecosystem functions or time points.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>unit_IDs <span class="op">=</span> <span class="st">"plot"</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>unit_IDs <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;   plot</span></span>
<span><span class="co">#&gt; 1    1</span></span>
<span><span class="co">#&gt; 2    2</span></span>
<span><span class="co">#&gt; 3    3</span></span>
<span><span class="co">#&gt; 4    4</span></span>
<span><span class="co">#&gt; 5    5</span></span>
<span><span class="co">#&gt; 6    6</span></span></code></pre>
<h3>
<span class="R">prop</span>
</h3>
<p>This is a required argument for any data.</p>
<p>It can be passed as a vector of column names or indices, referencing
the (numerical) initial proportions of any species included in the
experimental design. In the event that a species is included as a factor
as opposed to a numerical value, e.g. if it only appears at values 0 or
1, only the numerical species should be included here, while the factor
species is passed through the <span class="R">extra_fixed</span>
parameter. A warning will be printed to the console warning the user of
not meeting the simplex requirement.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>unit_IDs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>unit_IDs <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;   p1 p2 p3 p4</span></span>
<span><span class="co">#&gt; 1  1  0  0  0</span></span>
<span><span class="co">#&gt; 2  1  0  0  0</span></span>
<span><span class="co">#&gt; 3  1  0  0  0</span></span>
<span><span class="co">#&gt; 4  0  1  0  0</span></span>
<span><span class="co">#&gt; 5  0  1  0  0</span></span>
<span><span class="co">#&gt; 6  0  1  0  0</span></span></code></pre>
<h3>
<span class="R">data</span>
</h3>
<p>This is a required argument for any data.</p>
<p>This argument should be a dataframe or tibble which contains all
columns referenced in the <span class="R">DImulti()</span> call. There
are some restrictions on columns names allowed in this dataset. An error
will be printed to the console to inform a user of name changes
required.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span><span class="va">...</span>, data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span><span class="va">...</span>, data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;   plot p1 p2 p3 p4         Y1          Y2        Y3 time</span></span>
<span><span class="co">#&gt; 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1</span></span>
<span><span class="co">#&gt; 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1</span></span>
<span><span class="co">#&gt; 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1</span></span>
<span><span class="co">#&gt; 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1</span></span>
<span><span class="co">#&gt; 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1</span></span>
<span><span class="co">#&gt; 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1</span></span></code></pre>
<h3>
<span class="R">DImodel</span>
</h3>
<p>This is a required argument for any data.</p>
<p>This argument should be a single string selected from the list of
included interaction structures: <span class="R">“STR”</span>, <span class="R">“ID”</span>, <span class="R">“FULL”</span>, <span class="R">“E”</span>, <span class="R">“AV”</span>, <span class="R">“ADD”</span>, <span class="R">“FG”</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>DImodel <span class="op">=</span> <span class="st">"FULL"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>DImodel <span class="op">=</span> <span class="st">"AV"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<h3>
<span class="R">FG</span>
</h3>
<p>This is a required argument if the argument <span class="R">“FG”</span> is passed through <span class="R">DImodel</span>
and can be excluded otherwise.</p>
<p>This argument should be a vector of strings, of the same length as
<span class="R">prop</span>, which maps each species in the experiment
to a functional grouping.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>, </span>
<span>        FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grass"</span>, <span class="st">"Grass"</span>, <span class="st">"Legume"</span>, <span class="st">"Legume"</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span></code></pre></div>
<h3>
<span class="R">ID</span>
</h3>
<p>This is an optional argument.</p>
<p>This argument should be a vector of strings, of the same length as
<span class="R">prop</span>, which maps each species in the experiment
to a identity grouping, assuming functional redundancy between
within-group species for their ID effects, this grouping does not affect
interactions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span>, ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grass"</span>, <span class="st">"Grass"</span>, <span class="st">"Legume"</span>, <span class="st">"Legume"</span><span class="op">)</span>, </span>
<span>        <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span></code></pre></div>
<h3>
<span class="R">extra_fixed</span>
</h3>
<p>This is an optional argument.</p>
<p>This parameter can be passed a formula of any additional fixed
effects to be included, e.g.  treatments. These effects can be easily
crossed with the automatic DI model formula by prefacing the formula
passed with <span class="R">1:</span> or <span class="R">1*</span>. See
<span class="R">?dataSWE</span> for a dataset containing treatments
suitable for use with <span class="R">DImulti()</span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>extra_fixed <span class="op">=</span> <span class="op">~</span><span class="va">DENS</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>extra_fixed <span class="op">=</span> <span class="op">~</span><span class="va">DENS</span> <span class="op">+</span> <span class="va">TREAT</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>extra_fixed <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">*</span><span class="va">DENS</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>extra_fixed <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">DENS</span><span class="op">+</span><span class="va">TREAT</span><span class="op">)</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>extra_fixed <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">:</span><span class="va">DENS</span><span class="op">:</span><span class="va">TREAT</span>, <span class="va">...</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt;   DENS TREAT</span></span>
<span><span class="co">#&gt; 1 High     1</span></span>
<span><span class="co">#&gt; 2 High     1</span></span>
<span><span class="co">#&gt; 3 High     1</span></span>
<span><span class="co">#&gt; 4 High     1</span></span>
<span><span class="co">#&gt; 5 High     1</span></span>
<span><span class="co">#&gt; 6 High     1</span></span></code></pre>
<h3>
<span class="R">estimate_theta</span>
</h3>
<p>This is an optional argument.</p>
<p>This parameter can be passed a boolean value (<span class="R&gt;TRUE&lt;/span&gt; or &lt;span class=" r="">FALSE</span>),
indicating whether the user wants the function to use profile likelihood
to estimate values for the non-linear parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
Defaults to &lt;span class=“R&gt;FALSE, indicating that
estimation will not occur, instead fixed values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
will be used. If <span class="R">“STR”</span> or <span class="R">“ID”</span> was passed through the parameter <span class="R">DImodel</span>, then setting <span class="R">estimate_theta =
TRUE</span> will cause a warning to be printed to the console, as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
only applies to interaction terms, which do not exist for those
options.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>estimate_theta <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>estimate_theta <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<h3>
<span class="R">theta</span>
</h3>
<p>This is an optional argument.</p>
<p>This argument should contain numerical values representing the
non-linear parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
which will be applied as a power to the products of pairs of species in
the interaction terms of the model. A single value may be passed, which
will be applied to each ecosystem function, or a different value may be
passed for each ecosystem function. If <span class="R">“STR”</span> or
<span class="R">“ID”</span> was passed through the parameter <span class="R">DImodel</span>, then setting a non-1 value for <span class="R">theta</span> will cause a warning to be printed to the
console, as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
only applies to interaction terms, which do not exist for those
options.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<h3>
<span class="R">method</span>
</h3>
<p>This is an optional argument.</p>
<p>This parameter is used to change the estimation method used by <span class="R">DImulti()</span>. The options are <span class="R">“REML”</span>, referring to restricted maximum likelihood, and
<span class="R">“ML”</span>, referring to maximum likelihood. Defaults
to <span class="R">“REML”</span>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"REML"</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"ML"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<h2>
Singular fit
</h2>
<p>A singular fit error, thrown by <span class="R">nlme::gls()</span>
when fitting the model, occurs when an element with value of exactly
zero exists in the fixed effect variance covariance matrix of the model.
This usually caused by rank deficiency in the model, i.e. two terms
explaining the same variance. The fix is usually to simplify/change the
fixed effect terms, be it the interactions structure, treatment terms,
or theta values. To aid in this change, the fixed effect formula and any
estimated theta values are printed to the console with the error.</p>
<p>As an example, we use the dataset <span class="R">dataSWE&lt;/span,
which is included in this package.</span></p>
<p><span class="bad">XXDO NOT
RUNXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, y <span class="op">=</span> <span class="st">"YIELD"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"PLOT"</span>, data <span class="op">=</span> <span class="va">dataSWE</span>, </span>
<span>        DImodel <span class="op">=</span> <span class="st">"ID"</span>, extra_fixed <span class="op">=</span> <span class="op">~</span><span class="va">DENS</span><span class="op">+</span><span class="va">TREAT</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Note: </span></span>
<span><span class="co">#&gt; Method Used = REML </span></span>
<span><span class="co">#&gt; Correlation Structure Used = CS</span></span>
<span><span class="co">#&gt;  Identity Model</span></span>
<span><span class="co">#&gt; Theta value(s) = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generalized least squares fit by REML</span></span>
<span><span class="co">#&gt;   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID) + DENS + TREAT) </span></span>
<span><span class="co">#&gt;       AIC       BIC    logLik </span></span>
<span><span class="co">#&gt;  538.6412  595.3668 -249.3206 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Repeated Measure Correlation Structure: Compound symmetry</span></span>
<span><span class="co">#&gt;  Formula: ~0 | PLOT </span></span>
<span><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span><span class="co">#&gt;       Rho </span></span>
<span><span class="co">#&gt; 0.8454513 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Fixed Effect Coefficients</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  Beta      Std. Error   t-value   p-value     Signif </span></span>
<span><span class="co">#&gt; ---------------  --------  -----------  --------  ----------  -------</span></span>
<span><span class="co">#&gt; YEARN1:G1_ID     +9.481    1.019        9.306     5.336e-16   ***    </span></span>
<span><span class="co">#&gt; YEARN2:G1_ID     +7.821    1.019        7.677     3.922e-12   ***    </span></span>
<span><span class="co">#&gt; YEARN3:G1_ID     +6.402    1.019        6.284     4.935e-09   ***    </span></span>
<span><span class="co">#&gt; YEARN1:G2_ID     +10.554   1.019        10.359    1.441e-18   ***    </span></span>
<span><span class="co">#&gt; YEARN2:G2_ID     +10.288   1.019        10.098    6.303e-18   ***    </span></span>
<span><span class="co">#&gt; YEARN3:G2_ID     +8.960    1.019        8.794     9.136e-15   ***    </span></span>
<span><span class="co">#&gt; YEARN1:L1_ID     +10.648   1.019        10.451    8.567e-19   ***    </span></span>
<span><span class="co">#&gt; YEARN2:L1_ID     +9.751    1.019        9.571     1.212e-16   ***    </span></span>
<span><span class="co">#&gt; YEARN3:L1_ID     +6.909    1.019        6.781     4.136e-10   ***    </span></span>
<span><span class="co">#&gt; YEARN1:L2_ID     +9.230    1.019        9.060     2.105e-15   ***    </span></span>
<span><span class="co">#&gt; YEARN2:L2_ID     +9.922    1.019        9.739     4.738e-17   ***    </span></span>
<span><span class="co">#&gt; YEARN3:L2_ID     +8.798    1.019        8.635     2.195e-14   ***    </span></span>
<span><span class="co">#&gt; YEARN1:DENSLow   -0.526    0.687        -0.765    0.4454             </span></span>
<span><span class="co">#&gt; YEARN2:DENSLow   -0.286    0.687        -0.417    0.6774             </span></span>
<span><span class="co">#&gt; YEARN3:DENSLow   +0.044    0.687        0.064     0.9488             </span></span>
<span><span class="co">#&gt; YEARN1:TREAT2    +2.218    0.709        3.128     0.002183    **     </span></span>
<span><span class="co">#&gt; YEARN2:TREAT2    +1.900    0.709        2.679     0.008368    **     </span></span>
<span><span class="co">#&gt; YEARN3:TREAT2    +1.524    0.709        2.148     0.03359     *      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of freedom: 144 total; 126 residual</span></span>
<span><span class="co">#&gt; Residual standard error: 2.378508 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;        1      2      3</span></span>
<span><span class="co">#&gt; 1 5.6573 4.7830 4.7830</span></span>
<span><span class="co">#&gt; 2 4.7830 5.6573 4.7830</span></span>
<span><span class="co">#&gt; 3 4.7830 4.7830 5.6573</span></span>
<span><span class="co">#&gt;   Standard Deviations: 2.3785 2.3785 2.3785</span></span></code></pre>
<span class="bad">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span>
As we include no theta values or interaction terms, and use the simple
structure <span class="R">“CS”</span>, compound symmetry, for our
repeated measure, the only complication in this model is the inclusion
of the two treatment terms, <span class="R">DENS</span> and <span class="R">TREAT</span>. When multiple treatments are included, it is
usually good to check that one cannot be inferred from the other,
e.g. if <span class="R">DENS = High</span> then we know that <span class="R">TREAT = 1</span>. Luckily this is not the case here.
<pre class="r-output"><code><span><span class="co">#&gt;    DENS TREAT</span></span>
<span><span class="co">#&gt; 1  High     1</span></span>
<span><span class="co">#&gt; 16  Low     1</span></span>
<span><span class="co">#&gt; 31 High     2</span></span>
<span><span class="co">#&gt; 40  Low     2</span></span></code></pre>
<p>Instead, we change the formatting of our formula, from creating
intercepts to crossing the treatment with our ID effects, but not each
other.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, y <span class="op">=</span> <span class="st">"YIELD"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"PLOT"</span>, data <span class="op">=</span> <span class="va">dataSWE</span>, </span>
<span>        DImodel <span class="op">=</span> <span class="st">"ID"</span>, extra_fixed <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">DENS</span><span class="op">+</span><span class="va">TREAT</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Note: </span></span>
<span><span class="co">#&gt; Method Used = REML </span></span>
<span><span class="co">#&gt; Correlation Structure Used = CS</span></span>
<span><span class="co">#&gt;  Identity Model</span></span>
<span><span class="co">#&gt; Theta value(s) = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generalized least squares fit by REML</span></span>
<span><span class="co">#&gt;   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID):(DENS + TREAT)) </span></span>
<span><span class="co">#&gt;       AIC       BIC    logLik </span></span>
<span><span class="co">#&gt;  519.2773  621.1983 -221.6386 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Repeated Measure Correlation Structure: Compound symmetry</span></span>
<span><span class="co">#&gt;  Formula: ~0 | PLOT </span></span>
<span><span class="co">#&gt;  Parameter estimate(s):</span></span>
<span><span class="co">#&gt;       Rho </span></span>
<span><span class="co">#&gt; 0.8390275 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Table: Fixed Effect Coefficients</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                         Beta      Std. Error   t-value   p-value     Signif </span></span>
<span><span class="co">#&gt; ----------------------  --------  -----------  --------  ----------  -------</span></span>
<span><span class="co">#&gt; YEARN1:G1_ID:DENSHigh   +9.308    1.623        5.735     8.968e-08   ***    </span></span>
<span><span class="co">#&gt; YEARN2:G1_ID:DENSHigh   +7.706    1.623        4.748     6.341e-06   ***    </span></span>
<span><span class="co">#&gt; YEARN3:G1_ID:DENSHigh   +6.561    1.623        4.043     9.94e-05    ***    </span></span>
<span><span class="co">#&gt; YEARN1:G1_ID:DENSLow    +8.859    1.623        5.459     3.083e-07   ***    </span></span>
<span><span class="co">#&gt; YEARN2:G1_ID:DENSLow    +7.222    1.623        4.450     2.096e-05   ***    </span></span>
<span><span class="co">#&gt; YEARN3:G1_ID:DENSLow    +6.073    1.623        3.742     0.0002941   ***    </span></span>
<span><span class="co">#&gt; YEARN1:G1_ID:TREAT2     +2.506    1.937        1.294     0.1985             </span></span>
<span><span class="co">#&gt; YEARN2:G1_ID:TREAT2     +2.356    1.937        1.217     0.2264             </span></span>
<span><span class="co">#&gt; YEARN3:G1_ID:TREAT2     +1.752    1.937        0.904     0.3678             </span></span>
<span><span class="co">#&gt; YEARN1:G2_ID:DENSHigh   +9.207    1.623        5.673     1.188e-07   ***    </span></span>
<span><span class="co">#&gt; YEARN2:G2_ID:DENSHigh   +8.955    1.623        5.518     2.377e-07   ***    </span></span>
<span><span class="co">#&gt; YEARN3:G2_ID:DENSHigh   +8.093    1.623        4.986     2.361e-06   ***    </span></span>
<span><span class="co">#&gt; YEARN1:G2_ID:DENSLow    +9.191    1.623        5.663     1.242e-07   ***    </span></span>
<span><span class="co">#&gt; YEARN2:G2_ID:DENSLow    +9.301    1.623        5.731     9.142e-08   ***    </span></span>
<span><span class="co">#&gt; YEARN3:G2_ID:DENSLow    +8.016    1.623        4.939     2.882e-06   ***    </span></span>
<span><span class="co">#&gt; YEARN1:G2_ID:TREAT2     +4.548    1.937        2.348     0.02068     *      </span></span>
<span><span class="co">#&gt; YEARN2:G2_ID:TREAT2     +4.067    1.937        2.100     0.03807     *      </span></span>
<span><span class="co">#&gt; YEARN3:G2_ID:TREAT2     +3.502    1.937        1.808     0.0734      +      </span></span>
<span><span class="co">#&gt; YEARN1:L1_ID:DENSHigh   +11.068   1.623        6.820     5.463e-10   ***    </span></span>
<span><span class="co">#&gt; YEARN2:L1_ID:DENSHigh   +10.204   1.623        6.287     7.007e-09   ***    </span></span>
<span><span class="co">#&gt; YEARN3:L1_ID:DENSHigh   +6.909    1.623        4.257     4.429e-05   ***    </span></span>
<span><span class="co">#&gt; YEARN1:L1_ID:DENSLow    +9.914    1.623        6.108     1.619e-08   ***    </span></span>
<span><span class="co">#&gt; YEARN2:L1_ID:DENSLow    +9.188    1.623        5.661     1.251e-07   ***    </span></span>
<span><span class="co">#&gt; YEARN3:L1_ID:DENSLow    +7.157    1.623        4.410     2.453e-05   ***    </span></span>
<span><span class="co">#&gt; YEARN1:L1_ID:TREAT2     +1.993    1.937        1.029     0.3058             </span></span>
<span><span class="co">#&gt; YEARN2:L1_ID:TREAT2     +1.713    1.937        0.884     0.3785             </span></span>
<span><span class="co">#&gt; YEARN3:L1_ID:TREAT2     +1.305    1.937        0.674     0.502              </span></span>
<span><span class="co">#&gt; YEARN1:L2_ID:DENSHigh   +10.330   1.623        6.365     4.847e-09   ***    </span></span>
<span><span class="co">#&gt; YEARN2:L2_ID:DENSHigh   +10.918   1.623        6.727     8.564e-10   ***    </span></span>
<span><span class="co">#&gt; YEARN3:L2_ID:DENSHigh   +9.505    1.623        5.857     5.167e-08   ***    </span></span>
<span><span class="co">#&gt; YEARN1:L2_ID:DENSLow    +9.847    1.623        6.068     1.956e-08   ***    </span></span>
<span><span class="co">#&gt; YEARN2:L2_ID:DENSLow    +10.926   1.623        6.732     8.364e-10   ***    </span></span>
<span><span class="co">#&gt; YEARN3:L2_ID:DENSLow    +9.998    1.623        6.161     1.269e-08   ***    </span></span>
<span><span class="co">#&gt; YEARN1:L2_ID:TREAT2     -0.173    1.937        -0.089    0.9289             </span></span>
<span><span class="co">#&gt; YEARN2:L2_ID:TREAT2     -0.537    1.937        -0.277    0.7822             </span></span>
<span><span class="co">#&gt; YEARN3:L2_ID:TREAT2     -0.464    1.937        -0.240    0.8111             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of freedom: 144 total; 108 residual</span></span>
<span><span class="co">#&gt; Residual standard error: 2.483701 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Marginal variance covariance matrix</span></span>
<span><span class="co">#&gt;        1      2      3</span></span>
<span><span class="co">#&gt; 1 6.1688 5.1758 5.1758</span></span>
<span><span class="co">#&gt; 2 5.1758 6.1688 5.1758</span></span>
<span><span class="co">#&gt; 3 5.1758 5.1758 6.1688</span></span>
<span><span class="co">#&gt;   Standard Deviations: 2.4837 2.4837 2.4837</span></span></code></pre>
<p>Which has resolved our issue.</p>
<p>We show another example using the multivariate dataset <span class="R">dataBEL</span> and estimating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
We would first set <span class="R">theta = 1</span> and use model
selection to choose an appropriate interaction structure, which gives us
the following model, with a functional group structure:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="st">"Y"</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var"</span>, <span class="st">"UN"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dataBEL</span>,</span>
<span>                  FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grass"</span>, <span class="st">"Grass"</span>, <span class="st">"Leg"</span>, <span class="st">"Leg"</span><span class="op">)</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>, extra_fixed <span class="op">=</span> <span class="op">~</span><span class="va">Density</span>, </span>
<span>                  method <span class="op">=</span> <span class="st">"ML"</span>, theta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<h2>
Comparing models: ML vs REML
</h2>
<p>The optional parameter <span class="R">method</span> in the function
<span class="R">DImulti()</span> allows a user to change the estimation
method used, between the default <span class="R">“REML”</span>,
restricted maximum likelihood, and <span class="R">“ML”</span>, maximum
likelihood.</p>
<p><span class="R">“REML”</span> was chosen as the default as it
provides unbiased estimates, as opposed to <span class="R">“ML”</span>,
however, <span class="R">“REML”</span> is not appropriate for use with
model comparison where fixed effects vary between models, as we can see
from the following warning message:</p>
<p><span class="bad">XXDO NOT
RUNXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="st">"Y"</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var"</span>, <span class="st">"UN"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dataBEL</span>,</span>
<span>                  FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grass"</span>, <span class="st">"Grass"</span>, <span class="st">"Leg"</span>, <span class="st">"Leg"</span><span class="op">)</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>, </span>
<span>                  method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DImulti.html">DImulti</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="st">"Y"</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var"</span>, <span class="st">"UN"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dataBEL</span>,</span>
<span>                  FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grass"</span>, <span class="st">"Grass"</span>, <span class="st">"Leg"</span>, <span class="st">"Leg"</span><span class="op">)</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>, extra_fixed <span class="op">=</span> <span class="op">~</span><span class="va">Density</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">model1</span>, <span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<pre class="r-output"><code><span><span class="co">#&gt; Warning in nlme::anova.lme(object = model1, model2): fitted objects with</span></span>
<span><span class="co">#&gt; different fixed effects. REML comparisons are not meaningful.</span></span></code></pre>
<pre class="r-output"><code><span><span class="co">#&gt;        Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span><span class="co">#&gt; model1     1 27 501.7634 562.0843 -223.8817                        </span></span>
<span><span class="co">#&gt; model2     2 30 488.0671 553.7567 -214.0335 1 vs 2 19.69631   2e-04</span></span></code></pre>
<p><span class="bad">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span></p>
<p>In this case, we should use <span class="R">“ML”</span> to fit the
models for comparison, then refit the chosen model using <span class="R">“REML”</span>, for the unbiased estimates.</p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laura Byrne, Rishabh Vishwakarma, Rafael de Andrade Moral, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
