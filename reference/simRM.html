<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The simulated repeated measures "simRM" dataset — simRM • DImodelsMulti</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The simulated repeated measures " simrm dataset><meta name="description" content="The simRM dataset was simulated from a repeated measures DI model. It contains 116 plots
comprising of four species that vary in proportions (p1 - p4). There is one simulated
response (Y), taken at three differing time points, recorded in a stacked data format (one
row per response value). The data was simulated assuming that there were existing covariances
between the responses and both species identity and species
interaction effects were present."><meta property="og:description" content="The simRM dataset was simulated from a repeated measures DI model. It contains 116 plots
comprising of four species that vary in proportions (p1 - p4). There is one simulated
response (Y), taken at three differing time points, recorded in a stacked data format (one
row per response value). The data was simulated assuming that there were existing covariances
between the responses and both species identity and species
interaction effects were present."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsMulti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DImulti_workflow.html">The recommended workflow of DImulti() analyses</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_onTheta.html">On the usage and estimation of theta in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_prediction.html">On prediction from multivariate repeated measures DI models</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_commonErrors.html">Common errors &amp; warnings encountered in DImulti()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DI-LauraByrne/DImodelsMulti/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The simulated repeated measures "simRM" dataset</h1>

      <div class="d-none name"><code>simRM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>simRM</code> dataset was simulated from a repeated measures DI model. It contains 116 plots
comprising of four species that vary in proportions (<code>p1</code> - <code>p4</code>). There is one simulated
response (<code>Y</code>), taken at three differing time points, recorded in a stacked data format (one
row per response value). The data was simulated assuming that there were existing covariances
between the responses and both species identity and species
interaction effects were present.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simRM"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 384 observations on the following seven variables.</p><dl><dt><code>plot</code></dt>
<dd><p>A numeric vector identifying each unique experimental unit</p></dd>

    <dt><code>p1</code></dt>
<dd><p>A numeric vector indicating the initial proportion of species 1</p></dd>

    <dt><code>p2</code></dt>
<dd><p>A numeric vector indicating the initial proportion of species 2</p></dd>

    <dt><code>p3</code></dt>
<dd><p>A numeric vector indicating the initial proportion of species 3</p></dd>

    <dt><code>p4</code></dt>
<dd><p>A numeric vector indicating the initial proportion of species 4</p></dd>

    <dt><code>Y</code></dt>
<dd><p>A numeric vector giving the simulated response for an ecosystem function</p></dd>

    <dt><code>time</code></dt>
<dd><p>A three-level factor indicating the time point at which the response <code>Y</code> was recorded</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>What are Diversity-Interactions (DI) models?</b></p>
<p>Diversity-Interactions (DI) models (Kirwan <em>et al.</em>, 2009) are a set of tools for analysing and
interpreting data from experiments that explore the effects of species diversity on community-level
responses. We strongly recommend that users read the short introduction to Diversity-Interactions
models (available at: <code><a href="https://rdrr.io/pkg/DImodels/man/DImodels-package.html" class="external-link">DImodels</a></code>). Further information on
Diversity-Interactions models is also available in Kirwan <em>et al.</em>, 2009 and
Connolly <em>et al.</em>, 2013.</p>
<p><b>Parameter values for the simulation</b></p>
<p>Repeated measures DI models take the general form of:</p>
<p>$${y}_{mt} = {Identities}_{mt} + {Interactions}_{mt} + {Structures}_{t} + {\epsilon}_{mt}$$</p>
<p>where \(y\) are the community-level responses, the \(Identities\) are the effects of species
identities for each response and enter the model as individual species proportions measured at the
beginning of the time period, the \(Interactions\) are the interactions among the species
proportions, while \(Structures\) include other experimental structures such as blocks,
treatments, or density.</p>
<p>The dataset <code>simRM</code> was simulated with:</p><ul><li><p>identity effects for the four species for each time:</p><ul><li><p>time1 = 4.1, 2.1, 3.6, 4.8</p></li>
<li><p>time2 = 2.3, 2.4, 5.1, 5.0</p></li>
<li><p>time3 = 0.7, 2.3, 6.5, 5.9</p></li>
</ul></li>
<li><p>additive interaction effects for each time:</p><ul><li><p>time1 = 3.3, 4.0, 1.3, 5.2</p></li>
<li><p>time2 = 3.6, 4.5, 0.5, 6.5</p></li>
<li><p>time3 = 4.5, 5.2, 0.6, 7.8</p></li>
</ul></li>
<li><p>\(\epsilon\) assumed to have a multivaraite normal distribution with mean 0 and Sigma:</p><table class="table table"><tr><td></td><td></td><td></td><td></td><td></td></tr></table></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dooley, A., Isbell, F., Kirwan, L., Connolly, J., Finn, J.A. and Brophy, C., 2015. <br>
Testing the effects of diversity on ecosystem multifunctionality using a multivariate model. <br>
Ecology Letters, 18(11), pp.1242-1251. <br></p>
<p>Finn, J.A., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, A., Baadshaug, O.H.,
Belanger, G., Black, A., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, I.,
Elgersma, A., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, A., Golinska, B., Golinski, P.,
Grieu, P., Gustavsson, A.M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z.,
Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., and Lüscher, A., 2013. <br>
Ecosystem function enhanced by combining four functional types of plant species in intensively
managed grassland mixtures: a 3-year continental-scale field experiment.<br>
Journal of Applied Ecology, 50(2), pp.365-375 .<br></p>
<p>Kirwan, L., Connolly, J., Finn, J.A., Brophy, C., Luscher, A., Nyfeler, D. and Sebastia, M.T.,
2009. <br>
Diversity-interaction modeling: estimating contributions of species identities and interactions
to ecosystem function. <br>
Ecology, 90(8), pp.2032-2038. <br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">###################################################################################################</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;STYLE type='text/css' scoped&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;/STYLE&gt;</span>
<span class="r-in"><span><span class="co">## Modelling Example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For a more thorough example of the workflow of this package, please see vignette</span></span></span>
<span class="r-in"><span><span class="co"># DImulti_workflow using the following code:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># vignette("DImulti_workflow")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simRM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   plot p1 p2 p3 p4        Y time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1  1  0  0  0 4.763873    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2  1  0  0  0 4.762302    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3  0  1  0  0 2.413846    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4  0  1  0  0 1.929837    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5  0  0  1  0 2.750093    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    6  0  0  1  0 5.071534    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We call DImulti() to fit a series of models, with increasing complexity, and test whether the</span></span></span>
<span class="r-in"><span><span class="co"># additional terms are worth keeping.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We begin with an ID DI model, ensuring to use method = "ML" as we will be comparing fixed effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">RMmodel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">ML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">AR1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Identity Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span>1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by maximum likelihood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: Y ~ 0 + time:((p1_ID + p2_ID + p3_ID + p4_ID)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1316.8028 1370.7336 -644.4014 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: AR(1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 + as.numeric(time) | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Phi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2206503 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Beta      Std. Error   t-value   p-value     Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------  --------  -----------  --------  ----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p1_ID   +6.151    0.482        12.765    1.076e-30   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p1_ID   +5.320    0.482        11.042    2.154e-24   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p1_ID   +3.443    0.482        7.145     5.624e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p2_ID   +4.794    0.504        9.513     3.724e-19   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p2_ID   +6.381    0.504        12.662    2.614e-30   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p2_ID   +5.137    0.504        10.192    1.957e-21   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p3_ID   +4.791    0.431        11.124    1.101e-24   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p3_ID   +7.442    0.431        17.277    2.612e-48   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p3_ID   +7.227    0.431        16.779    2.512e-46   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p4_ID   +7.099    0.459        15.457    4.348e-41   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p4_ID   +10.485   0.459        22.830    2.578e-70   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p4_ID   +9.100    0.459        19.814    1.988e-58   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 348 total; 336 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.567414 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1       2       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.45680 0.54209 0.11961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.54209 2.45680 0.54209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.11961 0.54209 2.45680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.5674 1.5674 1.5674 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can simplify the above model by grouping the ID effect terms into two categories, G1 and G2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                   ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"G2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can compare the two models by calling the anova function to perform a likelihood ratio test</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">RMmodel</span>, <span class="va">RMmodel_ID</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel        1 14 1316.803 1370.734 -644.4014                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel_ID     2  8 1344.644 1375.462 -664.3221 1 vs 2 39.84144  &lt;.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As the p-value &lt; an alpha value of 0.05, we reject the null hypthesis that the extra terms are</span></span></span>
<span class="r-in"><span><span class="co"># equal to zero, therefore we continue with the larger model.</span></span></span>
<span class="r-in"><span><span class="co"># We can confirm this result by selecting the model with the lower AIC value.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">RMmodel</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">RMmodel_ID</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1316.803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1344.644</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next, we include the simplest interaction structure available in this package, "AV", which adds</span></span></span>
<span class="r-in"><span><span class="co"># a single extra term per ecosystem function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_AV</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">RMmodel</span>, <span class="va">RMmodel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel        1 14 1316.803 1370.734 -644.4014                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel_AV     2 17 1255.744 1321.232 -610.8722 1 vs 2 67.05833  &lt;.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Once again, we select the more complex model.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># We can continue increasing the complexity of the interaction structure in the same fashion, this</span></span></span>
<span class="r-in"><span><span class="co"># time we elect to use the additive interaction structure</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_ADD</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">RMmodel_AV</span>, <span class="va">RMmodel_ADD</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel_AV      1 17 1255.744 1321.232 -610.8722                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel_ADD     2 26 1236.971 1337.128 -592.4856 1 vs 2 36.77332  &lt;.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We continue with the additive interactions structure, the next interaction structure to test</span></span></span>
<span class="r-in"><span><span class="co"># functional group interactions, is not nested with our additive model, so we compare th two using</span></span></span>
<span class="r-in"><span><span class="co"># information criterion. In this case we choose to use AICc, to better penalise extra terms, as AIC</span></span></span>
<span class="r-in"><span><span class="co"># becomes biased towards the more complex model as parameters numbers increase.</span></span></span>
<span class="r-in"><span><span class="co"># The functional group strcuture requires an additional parameter, FG, to specify groups.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_FG</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>,</span></span>
<span class="r-in"><span>                   FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"G2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="AICc.html">AICc</a></span><span class="op">(</span><span class="va">RMmodel_ADD</span><span class="op">)</span>; <span class="fu"><a href="AICc.html">AICc</a></span><span class="op">(</span><span class="va">RMmodel_FG</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1243.351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1263.574</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In this case, we choose the lower valued model, which is the additive structure.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># The last interaction structure to test is the full pairwise model. Which we can see is not worth</span></span></span>
<span class="r-in"><span><span class="co"># the extra terms. So our final interaction structure chosen is additive.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_FULL</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"FULL"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">RMmodel_ADD</span>, <span class="va">RMmodel_FULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel_ADD      1 26 1236.971 1337.128 -592.4856                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMmodel_FULL     2 32 1237.600 1360.870 -586.7999 1 vs 2 11.37142  0.0776</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally, we can also increase the model complexity via the inclusion of the non-linear parameter</span></span></span>
<span class="r-in"><span><span class="co"># theta, which we can estimate, or select a value for. We also choose to estimate using the "REML"</span></span></span>
<span class="r-in"><span><span class="co"># method as we will do no further fixed effect model comparisons</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"AR1"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                      prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>,</span></span>
<span class="r-in"><span>                      estimate_theta <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">RMmodel_theta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">REML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">AR1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Additive Interactions Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta estimate(s) = </span>0.9991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by REML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: Y ~ 0 + time:((p1_ID + p2_ID + p3_ID + p4_ID + p1_add + p2_add +      p3_add + p4_add)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1203.6852 1301.9845 -575.8426 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: AR(1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 + as.numeric(time) | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Phi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.01150876 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Beta      Std. Error   t-value   p-value     Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------  --------  -----------  --------  ----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p1_ID    +4.882    0.817        5.975     6.07e-09    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p1_ID    +4.292    0.817        5.252     2.727e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p1_ID    +1.231    0.817        1.507     0.1328             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p2_ID    +2.119    0.815        2.600     0.009763    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p2_ID    +4.398    0.815        5.395     1.326e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p2_ID    +2.290    0.815        2.808     0.00528     **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p3_ID    +3.657    0.531        6.882     3.068e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p3_ID    +7.043    0.531        13.252    2.505e-32   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p3_ID    +6.442    0.531        12.121    3.868e-28   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p4_ID    +4.988    0.819        6.094     3.128e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p4_ID    +5.933    0.819        7.248     3.125e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p4_ID    +4.975    0.819        6.078     3.423e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p1_add   +2.245    1.835        1.224     0.2219             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p1_add   +2.006    1.835        1.093     0.2751             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p1_add   +4.825    1.835        2.630     0.008949    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p2_add   +5.517    1.866        2.956     0.00334     **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p2_add   +3.227    1.866        1.729     0.08469     +      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p2_add   +5.291    1.866        2.835     0.004869    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p3_add   +2.354    1.444        1.630     0.1041             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p3_add   -0.857    1.444        -0.593    0.5534             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p3_add   +0.238    1.444        0.165     0.869              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:p4_add   +4.256    1.892        2.250     0.02515     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time2:p4_add   +11.096   1.892        5.865     1.111e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:p4_add   +9.209    1.892        4.867     1.769e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 348 total; 324 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.376275 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            1        2          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.89410000 0.021799 0.00025088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.02179900 1.894100 0.02179900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.00025088 0.021799 1.89410000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.3763 1.3763 1.3763 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can however test changes to the correlation structure, testing the AR(1) structure we have been</span></span></span>
<span class="r-in"><span><span class="co"># using against the simpler CS strcuture.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RMmodel_CS</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Y"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"plot"</span>,</span></span>
<span class="r-in"><span>                      prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>,</span></span>
<span class="r-in"><span>                      theta <span class="op">=</span> <span class="fl">0.9991</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="AICc.html">AICc</a></span><span class="op">(</span><span class="va">RMmodel_theta</span><span class="op">)</span>; <span class="fu"><a href="AICc.html">AICc</a></span><span class="op">(</span><span class="va">RMmodel_CS</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1210.065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1210.1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We see that they are practically identical, but the AR(1) strcuture is preferred.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">##################################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Code to simulate data</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">523</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">props</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#row number</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Monocultures</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="co">#4 species</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="co">#2 technical reps</span></span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">props</span><span class="op">[</span><span class="va">index</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Equal Mixtures</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">rich</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#3 reps at each richness level</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">rich</span><span class="op">)</span> <span class="co">#randomly pick species from pool</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="co">#2 technical reps</span></span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">props</span><span class="op">[</span><span class="va">index</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">rich</span> <span class="co">#equal proportions</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Unequal Mixtures</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">rich</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#15 reps at each richness level</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">rich</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#randomly pick species from pool</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="co">#2 technical reps</span></span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">props</span><span class="op">[</span><span class="va">index</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">==</span><span class="va">i</span><span class="op">)</span><span class="op">/</span><span class="va">rich</span> <span class="co">#equal proportions</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">props</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">props</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="va">props</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ADDs</span> <span class="op">&lt;-</span> <span class="fu">DImodels</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI_data_manipulation.html" class="external-link">DI_data</a></span><span class="op">(</span>prop<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, what<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADD"</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mySimData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mySimData</span>, <span class="va">ADDs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">E_AV</span> <span class="op">&lt;-</span> <span class="fu">DImodels</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI_data_manipulation.html" class="external-link">DI_data</a></span><span class="op">(</span>prop<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, what<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"AV"</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mySimData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mySimData</span>, <span class="va">E_AV</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT1</span> <span class="op">&lt;-</span> <span class="va">mySimData</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT2</span> <span class="op">&lt;-</span> <span class="va">mySimData</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT3</span> <span class="op">&lt;-</span> <span class="va">mySimData</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co">#Number of Ys</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.Q</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#Principal Components (make sure it's positive definite)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#Sigma</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#runif(11, -1, 7) #decide on betas randomly</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">#Within subject error</span></span></span>
<span class="r-in"><span>  <span class="va">error</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>, mu<span class="op">=</span><span class="va">m</span>, Sigma<span class="op">=</span><span class="va">S</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT1</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3.6</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">4.8</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3.3</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p1_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">4.0</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p2_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">1.3</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p3_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5.2</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p4_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">error</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT2</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.3</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.4</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5.1</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">5.0</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3.6</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p1_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">4.5</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p2_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">0.5</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p3_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">6.5</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p4_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">error</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT3</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.7</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.3</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">6.5</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">5.9</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">4.5</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p1_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5.2</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p2_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">0.6</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p3_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">7.8</span><span class="op">*</span><span class="va">mySimDataT3</span><span class="op">$</span><span class="va">p4_add</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">error</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mySimDataT1</span>, <span class="va">mySimDataT2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mySimData</span>, <span class="va">mySimDataT3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">$</span><span class="va">plot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laura Byrne, Rishabh Vishwakarma, Rafael de Andrade Moral, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

