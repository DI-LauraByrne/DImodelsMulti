<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The simulated multivariate repeated measures "simMVRM" dataset — simMVRM • DImodelsMulti</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The simulated multivariate repeated measures " simmvrm dataset><meta name="description" content="The simMVRM dataset was simulated from a multivariate repeated measures DI model. It contains
336 plots comprising of four species that vary in proportions (p1 - p4). There are
three simulated responses (Y1, Y2, Y3), taken at two differing time points, recorded in a
wide data format (one column per response type). The data was simulated assuming that there were
existing covariances between the responses and between the time pointsand both species identity and
species interaction effects were present."><meta property="og:description" content="The simMVRM dataset was simulated from a multivariate repeated measures DI model. It contains
336 plots comprising of four species that vary in proportions (p1 - p4). There are
three simulated responses (Y1, Y2, Y3), taken at two differing time points, recorded in a
wide data format (one column per response type). The data was simulated assuming that there were
existing covariances between the responses and between the time pointsand both species identity and
species interaction effects were present."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsMulti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DImulti_commonErrors.html">Common errors &amp; warnings encountered in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_onTheta.html">On the usage and estimation of theta in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_prediction.html">On prediction from multivariate repeated measures DI models</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_workflow.html">The recommended workflow of DImulti() analyses</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DI-LauraByrne/DImodelsMulti/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The simulated multivariate repeated measures "simMVRM" dataset</h1>

      <div class="d-none name"><code>simMVRM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>simMVRM</code> dataset was simulated from a multivariate repeated measures DI model. It contains
336 plots comprising of four species that vary in proportions (<code>p1</code> - <code>p4</code>). There are
three simulated responses (<code>Y1, Y2, Y3</code>), taken at two differing time points, recorded in a
wide data format (one column per response type). The data was simulated assuming that there were
existing covariances between the responses and between the time pointsand both species identity and
species interaction effects were present.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"simMVRM"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 672 observations on the following 9 variables.</p><dl><dt><code>plot</code></dt>
<dd><p>a factor vector indicating the ID of the experimental unit</p></dd>

    <dt><code>p1</code></dt>
<dd><p>a numeric vector indicating the initial proportion of species 1</p></dd>

    <dt><code>p2</code></dt>
<dd><p>a numeric vector indicating the initial proportion of species 2</p></dd>

    <dt><code>p3</code></dt>
<dd><p>a numeric vector indicating the initial proportion of species 3</p></dd>

    <dt><code>p4</code></dt>
<dd><p>a numeric vector indicating the initial proportion of species 4</p></dd>

    <dt><code>Y1</code></dt>
<dd><p>a numeric vector indicating the response of ecosystem function 1</p></dd>

    <dt><code>Y2</code></dt>
<dd><p>a numeric vector indicating the response of ecosystem function 2</p></dd>

    <dt><code>Y3</code></dt>
<dd><p>a numeric vector indicating the response of ecosystem function 3</p></dd>

    <dt><code>time</code></dt>
<dd><p>a factor with levels <code>1</code> <code>2</code></p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>What are Diversity-Interactions (DI) models?</b></p>
<p>Diversity-Interactions (DI) models (Kirwan <em>et al.</em>, 2009) are a set of tools for analysing and
interpreting data from experiments that explore the effects of species diversity on community-level
responses. We strongly recommend that users read the short introduction to Diversity-Interactions
models (available at: <code><a href="https://rdrr.io/pkg/DImodels/man/DImodels-package.html" class="external-link">DImodels</a></code>). Further information on
Diversity-Interactions models is also available in Kirwan <em>et al.</em>, 2009 and
Connolly <em>et al.</em>, 2013.</p>
<p><b>Parameter values for the simulation</b></p>
<p>Multivariate repeated measures DI models take the general form of:</p>
<p>$${y}_{kmt} = {Identities}_{kmt} + {Interactions}_{kmt} + {Structures}_{kt} + {\epsilon}_{kmt}$$</p>
<p>where \(y\) are the community-level responses, the \(Identities\) are the effects of species
identities for each response and enter the model as individual species proportions measured at the
beginning of the time period, the \(Interactions\) are the interactions among the species
proportions, while \(Structures\) include other experimental structures such as blocks,
treatments, or density.</p>
<p>The dataset <code>simRM</code> was simulated with:</p><ul><li><p>identity effects for the four species for each time and ecosystem function:</p><ul><li><p>Y1time1 = -1.0, 5.0, 2.8, -0.9</p></li>
<li><p>Y1time2 = 0.5, 5.4, 4.9, -2.1</p></li>
<li><p>Y2time1 = 0.1, 4.1, -0.5, 0.3</p></li>
<li><p>Y2time2 = 2.3, 3.2, -3.1, 2.1</p></li>
<li><p>Y3time1 = 0.9, 6.6, 3.5, 6.1</p></li>
<li><p>Y3time2 = -0.1, 7.0, 2.8, 4.0</p></li>
</ul></li>
<li><p>evenness interaction effect for each time and ecosystem function:</p><ul><li><p>Y1time1 = -0.1</p></li>
<li><p>Y1time2 = 12.0</p></li>
<li><p>Y2time1 = 2.3</p></li>
<li><p>Y2time2 = 1.6</p></li>
<li><p>Y3time1 = 2.1</p></li>
<li><p>Y3time2 = 6.8</p></li>
</ul></li>
<li><p>\(\epsilon\) assumed to have a multivaraite normal distribution with mean 0. An ecosystem
  function matrix Sigma:</p><table class="table table"><tr><td></td><td></td><td></td><td></td><td></td></tr></table><p>and a time matrix Sigma:</p><table class="table table"><tr><td></td><td></td><td></td><td></td><td></td></tr></table></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dooley, A., Isbell, F., Kirwan, L., Connolly, J., Finn, J.A. and Brophy, C., 2015. <br>
Testing the effects of diversity on ecosystem multifunctionality using a multivariate model. <br>
Ecology Letters, 18(11), pp.1242-1251. <br></p>
<p>Finn, J.A., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, A., Baadshaug, O.H.,
Belanger, G., Black, A., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, I.,
Elgersma, A., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, A., Golinska, B., Golinski, P.,
Grieu, P., Gustavsson, A.M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z.,
Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., and Lüscher, A., 2013. <br>
Ecosystem function enhanced by combining four functional types of plant species in intensively
managed grassland mixtures: a 3-year continental-scale field experiment.<br>
Journal of Applied Ecology, 50(2), pp.365-375 .<br></p>
<p>Kirwan, L., Connolly, J., Finn, J.A., Brophy, C., Luscher, A., Nyfeler, D. and Sebastia, M.T.,
2009. <br>
Diversity-interaction modeling: estimating contributions of species identities and interactions
to ecosystem function. <br>
Ecology, 90(8), pp.2032-2038. <br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">###################################################################################################</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;STYLE type='text/css' scoped&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;/STYLE&gt;</span>
<span class="r-in"><span><span class="co">## Modelling Example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For a more thorough example of the workflow of this package, please see vignette</span></span></span>
<span class="r-in"><span><span class="co"># DImulti_workflow using the following code:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># vignette("DImulti_workflow")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   plot p1 p2 p3 p4         Y1          Y2        Y3 time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We call DImulti() to fit a series of models, with increasing complexity, and test whether the</span></span></span>
<span class="r-in"><span><span class="co"># additional terms are worth keeping.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We begin with an ID DI model, ensuring to use method = "ML" as we will be comparing fixed effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MVRMmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">MVRMmodel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">ML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">un@CS</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Identity Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span>1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by maximum likelihood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9670.780  9811.002 -4810.390 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Multivariate Correlation Structure: General</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1      2     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.606       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.246 -0.168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: Compound symmetry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2275234 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Beta      Std. Error   t-value   p-value      Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------  --------  -----------  --------  -----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p1_ID   -0.709    0.485        -1.462    0.144               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p1_ID   +2.271    0.485        4.681     3.045e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p1_ID   +2.440    0.485        5.030     5.343e-07    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p1_ID   +8.372    0.485        17.260    2.537e-62    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p1_ID   +3.795    0.485        7.825     8.197e-15    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p1_ID   +4.023    0.485        8.294     1.992e-16    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p2_ID   +5.375    0.464        11.577    4.797e-30    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p2_ID   +5.934    0.464        12.781    5.209e-36    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p2_ID   +7.998    0.464        17.226    4.229e-62    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p2_ID   +12.106   0.464        26.075    3.365e-129   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p2_ID   +3.717    0.464        8.007     1.981e-15    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p2_ID   +10.769   0.464        23.196    1.459e-105   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p3_ID   +3.383    0.482        7.025     2.935e-12    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p3_ID   +1.205    0.482        2.503     0.0124       *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p3_ID   +4.856    0.482        10.083    2.367e-23    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p3_ID   +12.855   0.482        26.691    1.959e-134   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p3_ID   -2.152    0.482        -4.468    8.356e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p3_ID   +7.712    0.482        16.012    2.241e-54    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p4_ID   -0.104    0.545        -0.191    0.8488              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p4_ID   +2.510    0.545        4.604     4.399e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p4_ID   +6.626    0.545        12.156    7.556e-33    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p4_ID   +6.875    0.545        12.612    3.845e-35    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p4_ID   +3.348    0.545        6.141     9.874e-10    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p4_ID   +8.758    0.545        16.067    1.031e-54    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 2016 total; 1992 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 2.906918 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Multivariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4.9364  2.60580 -1.14680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.6058  3.75180 -0.68183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.1468 -0.68183  4.39700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.2218 1.937 2.0969 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Repeated Measure`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]    [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 11.3980  2.5933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.5933 11.3980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 3.3761 3.3761 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:1  8.45020  1.92260  5.11670  1.16420 -2.08000 -0.47325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:2  1.92260  8.45020  1.16420  5.11670 -0.47325 -2.08000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:1  5.11670  1.16420  8.45020  1.92260 -1.41850 -0.32275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:2  1.16420  5.11670  1.92260  8.45020 -0.32275 -1.41850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:1 -2.08000 -0.47325 -1.41850 -0.32275  8.45020  1.92260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:2 -0.47325 -2.08000 -0.32275 -1.41850  1.92260  8.45020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.9069 2.9069 2.9069 2.9069 2.9069 2.9069 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next, we include the simplest interaction structure available in this package, "AV", which adds</span></span></span>
<span class="r-in"><span><span class="co"># a single extra term per ecosystem function and time point</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MVRMmodel_AV</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">MVRMmodel</span>, <span class="va">MVRMmodel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MVRMmodel        1 25 9670.780 9811.002 -4810.390                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MVRMmodel_AV     2 31 7921.064 8094.939 -3929.532 1 vs 2 1761.716  &lt;.0001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We select the more model with the lower AIC/BIC value or we use the p-value of the likelihood</span></span></span>
<span class="r-in"><span><span class="co"># ratio test to determine if we reject the null hypothesis that the extra terms in the model are</span></span></span>
<span class="r-in"><span><span class="co"># equal to zero, which in this case is lower than our alpha value of 0.05, so we do reject this</span></span></span>
<span class="r-in"><span><span class="co"># hypothesis and continue with our more complex model.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># We can continue increasing the complexity of the interaction structure in the same fashion, this</span></span></span>
<span class="r-in"><span><span class="co"># time we elect to use the additive interaction structure</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MVRMmodel_ADD</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"ADD"</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">MVRMmodel_AV</span>, <span class="va">MVRMmodel_ADD</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MVRMmodel_AV      1 31 7921.064 8094.939 -3929.532                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MVRMmodel_ADD     2 49 7948.032 8222.867 -3925.016 1 vs 2 9.031852   0.959</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We fail to reject the null hypothesis and so we select the average interaction structure.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Finally, we can also increase the model complexity via the inclusion of the non-linear parameter</span></span></span>
<span class="r-in"><span><span class="co"># theta, which we can estimate, or select a value for. We also choose to estimate using the "REML"</span></span></span>
<span class="r-in"><span><span class="co"># method as we will do no further fixed effect model comparisons</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">MVRMmodel_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, data <span class="op">=</span> <span class="va">simMVRM</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>,</span></span>
<span class="r-in"><span>                   estimate_theta <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">MVRMmodel_theta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">REML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">un@CS</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Average Term Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta estimate(s) = </span><span style="font-weight: bold;">Y1</span>:0.9704, <span style="font-weight: bold;">Y2</span>:0.7538, <span style="font-weight: bold;">Y3</span>:1.0089</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by REML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + AV)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7933.636  8107.046 -3935.818 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Multivariate Correlation Structure: General</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1      2     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.609       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.310 -0.363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: Compound symmetry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3126024 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Beta      Std. Error   t-value   p-value      Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------  --------  -----------  --------  -----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p1_ID   -1.364    0.397        -3.431    0.0006143    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p1_ID   +0.594    0.384        1.549     0.1216              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p1_ID   +0.915    0.401        2.283     0.02253      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p1_ID   +0.202    0.397        0.509     0.6111              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p1_ID   +2.666    0.384        6.947     5.054e-12    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p1_ID   -0.542    0.401        -1.352    0.1767              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p2_ID   +4.810    0.368        13.062    1.822e-37    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p2_ID   +4.523    0.355        12.737    8.871e-36    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p2_ID   +6.675    0.371        17.977    4.537e-67    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p2_ID   +5.052    0.368        13.720    5.335e-41    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p2_ID   +2.767    0.355        7.792     1.056e-14    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p2_ID   +6.811    0.371        18.343    1.514e-69    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p3_ID   +2.711    0.399        6.790     1.48e-11     ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p3_ID   -0.498    0.384        -1.298    0.1945              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p3_ID   +3.288    0.403        8.160     5.882e-16    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p3_ID   +4.467    0.399        11.187    3.234e-28    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p3_ID   -3.299    0.384        -8.597    1.633e-17    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p3_ID   +3.017    0.403        7.489     1.04e-13     ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p4_ID   -0.853    0.449        -1.897    0.05792      +      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p4_ID   +0.543    0.437        1.242     0.2143              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p4_ID   +4.890    0.452        10.811    1.649e-26    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p4_ID   -2.469    0.449        -5.493    4.453e-08    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p4_ID   +2.023    0.437        4.628     3.926e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p4_ID   +3.562    0.452        7.875     5.58e-15     ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:AV      +2.560    0.905        2.828     0.004729     **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:AV      +4.283    0.529        8.091     1.021e-15    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:AV      +6.424    0.998        6.436     1.531e-10    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:AV      +31.946   0.905        35.291    3.302e-212   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:AV      +2.885    0.529        5.450     5.669e-08    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:AV      +19.229   0.998        19.264    5.916e-76    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 2016 total; 1986 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.948135 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Multivariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]    [,2]    [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4.9095  2.3475 -1.3752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.3475  3.0305 -1.2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.3752 -1.2650  4.0087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.2157 1.7408 2.0022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Repeated Measure`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.6330 1.4483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.4483 4.6330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.1524 2.1524 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:1  3.79520  1.18640  2.30980  0.72204 -1.17640 -0.36776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:2  1.18640  3.79520  0.72204  2.30980 -0.36776 -1.17640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:1  2.30980  0.72204  3.79520  1.18640 -1.37740 -0.43059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:2  0.72204  2.30980  1.18640  3.79520 -0.43059 -1.37740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:1 -1.17640 -0.36776 -1.37740 -0.43059  3.79520  1.18640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:2 -0.36776 -1.17640 -0.43059 -1.37740  1.18640  3.79520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.9481 1.9481 1.9481 1.9481 1.9481 1.9481 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Finally, we can utilise this model for our interpretation and predictions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">MVRMmodel_theta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   plot     Yvalue Ytype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1 -1.3637130  Y1:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1  0.2021854  Y1:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1  0.5944749  Y2:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    1  2.6663312  Y2:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    1  0.9148420  Y3:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    1 -0.5415428  Y3:2</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">##################################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Code to simulate data</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">746</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">props</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    p4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co">#row number</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Monocultures</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="co">#6 species</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="co">#2 technical reps</span></span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">props</span><span class="op">[</span><span class="va">index</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Equal Mixtures</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">rich</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#3 reps at each richness level</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">rich</span><span class="op">)</span> <span class="co">#randomly pick species from pool</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="co">#2 technical reps</span></span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">props</span><span class="op">[</span><span class="va">index</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">rich</span> <span class="co">#equal proportions</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Unequal Mixtures</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">rich</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#15 reps at each richness level</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">rich</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#randomly pick species from pool</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="co">#2 technical reps</span></span></span>
<span class="r-in"><span>  <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">props</span><span class="op">[</span><span class="va">index</span>, <span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">==</span><span class="va">i</span><span class="op">)</span><span class="op">/</span><span class="va">rich</span> <span class="co">#equal proportions</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="va">index</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">props</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">props</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="va">props</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ADDs</span> <span class="op">&lt;-</span> <span class="fu">DImodels</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI_data_manipulation.html" class="external-link">DI_data</a></span><span class="op">(</span>prop<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, what<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADD"</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mySimData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mySimData</span>, <span class="va">ADDs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">E_AV</span> <span class="op">&lt;-</span> <span class="fu">DImodels</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DImodels/man/DI_data_manipulation.html" class="external-link">DI_data</a></span><span class="op">(</span>prop<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, what<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"AV"</span><span class="op">)</span>, data<span class="op">=</span><span class="va">mySimData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mySimData</span>, <span class="va">E_AV</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT1</span> <span class="op">&lt;-</span> <span class="va">mySimData</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT2</span> <span class="op">&lt;-</span> <span class="va">mySimData</span></span></span>
<span class="r-in"><span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nT</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co">#Number of s</span></span></span>
<span class="r-in"><span><span class="co">#Principal Components (make sure it's positive definite)</span></span></span>
<span class="r-in"><span><span class="va">pT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.Q</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nT</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="va">nT</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ST</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">pT</span>, <span class="va">pT</span><span class="op">*</span><span class="op">(</span><span class="va">nT</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#Sigma</span></span></span>
<span class="r-in"><span><span class="va">mT</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nT</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nY</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co">#Number of Ys</span></span></span>
<span class="r-in"><span><span class="co">#Principal Components (make sure it's positive definite)</span></span></span>
<span class="r-in"><span><span class="va">pY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/qraux.html" class="external-link">qr.Q</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nY</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="va">nY</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">pY</span>, <span class="va">pY</span><span class="op">*</span><span class="op">(</span><span class="va">nY</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#Sigma</span></span></span>
<span class="r-in"><span><span class="va">mY</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nY</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#runif(7, -1, 7) #decide on betas randomly</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">#Within subject error</span></span></span>
<span class="r-in"><span>  <span class="va">errorT</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>, mu<span class="op">=</span><span class="va">mT</span>, Sigma<span class="op">=</span><span class="va">ST</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">errorY</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>, mu<span class="op">=</span><span class="va">mY</span>, Sigma<span class="op">=</span><span class="va">SY</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT1</span><span class="op">$</span><span class="va">Y1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1.0</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5.0</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.8</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fl">0.9</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">errorT</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">errorY</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT2</span><span class="op">$</span><span class="va">Y1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5.4</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">4.9</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fl">2.1</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">12.0</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">errorT</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">errorY</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT1</span><span class="op">$</span><span class="va">Y2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">4.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">0.3</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.3</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">errorT</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">errorY</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT2</span><span class="op">$</span><span class="va">Y2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.3</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3.2</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="op">-</span><span class="fl">3.1</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">2.1</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.6</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">errorT</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">errorY</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT1</span><span class="op">$</span><span class="va">Y3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.9</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">6.6</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">3.5</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">6.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.1</span><span class="op">*</span><span class="va">mySimDataT1</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">errorT</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">errorY</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">mySimDataT2</span><span class="op">$</span><span class="va">Y3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">7.0</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2.8</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fl">4.0</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">p4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">6.8</span><span class="op">*</span><span class="va">mySimDataT2</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">errorT</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">errorY</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mySimDataT1</span>, <span class="va">mySimDataT2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mySimData</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mySimData</span><span class="op">$</span><span class="va">plot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laura Byrne, Rishabh Vishwakarma, Rafael de Andrade Moral, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

