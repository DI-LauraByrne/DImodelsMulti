<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>DImulti — DImulti • DImodelsMulti</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DImulti — DImulti"><meta name="description" content="A function to fit Diversity-Interactions models to data with multiple ecosystem
functions and/or multiple time points"><meta property="og:description" content="A function to fit Diversity-Interactions models to data with multiple ecosystem
functions and/or multiple time points"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsMulti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DImulti_workflow.html">The recommended workflow of DImulti() analyses</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_onTheta.html">On the usage and estimation of theta in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_prediction.html">On prediction from multivariate repeated measures DI models</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_commonErrors.html">Common errors &amp; warnings encountered in DImulti()</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DI-LauraByrne/DImodelsMulti/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>DImulti</h1>
      <small class="dont-index">Source: <a href="https://github.com/DI-LauraByrne/DImodelsMulti/blob/master/R/DImulti_fit.R" class="external-link"><code>R/DImulti_fit.R</code></a></small>
      <div class="d-none name"><code>DImulti.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to fit Diversity-Interactions models to data with multiple ecosystem
functions and/or multiple time points</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DImulti</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"NA"</span><span class="op">)</span>,</span>
<span>  <span class="va">unit_IDs</span>,</span>
<span>  <span class="va">prop</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">DImodel</span>,</span>
<span>  FG <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ID <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extra_fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  estimate_theta <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  theta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  method_theta <span class="op">=</span> <span class="st">"univariate"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>If the dataset is in a wide format, this argument is a vector of k column names
identifying the ecosystem function values recorded from each experimental unit in the dataset.
For example, if the ecosystem function columns are labelled Y1 to Y4, then
<code>y = c("Y1","Y2","Y3","Y4")</code>. Alternatively, the column numbers can be specified, for
example, <code>y = 8:11</code>, where ecosystem function values are in the 8th to 11th columns.
If the dataset is in the long/stacked format, this argument is the column name of the
response value vector, for example, <code>y = "yield"</code>, alternatively, the column number can be
supplied, <code>y = 8</code></p></dd>


<dt id="arg-eco-func">eco_func<a class="anchor" aria-label="anchor" href="#arg-eco-func"></a></dt>
<dd><p>A vector of size two, with the first index holding the column name containing
the character or factor indicator of which response was recorded (for use when stacked/long data
passed through parameter y), otherwise it is the string <code>"NA"</code>, case insensitive. The second
index should contain a string referring to the autocorrelation structure of the responses (for
use in multivariate data case), options include <code>"un"</code> for unstructured/general and
<code>"cs"</code> for compound symmetry. For example, <code>eco_func = c("Function", "cs")</code>, pertaining
to multivariate data in a stacked format with a compound symmetry structure, or
<code>eco_func = c("na", "un")</code>, meaning either univariate or wide multivariate data with an
unstructured/general variance covariance matrix</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>A vector of size two, with the first index holding the column name containing the
repeated measures identifier (i.e., indicating which time point the corresponding response was
recorded at), otherwise it is the string <code>"NA"</code>, case insensitive. The second index should
contain a string referring to the autocorrelation structure of the repeated measures, options
include <code>"un"</code> for unstructured/general, <code>"cs"</code> for compound symmetry, and
<code>"ar1"</code> for an autoregressive model of order 1 (AR(1)). For example,
<code>time = c("reading", "ar1")</code>, pertaining to repeated measures data with multiple readings
on each unit with an AR(1) structure, or <code>time = c("na", "un")</code>, meaning multivariate data
with no repeated measures (the correlation structure will be ignored)</p></dd>


<dt id="arg-unit-ids">unit_IDs<a class="anchor" aria-label="anchor" href="#arg-unit-ids"></a></dt>
<dd><p>A vector of columns names/indices containing identifiers for the experimental
units from which the observations (either multiple readings of the same response or a single
reading of multiple responses) are taken, e.g., <code>unit_IDs = "Plot"</code></p></dd>


<dt id="arg-prop">prop<a class="anchor" aria-label="anchor" href="#arg-prop"></a></dt>
<dd><p>A vector of S column names identifying the species proportions in each community in
the dataset. For example, if the species proportions columns are labelled p1 to p4, then
<code>prop = c("p1","p2","p3","p4")</code>. Alternatively, the column numbers can be specified,
for example, <code>prop = 4:7</code>, where species proportions are in the 4th to 7th columns</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A dataframe or tibble containing all previously input columns</p></dd>


<dt id="arg-dimodel">DImodel<a class="anchor" aria-label="anchor" href="#arg-dimodel"></a></dt>
<dd><p>A string, referring to the interaction structure of model to be fit from the full
list: <code>"STR", "ID", "FULL", "E", "AV", "ADD", "FG"</code></p></dd>


<dt id="arg-fg">FG<a class="anchor" aria-label="anchor" href="#arg-fg"></a></dt>
<dd><p>If species are classified by g functional groups, this argument takes a string vector
(of length S) of the functional group to which each species referenced in the <code>prop</code>
argument belongs. For example, for four grassland species with two grasses and two legumes: FG
could be <code>FG = c("G","G","L","L")</code>, where G stands for grass and L stands for legume. This
argument is optional but must be supplied if the <code>"FG"</code> interaction structure is specified
in the <code>DImodel</code> argument</p></dd>


<dt id="arg-id">ID<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>A text list (of length s) describing groupings for the identity of the effects of the
species. These groupings will constrain some of the identity effects to be equal. For example,
if there are four species and you wish to have two identity effect groups where species 1 and 3
and species 2 and 4 are grouped together: ID could be <code>ID = c("ID1", "ID2", "ID1", "ID2")</code>,
where "ID1" and "ID2" are the names of the ID groups. This changes the identity component of the
model from <code>'beta_1p_1 + beta_2p_2 + beta_3p_3 + beta_4p_4'</code> to <code>'beta_a(p_1 + p_3) +
beta_b(p_2 + p_4)'</code>. This grouping does not affect the interaction terms.</p></dd>


<dt id="arg-extra-fixed">extra_fixed<a class="anchor" aria-label="anchor" href="#arg-extra-fixed"></a></dt>
<dd><p>A formula expression for any additional fixed effect terms. For example,
<code>extra_fixed = ~ Treatment</code> or <code>extra_fixed = ~ Treatment + Density</code>. Interactions
across the regular formula can easily be included by beginning this argument with <code>1*</code> or
<code>1:</code>, e.g. <code>extra_fixed = ~ 1:Density</code>. Any interactions included through this
parameter will not be affected by <code>theta</code>.
Any terms included will automatically be crossed with the column(s) specified through
<code>eco_func</code> and/or <code>time</code>, therefore these interactions do not need to be specified here.</p></dd>


<dt id="arg-estimate-theta">estimate_theta<a class="anchor" aria-label="anchor" href="#arg-estimate-theta"></a></dt>
<dd><p>By default, \(\theta\) (the power parameter on all <code>p_i * p_j</code>
components of each interaction variable in the model) is set equal to one. Specify
<code>estimate_theta = TRUE</code> to include the estimation of \(\theta\) in the specified model. A
value of \(\theta\) will be estimated for each ecosystem function present in the data,
possibly changing the fixed effects across functions.</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Users may specify a value of \(\theta\) different than 1 to fit the DI model.
Note that if <code>estimate_theta = TRUE</code>, then \(\theta\) will be estimated via maximum
profile log-likelihood and the value specified for <code>theta</code> will be overridden. Specify a
vector of positive non-zero numerical values indicating the value for the non-linear parameter
of the model for each ecosystem function (in alphabetical order, use <code><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort()</a></code> to find this)
present in the dataset, changing the fixed effects across functions, or a single value to be used
for all. For example, <code>theta = 0.5</code> or <code>theta = c(1, 0.5, 1)</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The string <code>"REML"</code> or <code>"ML"</code>, referring to the estimation method to be
used. "REML" is suitable for model comparisons only if the fixed effects are
held constant but provides unbiased estimates. If fixed effects are going to be tested between
models, use "ML" for comparisons and then refit the chosen model using "REML".</p></dd>


<dt id="arg-method-theta">method_theta<a class="anchor" aria-label="anchor" href="#arg-method-theta"></a></dt>
<dd><p>The string <code>"single"</code>, <code>"joint"</code>, or <code>"univariate"</code>, referring
to the profiling method to be used. This refers to whether each theta value in a multivariate model
is profiled separately (over a line), all at once (over a surface), or using a series of univariate
DI models. Defaults to "univariate", which has been currently found to be the more
efficient/parsimonious method via simulation study.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>DImulti</code> - a custom class object containing the gls model fit with additional DI
model attributes</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Data</strong> <br></p>
<p>This package is intended for use with data containing multiple ecosystem function responses
and/or time points from a biodiversity and ecosystem function (BEF) relationship study.
The dataset should contain a column for each species' proportion, so that each row of these columns sum
to one.
Each row of the data should also contain an identifier for the experimental unit being referenced,
these identifiers must be unique to each experimental unit, but remain consistent over time and
across functions.
For each experimental unit included there must be recordings of either: <br>
- a single community level ecosystem function response variable taken at multiple time points
(repeated measures), <br>
- multiple community level ecosystem function responses (multivariate), or <br>
- multiple community level ecosystem function responses taken at multiple time points
(multivariate repeated measures). <br>
Ecosystem functions may be stored in a long or wide format while repeated measures must be stored
in a long format. <br></p>
<p><strong>Introduction to multivariate &amp; repeated measures Diversity-Interactions models</strong> <br></p>
<p>Diversity-Interactions (DI) models are a regression based approach to modelling the biodiversity
ecosystem function (BEF) relationship
which assumes that the main driver behind changes in ecosystem functioning is the initial
relative abundance (or proportions) of the
species present. These models can be estimated using least squares estimation methods. <br>
An example of a univariate DI model can be seen below, <br>
$$ y =  \sum^{S}_{i=1}{\beta_{i} p_{i}} +
 \sum^{S}_{\substack{i,j=1 \\ i&lt;j}}{\delta_{ij}(p_{i}p_{j})^{\theta} + \alpha A + \epsilon }$$
where the response \(y\) represents the recorded ecosystem function, \(p_{i}\) represents the
initial proportion of the \(i^{th}\)
species, therefore the \(p\) values sum to 1 and form a simplex space, and scales the ID effect
of the species, \(\beta_{i}\); if no
species interactions or treatments are required in the model, the response \(y\) is the
weighted average of the species identity effects.
\(S\) represents the number of unique species present in the study. Similarly to the ID effect,
the interaction effect, \(\delta\),
between species is scaled by some combination of the products of species proportions, which
depends on the interaction structure chosen.
The example above shows the full pairwise structure, which has a unique interaction term,
\(\delta_{ij}\), per pair of species \(i\)
&amp; \(j\).
The nonlinear term \(\theta\) (Connolly <em>et al.</em>, 2013; Vishwakarma <em>et al.</em>, 2023)
is included in the model to allow the shape of the BEF relationship to change. This parameter
can be estimated using profile log-likelihood optimisation (Brent, 1973) or can be assigned a
set value based on an <em>a priori</em> assumption/knowledge.
\(A\) may include blocks or treatment terms, and \(\alpha\) is a vector of the
corresponding effect coefficients. <br>
For further details of univariate DI modelling, see <code>?DImodels</code>, Kirwan <em>et al.</em>,
2009, and Moral <em>et al.</em>, 2023. <br></p>
<p>The multivariate DI model (Dooley <em>et al.</em>, 2015) extends the DI modelling framework to
allow for the estimation of multiple ecosystem functions simultaneously, accounting for any
existing covariance between functions through the error term. These models can be further
extended through the introduction of repeated measures over multiple time points.
<br>
The structure for such models is:
$$ y_{kmt} =  \sum^{S}_{i=1}{\beta_{ikt} p_{im}} +
\sum^{S}_{\substack{i,j=1 \\ i&lt;j}}{\delta_{ijkt}(p_{im}p_{jm})^{\theta_{k}}} +
\alpha_{kt}A + \epsilon_{kmt} $$</p>
<p>where \(y_{kmt}\) refers to the value of the \(k^{th}\) ecosystem function from the
\(m^{th}\) experimental unit at a time point
\(t\). For an experimental unit \(m\), \(\beta_{ikt}\) scaled by \(p_{im}\) is the
expected contribution of the \(i^{th}\) species to the \(k^{th}\) response at time point
\(t\) and is referred to as the \(i^{th}\) species' ID effect.
The value of the nonlinear parameter \(\theta\) is allowed to vary between ecosystem functions,
in turn allowing the fixed effect structure to change across functions, in recognition that the
nature of the species interactions could change between ecosystem functions.<br></p>
<p>In the case that a dataset contains only a single ecosystem function, the corresponding subscript
\(k\) can simply be removed from the equation, the same can be said for the removal of the
subscript \(t\) in the instance that a dataset contains a single time point. <br></p>
<p><strong>The structure of the error term</strong> <br></p>
<p>For a univariate DI model, the error term is assumed to follow a normal distribution with mean
\(0\) and variance \(\sigma^{2}\).
$$ \epsilon \sim N(0, \sigma^{2})$$</p>
<p>When the model is extended to fit multivariate (\(k&gt;1\)) and/or repeated measures (\(t&gt;1\))
data, the error term is now assumed to follow a multivariate normal distribution with mean
\(0\) and variance \(\Sigma^{*}\).
$$ \epsilon \sim MVN(0, \Sigma^{*}) $$
\(\Sigma^{*}\) is a block diagonal matrix, with one \(kt\) x \(kt\) block, \(\Sigma\),
for each experimental unit \(m\). We refer to \(\Sigma\) as the variance covariance matrix
for our ecosystem functions and time points. Typically, it includes a unique variance
per combination of ecosystem functions and time points along the diagonal and a unique covariance
between each pair of combinations on the off-diagonal. Autocorrelation structures may be
implemented on the matrix \(\Sigma\), either to simplify the estimation process or based
on <em>a priori</em> knowledge. One structure is chosen for the ecosystem functions and another for
repeated measures/time points, the two matrices are then estimated independently and combined
using the Kronecker product (\(\otimes\)), a matrix multiplication method. In the case that
the data is only multivariate (\(k&gt;1\) &amp; \(t=1\)) or only has repeated measures (\(k=1\) &amp;
\(t&gt;1\)), only one autocorrelation structure needs to be chosen, with no multiplication
necessary. <br>
Three such structures are currently available in this package for repeated measures responses,
and two are available for multivariate responses: <br></p><ol><li><p><strong>UN</strong>: When each element of \(\Sigma\) is set to estimate independently, it is
 said to be unstructured or follow the general structure and is the preferred option in the case
 that there is no a priori information on the nature of these relationships.
 <code><a href="https://rdrr.io/pkg/nlme/man/corSymm.html" class="external-link">corSymm</a></code> <br></p></li>
<li><p><strong>CS</strong>: A simpler structure is compound symmetry,
 where it is assumed that each ecosystem function or time point has the same variance value
 \(\sigma^{2}\) and each pair has the same covariance value \(\sigma^{2}\rho\). This
 structure is not preferred for use with multiple ecosystem functions as it provides no
 meaningful interpretation, however it is allowed in this package if the model requires
 simplification. <code><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html" class="external-link">corCompSymm</a></code> <br></p></li>
<li><p><strong>AR(1)</strong>: An autocorrelation structure exclusive to repeated measures data is an
 autoregressive model of order one, which assumes that, each time point has the same variance,
 \(\sigma^{2}\), and as the distance in pairs of time points increases, the covariance between
 them changes by a factor of \(\rho\). <code><a href="https://rdrr.io/pkg/nlme/man/corAR1.html" class="external-link">corAR1</a></code></p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vishwakarma, R., Byrne, L., Connolly, J., de Andrade Moral, R. and Brophy, C., 2023. <br>
Estimation of the non-linear parameter in Generalised Diversity-Interactions models is
unaffected by change in structure of the interaction terms. <br>
Environmental and Ecological Statistics, 30(3), pp.555-574. <br></p>
<p>Moral, R.A., Vishwakarma, R., Connolly, J., Byrne, L., Hurley, C., Finn, J.A. and Brophy, C.,
2023. <br>
Going beyond richness: Modelling the BEF relationship using species identity, evenness,
richness and species interactions via the DImodels R package. <br>
Methods in Ecology and Evolution, 14(9), pp.2250-2258. <br></p>
<p>Dooley, A., Isbell, F., Kirwan, L., Connolly, J., Finn, J.A. and Brophy, C., 2015. <br>
Testing the effects of diversity on ecosystem multifunctionality using a multivariate model. <br>
Ecology Letters, 18(11), pp.1242-1251. <br></p>
<p>Finn, J.A., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, A., Baadshaug, O.H.,
Belanger, G., Black, A., Brophy, C., Collins, R.P. and Cop, J., 2013. <br>
Ecosystem function enhanced by combining four functional types of plant species in intensively
managed grassland mixtures: a 3-year continental-scale field experiment.<br>
Journal of Applied Ecology, 50(2), pp.365-375 .<br></p>
<p>Connolly, J., Bell, T., Bolger, T., Brophy, C., Carnus, T., Finn, J.A., Kirwan, L., Isbell, F.,
Levine, J., Luscher, A. and Picasso, V., 2013. <br>
An improved model to predict the effects of changing biodiversity levels on ecosystem
function. <br>
Journal of Ecology, 101(2), pp.344-355. <br></p>
<p>Kirwan, L., Connolly, J., Finn, J.A., Brophy, C., Luscher, A., Nyfeler, D. and Sebastia, M.T.,
2009. <br>
Diversity-interaction modeling: estimating contributions of species identities and interactions
to ecosystem function. <br>
Ecology, 90(8), pp.2032-2038. <br></p>
<p>Brent, R.P., 1973. <br>
Some efficient algorithms for solving systems of nonlinear equations. <br>
SIAM Journal on Numerical Analysis, 10(2), pp.327-344. <br></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>This package:
   <code>DImulti</code> <br>
   Example datasets:
   <code><a href="dataBEL.html">dataBEL</a></code>,
   <code><a href="dataSWE.html">dataSWE</a></code>,
   <code><a href="simRM.html">simRM</a></code>,
   <code><a href="simMV.html">simMV</a></code>,
   <code><a href="simMVRM.html">simMVRM</a></code> <br>
Package family:
   <code><a href="https://rdrr.io/pkg/DImodels/man/DImodels-package.html" class="external-link">DImodels</a>,
   <a href="https://rdrr.io/pkg/DImodels/man/autoDI.html" class="external-link">autoDI</a>,
   <a href="https://rdrr.io/pkg/DImodels/man/DI.html" class="external-link">DI</a>,
   <a href="https://rdrr.io/pkg/DImodels/man/DI_data_manipulation.html" class="external-link">DI_data</a></code> <br>
Modelling package:
   <code><a href="https://rdrr.io/pkg/nlme/man/nlme.html" class="external-link">nlme</a></code>,
   <code><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">gls</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Laura Byrne [aut, cre], Rishabh Vishwakarma [aut], Rafael de Andrade Moral [aut],
Caroline Brophy [aut] <br>
Maintainer: Laura Byrne <a href="mailto:byrnel54@tcd.ie">byrnel54@tcd.ie</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#################################################################################################</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;STYLE type='text/css' scoped&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;/STYLE&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Modelling Examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For a more thorough example of the workflow of this package, please see vignette</span></span></span>
<span class="r-in"><span><span class="co"># DImulti_workflow using the following code:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"DImulti_workflow"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>vignette ‘DImulti_workflow’ not found</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The simMVRM dataset</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># This simulated dataset contains multiple ecosystem functions (k=3) and multiple time points</span></span></span>
<span class="r-in"><span><span class="co"># (t=2). The dataset was</span></span></span>
<span class="r-in"><span><span class="co"># simulated using unstructured Sigma matrices.</span></span></span>
<span class="r-in"><span><span class="co"># The true values can be found in the help file for the data, ?simMVRM</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   plot p1 p2 p3 p4         Y1          Y2        Y3 time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1  1  0  0  0 -3.2201614 -0.28424570 4.0353997    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    2  1  0  0  0  0.2166701  0.90917719 0.1719544    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3  1  0  0  0 -2.1709989  0.04832118 0.6787839    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    4  0  1  0  0  5.3908779  4.08309086 6.5332521    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    5  0  1  0  0  5.2733174  4.29488262 6.2761877    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    6  0  1  0  0  4.1985826  3.57457447 7.0207313    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We will start the analysis with a call to the package's main function, DImulti().</span></span></span>
<span class="r-in"><span><span class="co"># We begin the call by specifying the column indices holding the initial species proportions</span></span></span>
<span class="r-in"><span><span class="co"># (p_i) through 'prop' and the columns which hold the ecosystem response values through 'y'.</span></span></span>
<span class="r-in"><span><span class="co"># Since our data is multivariate, we include the 'eco_func' parameter, specifying "na" as our</span></span></span>
<span class="r-in"><span><span class="co"># data is in a wide format (multiple columns in 'y') and "un" to fit an unstructured Sigma</span></span></span>
<span class="r-in"><span><span class="co"># for our ecosystem functions.</span></span></span>
<span class="r-in"><span><span class="co"># The data also contains repeated measures, so we include the 'time' parameter, specifying "time"</span></span></span>
<span class="r-in"><span><span class="co"># as the column containing the time point indicator for each row and "ar1" to fit an AR(1)</span></span></span>
<span class="r-in"><span><span class="co"># autocorrelation structure for our time points.</span></span></span>
<span class="r-in"><span><span class="co"># Next, we specify that the experimental unit identifier is in column 1 through 'unit_IDs'. We</span></span></span>
<span class="r-in"><span><span class="co"># indicate that we do not want to estimate the non-linear parameter theta, but do not provide</span></span></span>
<span class="r-in"><span><span class="co"># any values, opting for the default value of 1.</span></span></span>
<span class="r-in"><span><span class="co"># We specify a full pairwise (FULL) interaction structure through 'DImodel' and estimate the</span></span></span>
<span class="r-in"><span><span class="co"># model using maximum likelihood (ML) as we may compare models.</span></span></span>
<span class="r-in"><span><span class="co"># Finally, we provide the data object simMVRM through 'data'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simModel_FULL</span> <span class="op">&lt;-</span> <span class="fu">DImulti</span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"ar1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         unit_IDs <span class="op">=</span> <span class="fl">1</span>, estimate_theta <span class="op">=</span> <span class="cn">FALSE</span>, DImodel <span class="op">=</span> <span class="st">"FULL"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span></span>
<span class="r-in"><span>                         data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simModel_FULL is an object of custom class DImulti, which can be used with a number of S3</span></span></span>
<span class="r-in"><span><span class="co"># methods and any method compatible with gls objects. We use summary() to examine the model fit,</span></span></span>
<span class="r-in"><span><span class="co"># including fixed effect coefficients and the variance covariance matrix Sigma.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">simModel_FULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">ML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">un@ar1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Full Pairwise Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span>1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by maximum likelihood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + FULL.p1.p2 +      FULL.p1.p3 + FULL.p1.p4 + FULL.p2.p3 + FULL.p2.p4 + FULL.p3.p4)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7969.803  8311.945 -3923.902 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Multivariate Correlation Structure: General</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1      2     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.612       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.310 -0.360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: AR(1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 + as.numeric(time) | plot/func </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Phi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3184991 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Beta      Std. Error   t-value   p-value     Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------  --------  -----------  --------  ----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p1_ID        -1.750    0.535        -3.274    0.001078    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p1_ID        +0.399    0.535        0.747     0.4554             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p1_ID        +0.840    0.535        1.572     0.116              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p1_ID        +0.454    0.535        0.850     0.3955             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p1_ID        +3.122    0.535        5.840     6.095e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p1_ID        -0.533    0.535        -0.998    0.3186             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p2_ID        +5.054    0.458        11.029    1.751e-27   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p2_ID        +4.458    0.458        9.730     7.004e-22   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p2_ID        +6.544    0.458        14.281    4.378e-44   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p2_ID        +5.009    0.458        10.933    4.79e-27    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p2_ID        +2.706    0.458        5.907     4.108e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p2_ID        +6.663    0.458        14.542    1.442e-45   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p3_ID        +2.764    0.534        5.177     2.483e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p3_ID        -0.622    0.534        -1.166    0.2439             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p3_ID        +3.171    0.534        5.939     3.388e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p3_ID        +4.114    0.534        7.706     2.046e-14   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p3_ID        -3.673    0.534        -6.880    8.035e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p3_ID        +2.792    0.534        5.230     1.879e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p4_ID        -0.991    0.609        -1.629    0.1034             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p4_ID        -0.123    0.609        -0.203    0.8395             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p4_ID        +5.431    0.609        8.926     9.95e-19    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p4_ID        -2.586    0.609        -4.251    2.233e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p4_ID        +1.808    0.609        2.971     0.003002    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p4_ID        +3.969    0.609        6.523     8.772e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:FULL.p1.p2   +3.292    1.899        1.734     0.08309     +      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:FULL.p1.p2   +7.657    1.899        4.033     5.726e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:FULL.p1.p2   +6.776    1.899        3.569     0.0003675   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:FULL.p1.p2   +32.544   1.899        17.140    1.844e-61   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:FULL.p1.p2   +3.174    1.899        1.672     0.09473     +      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:FULL.p1.p2   +19.498   1.899        10.269    3.949e-24   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:FULL.p1.p3   +3.232    1.955        1.653     0.09842     +      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:FULL.p1.p3   +6.802    1.955        3.480     0.0005128   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:FULL.p1.p3   +7.057    1.955        3.610     0.0003136   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:FULL.p1.p3   +33.570   1.955        17.173    1.114e-61   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:FULL.p1.p3   +4.154    1.955        2.125     0.03371     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:FULL.p1.p3   +19.103   1.955        9.772     4.697e-22   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:FULL.p1.p4   +4.977    2.231        2.231     0.0258      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:FULL.p1.p4   +9.175    2.231        4.113     4.072e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:FULL.p1.p4   +5.448    2.231        2.442     0.01469     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:FULL.p1.p4   +34.133   2.231        15.301    5.257e-50   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:FULL.p1.p4   +3.481    2.231        1.560     0.1188             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:FULL.p1.p4   +18.009   2.231        8.073     1.185e-15   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:FULL.p2.p3   +1.621    1.830        0.886     0.3757             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:FULL.p2.p3   +6.701    1.830        3.662     0.0002567   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:FULL.p2.p3   +7.567    1.830        4.136     3.691e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:FULL.p2.p3   +35.388   1.830        19.339    2.158e-76   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:FULL.p2.p3   +5.926    1.830        3.238     0.001222    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:FULL.p2.p3   +20.525   1.830        11.217    2.422e-28   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:FULL.p2.p4   +1.686    1.953        0.863     0.3882             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:FULL.p2.p4   +8.136    1.953        4.165     3.245e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:FULL.p2.p4   +5.257    1.953        2.692     0.00717     **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:FULL.p2.p4   +33.761   1.953        17.285    2.081e-62   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:FULL.p2.p4   +5.241    1.953        2.683     0.007352    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:FULL.p2.p4   +17.665   1.953        9.044     3.533e-19   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:FULL.p3.p4   +3.364    2.104        1.599     0.11               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:FULL.p3.p4   +9.872    2.104        4.692     2.898e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:FULL.p3.p4   +4.387    2.104        2.085     0.0372      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:FULL.p3.p4   +35.150   2.104        16.705    1.149e-58   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:FULL.p3.p4   +6.951    2.104        3.304     0.0009714   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:FULL.p3.p4   +18.366   2.104        8.729     5.416e-18   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 2016 total; 1956 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.931155 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Multivariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]    [,2]    [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4.8157  2.3236 -1.3479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.3236  2.9908 -1.2351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.3479 -1.2351  3.9281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.1945 1.7294 1.982 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Repeated Measure`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.5364 1.4449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.4449 4.5364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.1299 2.1299 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:1  3.72940  1.18780  2.28330  0.72724 -1.15570 -0.36810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:2  1.18780  3.72940  0.72724  2.28330 -0.36810 -1.15570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:1  2.28330  0.72724  3.72940  1.18780 -1.34380 -0.42801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:2  0.72724  2.28330  1.18780  3.72940 -0.42801 -1.34380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:1 -1.15570 -0.36810 -1.34380 -0.42801  3.72940  1.18780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:2 -0.36810 -1.15570 -0.42801 -1.34380  1.18780  3.72940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.9312 1.9312 1.9312 1.9312 1.9312 1.9312 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># From this summary, we can see that there are many coefficients, a number of which are not</span></span></span>
<span class="r-in"><span><span class="co"># statistically significant at an</span></span></span>
<span class="r-in"><span><span class="co"># alpha level of 0.05, therefore this model may not be ideal for our data. We refit the model</span></span></span>
<span class="r-in"><span><span class="co"># using an average interaction structure instead as it reduces the number of interaction terms</span></span></span>
<span class="r-in"><span><span class="co"># to 1 per ecosystem function and time point.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simModel_AV</span> <span class="op">&lt;-</span> <span class="fu">DImulti</span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"ar1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       unit_IDs <span class="op">=</span> <span class="fl">1</span>, estimate_theta <span class="op">=</span> <span class="cn">FALSE</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, method <span class="op">=</span> <span class="st">"ML"</span>,</span></span>
<span class="r-in"><span>                       data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">simModel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">ML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">un@ar1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Average Term Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span>1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by maximum likelihood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: value ~ 0 + func:time:((p1_ID + p2_ID + p3_ID + p4_ID + AV)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7921.064  8094.939 -3929.532 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Multivariate Correlation Structure: General</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1      2     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.612       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 -0.310 -0.364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: AR(1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 + as.numeric(time) | plot/func </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Phi </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3161191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Beta      Std. Error   t-value   p-value      Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------  --------  -----------  --------  -----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p1_ID   -1.407    0.402        -3.505    0.0004663    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p1_ID   +0.354    0.402        0.881     0.3787              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p1_ID   +0.946    0.402        2.357     0.01852      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p1_ID   +0.142    0.402        0.353     0.7238              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p1_ID   +2.630    0.402        6.550     7.324e-11    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p1_ID   -0.552    0.402        -1.375    0.1692              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p2_ID   +4.770    0.372        12.825    3.103e-36    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p2_ID   +4.273    0.372        11.489    1.258e-29    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p2_ID   +6.704    0.372        18.025    2.163e-67    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p2_ID   +4.976    0.372        13.379    3.759e-39    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p2_ID   +2.707    0.372        7.280     4.793e-13    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p2_ID   +6.806    0.372        18.299    3.007e-69    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p3_ID   +2.665    0.404        6.603     5.17e-11     ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p3_ID   -0.766    0.404        -1.896    0.05804      +      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p3_ID   +3.321    0.404        8.226     3.45e-16     ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p3_ID   +4.394    0.404        10.884    7.756e-27    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p3_ID   -3.350    0.404        -8.299    1.913e-16    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p3_ID   +3.008    0.404        7.452     1.362e-13    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p4_ID   -0.900    0.453        -1.984    0.04736      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:p4_ID   +0.325    0.453        0.717     0.4733              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p4_ID   +4.924    0.453        10.860    9.948e-27    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:p4_ID   -2.504    0.453        -5.523    3.779e-08    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p4_ID   +2.019    0.453        4.453     8.941e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:p4_ID   +3.544    0.453        7.817     8.734e-15    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:AV      +2.892    0.984        2.938     0.003339     **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time1:AV      +7.938    0.984        8.066     1.246e-15    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:AV      +6.184    0.984        6.284     4.055e-10    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time2:AV      +34.080   0.984        34.628    5.753e-206   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:AV      +4.827    0.984        4.904     1.014e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time2:AV      +18.944   0.984        19.249    7.598e-76    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 2016 total; 1986 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.936361 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Multivariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]    [,2]    [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4.8390  2.3374 -1.3561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.3374  3.0147 -1.2559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.3561 -1.2559  3.9495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.1998 1.7363 1.9873 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Repeated Measure`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.5575 1.4407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.4407 4.5575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.1348 2.1348 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:1  3.74950  1.18530  2.29460  0.72537 -1.16310 -0.36768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:2  1.18530  3.74950  0.72537  2.29460 -0.36768 -1.16310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:1  2.29460  0.72537  3.74950  1.18530 -1.36470 -0.43139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:2  0.72537  2.29460  1.18530  3.74950 -0.43139 -1.36470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:1 -1.16310 -0.36768 -1.36470 -0.43139  3.74950  1.18530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:2 -0.36768 -1.16310 -0.43139 -1.36470  1.18530  3.74950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.9364 1.9364 1.9364 1.9364 1.9364 1.9364 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This model looks like it is a better fit, with less insignificant terms, but we can test this</span></span></span>
<span class="r-in"><span><span class="co"># formally using a likelihood ratio test, as the DImodels interaction structures are nested in</span></span></span>
<span class="r-in"><span><span class="co"># nature (with the exception of "ADD" and "FG", which are on the same level in the nesting</span></span></span>
<span class="r-in"><span><span class="co"># hierarchy).</span></span></span>
<span class="r-in"><span><span class="co"># This will test the null hypothesis that the likelihood of the two models do not significantly</span></span></span>
<span class="r-in"><span><span class="co"># differ, in other words, the added parameters of the more complex model are not worth it.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">simModel_FULL</span>, <span class="va">simModel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> simModel_FULL     1 61 7969.803 8311.945 -3923.902                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> simModel_AV       2 31 7921.064 8094.939 -3929.532 1 vs 2 11.26025  0.9992</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As the p-value is greater than our selected alpha value (0.05), we fail to reject the null</span></span></span>
<span class="r-in"><span><span class="co"># hypothesis and so continue with the simpler model, simModel_AV.</span></span></span>
<span class="r-in"><span><span class="co"># We can confirm this result by using information criteria such as AIC or BIC.</span></span></span>
<span class="r-in"><span><span class="co"># We select the model with the lower value as it indicates a better fit.</span></span></span>
<span class="r-in"><span><span class="co"># We use the second order versions of AIC and BIC (AICc and BICc) as we have a large number of</span></span></span>
<span class="r-in"><span><span class="co"># terms, which can cause AIC and BIC to favour more complex models.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="AICc.html">AICc</a></span><span class="op">(</span><span class="va">simModel_FULL</span><span class="op">)</span>; <span class="fu"><a href="AICc.html">AICc</a></span><span class="op">(</span><span class="va">simModel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7975.676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7924.065</span>
<span class="r-in"><span><span class="fu"><a href="BICc.html">BICc</a></span><span class="op">(</span><span class="va">simModel_FULL</span><span class="op">)</span>; <span class="fu"><a href="BICc.html">BICc</a></span><span class="op">(</span><span class="va">simModel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8326.672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8098.743</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We refit our chosen model using the REML estimation method to have unbiased estimates.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simModel_AV</span> <span class="op">&lt;-</span> <span class="fu">DImulti</span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">8</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"un"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"ar1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       unit_IDs <span class="op">=</span> <span class="fl">1</span>, estimate_theta <span class="op">=</span> <span class="cn">FALSE</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, method <span class="op">=</span> <span class="st">"REML"</span>,</span></span>
<span class="r-in"><span>                       data <span class="op">=</span> <span class="va">simMVRM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can now examine the variance covariance matrix, Sigma, and the fixed effect coefficients,</span></span></span>
<span class="r-in"><span><span class="co"># which can be retrieved from our initial summary() check or individually.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">simModel_AV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p1_ID funcY2:time1:p1_ID funcY3:time1:p1_ID funcY1:time2:p1_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         -1.4073525          0.3535514          0.9463605          0.1419124 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p1_ID funcY3:time2:p1_ID funcY1:time1:p2_ID funcY2:time1:p2_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2.6296879         -0.5521430          4.7699282          4.2730527 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p2_ID funcY1:time2:p2_ID funcY2:time2:p2_ID funcY3:time2:p2_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          6.7037708          4.9758685          2.7074546          6.8055585 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY1:time1:p3_ID funcY2:time1:p3_ID funcY3:time1:p3_ID funcY1:time2:p3_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2.6653214         -0.7655644          3.3207690          4.3935222 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY2:time2:p3_ID funcY3:time2:p3_ID funcY1:time1:p4_ID funcY2:time1:p4_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         -3.3501635          3.0082933         -0.8997879          0.3252207 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> funcY3:time1:p4_ID funcY1:time2:p4_ID funcY2:time2:p4_ID funcY3:time2:p4_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4.9242752         -2.5041979          2.0191631          3.5443872 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    funcY1:time1:AV    funcY2:time1:AV    funcY3:time1:AV    funcY1:time2:AV </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2.8917739          7.9381038          6.1841587         34.0798392 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    funcY2:time2:AV    funcY3:time2:AV </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4.8267227         18.9444801 </span>
<span class="r-in"><span><span class="va">simModel_AV</span><span class="op">$</span><span class="va">vcov</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Combined</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Y1:1     Y1:2     Y2:1     Y2:2     Y3:1     Y3:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:1  3.80690  1.20340  2.33020  0.73662 -1.18210 -0.37368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y1:2  1.20340  3.80690  0.73662  2.33020 -0.37368 -1.18210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:1  2.33020  0.73662  3.80690  1.20340 -1.38640 -0.43828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y2:2  0.73662  2.33020  1.20340  3.80690 -0.43828 -1.38640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:1 -1.18210 -0.37368 -1.38640 -0.43828  3.80690  1.20340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y3:2 -0.37368 -1.18210 -0.43828 -1.38640  1.20340  3.80690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.9511 1.9511 1.9511 1.9511 1.9511 1.9511 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Multivariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]    [,2]    [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  4.9140  2.3738 -1.3783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  2.3738  3.0605 -1.2758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.3783 -1.2758  4.0093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.2168 1.7494 2.0023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Repeated Measure`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 4.6263 1.4625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 1.4625 4.6263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 2.1509 2.1509 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># An example of what we can infer from this is that ecosystem functions Y1 and Y2 have a positive</span></span></span>
<span class="r-in"><span><span class="co"># covariance at time 1, while Y3 has a negative covariance with both Y1 and Y2 at the same time</span></span></span>
<span class="r-in"><span><span class="co"># point. This means that maximising Y1 would not negatively impact Y2 but it would be at the cost</span></span></span>
<span class="r-in"><span><span class="co"># of Y3. However, as our interaction term is positive and significant at this time point for all</span></span></span>
<span class="r-in"><span><span class="co"># three ecosystem functions, we should be able to include a mixture of species that have positive</span></span></span>
<span class="r-in"><span><span class="co"># ID effects for each response to help mitigate this trade-off.</span></span></span>
<span class="r-in"><span><span class="co"># We can also predict from the model if we want to compare responses from different conditions,</span></span></span>
<span class="r-in"><span><span class="co"># even those not included in the original data.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">simModel_AV</span>, newdata <span class="op">=</span> <span class="va">simMVRM</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">simMVRM</span><span class="op">$</span><span class="va">plot</span> <span class="op">==</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    plot     Yvalue Ytype</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 -1.4073525  Y1:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1  0.1419124  Y1:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1  0.3535514  Y2:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1  2.6296879  Y2:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1  0.9463605  Y3:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1 -0.5521430  Y3:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     2 -1.4073525  Y1:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     2  0.1419124  Y1:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     2  0.3535514  Y2:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    2  2.6296879  Y2:2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    2  0.9463605  Y3:1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    2 -0.5521430  Y3:2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">## The Belgium dataset</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># This real world dataset contains multiple ecosystem functions (k=3) at a single time point</span></span></span>
<span class="r-in"><span><span class="co"># (t=1). The dataset also contains seeding density as a treatment in the form of a factor with</span></span></span>
<span class="r-in"><span><span class="co"># two levels (1, -1). More detail can be found at ?dataBEL.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataBEL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataBEL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Plot  G1  G2  L1  L2 Density  Var VarNum       Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    1 0.7 0.1 0.1 0.1       1 Sown      1 104.156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1 0.7 0.1 0.1 0.1       1 Weed      2 100.058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1 0.7 0.1 0.1 0.1       1    N      3  87.996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    2 0.1 0.7 0.1 0.1       1 Sown      1  82.547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    2 0.1 0.7 0.1 0.1       1 Weed      2  89.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    2 0.1 0.7 0.1 0.1       1    N      3  72.239</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We begin with the main function DImulti(), passing the initial species proportions column names</span></span></span>
<span class="r-in"><span><span class="co"># through 'prop' and the response value column name through 'y'.</span></span></span>
<span class="r-in"><span><span class="co"># As the data is in a long or stacked format, we specify the ecosystem function type through the</span></span></span>
<span class="r-in"><span><span class="co"># first index of the 'eco_func' parameter, along with specifying that we want an unstructured</span></span></span>
<span class="r-in"><span><span class="co"># Sigma for these response types.</span></span></span>
<span class="r-in"><span><span class="co"># The experimental unit ID is stored in the column "Plot" and so we pass this to 'unit_IDs'.</span></span></span>
<span class="r-in"><span><span class="co"># Rather than estimating the nonlinear parameter theta, we opt to provide a value for each</span></span></span>
<span class="r-in"><span><span class="co"># ecosystem function type through the parameter 'theta', which will be applied to the</span></span></span>
<span class="r-in"><span><span class="co"># interaction terms as a power. In this case, we use functional group (FG) interactions, which</span></span></span>
<span class="r-in"><span><span class="co"># requires an additional argument FG to be provided, specifying which group each species present</span></span></span>
<span class="r-in"><span><span class="co"># in 'prop' belongs to. In this case, we group the grasses and the legumes.</span></span></span>
<span class="r-in"><span><span class="co"># We include the treatment Density as an additional fixed effect.</span></span></span>
<span class="r-in"><span><span class="co"># We opt to use the REML estimation method as we will not be doing any model comparisons.</span></span></span>
<span class="r-in"><span><span class="co"># Finally, we specify the data object, dataBEL, through 'data'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">belModel</span> <span class="op">&lt;-</span> <span class="fu">DImulti</span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Y"</span>, eco_func <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Var"</span>, <span class="st">"un"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    unit_IDs <span class="op">=</span> <span class="st">"Plot"</span>, theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.2</span><span class="op">)</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>,</span></span>
<span class="r-in"><span>                    FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grass"</span>, <span class="st">"Grass"</span>, <span class="st">"Legume"</span>, <span class="st">"Legume"</span><span class="op">)</span>, extra_fixed <span class="op">=</span> <span class="op">~</span> <span class="va">Density</span>,</span></span>
<span class="r-in"><span>                    method <span class="op">=</span> <span class="st">"REML"</span>, data <span class="op">=</span> <span class="va">dataBEL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can now print the output from our model, stored in belModel with class DImulti.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">belModel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">REML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">un</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Functional Group Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span><span style="font-weight: bold;">N</span>:0.5, <span style="font-weight: bold;">Sown</span>:1, <span style="font-weight: bold;">Weed</span>:1.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by REML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: Y ~ 0 + Var:((G1_ID + G2_ID + L1_ID + L2_ID + FG.bfg_Grass_Legume +      FG.wfg_Grass + FG.wfg_Legume) + Density) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  488.8132  554.5029 -214.4066 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Multivariate Correlation Structure: General</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | Plot </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1     2    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.797      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.065 0.523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                               Beta       Std. Error   t-value   p-value     Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------  ---------  -----------  --------  ----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:G1_ID                    +44.867    4.209        10.661    5.433e-16   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:G1_ID                 +65.337    4.656        14.033    1.745e-21   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:G1_ID                 +79.372    9.039        8.781     1.065e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:G2_ID                    +28.926    4.209        6.873     2.722e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:G2_ID                 +46.808    4.656        10.053    6.096e-15   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:G2_ID                 +90.654    9.039        10.029    6.706e-15   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:L1_ID                    +98.246    4.209        23.344    1.322e-33   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:L1_ID                 +76.396    4.656        16.408    5.561e-25   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:L1_ID                 +50.032    9.039        5.535     5.782e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:L2_ID                    +77.067    4.209        18.312    1.438e-27   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:L2_ID                 +51.062    4.656        10.967    1.629e-16   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:L2_ID                 +33.951    9.039        3.756     0.0003674   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:FG.bfg_Grass_Legume      +14.538    13.281       1.095     0.2777             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:FG.bfg_Grass_Legume   +86.492    18.699       4.625     1.796e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:FG.bfg_Grass_Legume   +152.157   49.542       3.071     0.003095    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:FG.wfg_Grass             +58.483    28.072       2.083     0.0411      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:FG.wfg_Grass          +107.670   41.360       2.603     0.0114      *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:FG.wfg_Grass          -9.702     108.079      -0.090    0.9287             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:FG.wfg_Legume            -16.215    28.072       -0.578    0.5655             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:FG.wfg_Legume         +60.847    41.360       1.471     0.146              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:FG.wfg_Legume         +242.472   108.079      2.243     0.02823     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarN:Density1                 -1.261     2.348        -0.537    0.593              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarSown:Density1              +2.290     2.618        0.875     0.3849             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VarWeed:Density1              +0.991     5.083        0.195     0.846              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 90 total; 66 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 6.428977 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            N   Sown     Weed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N    41.3320 36.716   5.8403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sown 36.7160 51.407  52.2200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weed  5.8403 52.220 193.7900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 6.429 7.1699 13.921 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">## The Sweden dataset</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># This real-world dataset contains a single ecosystem function read at multiple time points</span></span></span>
<span class="r-in"><span><span class="co"># (k=1 &amp; t=3). The data contains two treatments, TREAT and DENS, each with two levels</span></span></span>
<span class="r-in"><span><span class="co"># 1 &amp; 2 and High &amp; Low, respectively.</span></span></span>
<span class="r-in"><span><span class="co"># More details can be found at ?dataSWE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dataSWE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataSWE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   YEARN PLOT TREAT DENS   G1   G2   L1   L2     YIELD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1    1     1 High 0.70 0.10 0.10 0.10  7.774822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1    2     1 High 0.10 0.70 0.10 0.10 10.302994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1    3     1 High 0.10 0.10 0.70 0.10 12.643246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1    4     1 High 0.10 0.10 0.10 0.70 12.174211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1    5     1 High 0.25 0.25 0.25 0.25  9.063782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1    6     1 High 0.40 0.40 0.10 0.10  9.148516</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We transform the "YEARN" column to factors to better act as groups in our models, giving us a</span></span></span>
<span class="r-in"><span><span class="co"># coefficient per year number as opposed to acting as a continuous scaling factor.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataSWE</span><span class="op">$</span><span class="va">YEARN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">dataSWE</span><span class="op">$</span><span class="va">YEARN</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We use the DImulti() function to fit a repeated measures DI model to this data.</span></span></span>
<span class="r-in"><span><span class="co"># We specify the column indices 5 through 8 for our initial species proportions and the response</span></span></span>
<span class="r-in"><span><span class="co"># value column name "YIELD".</span></span></span>
<span class="r-in"><span><span class="co"># As there are multiple time points (repeated measures), we use the parameter 'time', providing</span></span></span>
<span class="r-in"><span><span class="co"># the column name containing the time identifier through the first index and the desired Sigma</span></span></span>
<span class="r-in"><span><span class="co"># structure (compound symmetry) through the second.</span></span></span>
<span class="r-in"><span><span class="co"># The experimental unit ID is stored in column index two, which is passed through 'unit_IDs'.</span></span></span>
<span class="r-in"><span><span class="co"># The interaction structure chosen is average interaction term, "AV".</span></span></span>
<span class="r-in"><span><span class="co"># We include both of the treatment terms, TREAT and DENS, as extra fixed effects crossed with</span></span></span>
<span class="r-in"><span><span class="co"># each ID effect, the interaction effect, and with each other.</span></span></span>
<span class="r-in"><span><span class="co"># We opt to use the REML estimation method for the model as we will not be doing any model</span></span></span>
<span class="r-in"><span><span class="co"># comparisons.</span></span></span>
<span class="r-in"><span><span class="co"># Finally, we specify the data object, dataSWE, through 'data'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SWEmodel</span> <span class="op">&lt;-</span> <span class="fu">DImulti</span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YIELD"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"CS"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    unit_IDs <span class="op">=</span> <span class="fl">2</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>, extra_fixed <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">TREAT</span><span class="op">:</span><span class="va">DENS</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    method <span class="op">=</span> <span class="st">"REML"</span>, data <span class="op">=</span> <span class="va">dataSWE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">SWEmodel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">REML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">CS</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Average Term Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span>1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by REML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID + AV):(TREAT:DENS)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  386.0460  536.7567 -131.0230 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: Compound symmetry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | PLOT </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5934898 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                Beta      Std. Error   t-value   p-value     Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------  --------  -----------  --------  ----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:TREAT1:DENSHigh   +7.247    1.103        6.569     3.998e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:TREAT1:DENSHigh   +4.404    1.103        3.992     0.0001397   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:TREAT1:DENSHigh   +2.749    1.103        2.492     0.01467     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:TREAT2:DENSHigh   +10.605   1.155        9.185     2.52e-14    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:TREAT2:DENSHigh   +7.905    1.155        6.847     1.159e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:TREAT2:DENSHigh   +6.164    1.155        5.339     7.82e-07    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:TREAT1:DENSLow    +7.564    1.103        6.856     1.111e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:TREAT1:DENSLow    +3.748    1.103        3.397     0.001042    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:TREAT1:DENSLow    +2.861    1.103        2.593     0.01122     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:TREAT2:DENSLow    +9.509    1.155        8.236     2.041e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:TREAT2:DENSLow    +7.103    1.155        6.152     2.498e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:TREAT2:DENSLow    +5.447    1.155        4.717     9.422e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:TREAT1:DENSHigh   +7.412    1.103        6.719     2.057e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:TREAT1:DENSHigh   +5.286    1.103        4.792     7.052e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:TREAT1:DENSHigh   +4.293    1.103        3.891     0.0001991   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:TREAT2:DENSHigh   +12.244   1.155        10.605    3.611e-17   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:TREAT2:DENSHigh   +11.280   1.155        9.770     1.679e-15   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:TREAT2:DENSHigh   +9.434    1.155        8.170     2.763e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:TREAT1:DENSLow    +7.629    1.103        6.915     8.518e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:TREAT1:DENSLow    +6.194    1.103        5.614     2.489e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:TREAT1:DENSLow    +4.791    1.103        4.343     3.907e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:TREAT2:DENSLow    +12.185   1.155        10.553    4.579e-17   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:TREAT2:DENSLow    +10.478   1.155        9.075     4.198e-14   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:TREAT2:DENSLow    +9.152    1.155        7.926     8.516e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:TREAT1:DENSHigh   +9.475    1.103        8.589     3.99e-13    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:TREAT1:DENSHigh   +7.245    1.103        6.567     4.027e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:TREAT1:DENSHigh   +3.269    1.103        2.963     0.003964    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:TREAT2:DENSHigh   +11.322   1.155        9.806     1.422e-15   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:TREAT2:DENSHigh   +9.371    1.155        8.116     3.552e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:TREAT2:DENSHigh   +5.873    1.155        5.086     2.19e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:TREAT1:DENSLow    +8.150    1.103        7.388     1.005e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:TREAT1:DENSLow    +5.371    1.103        4.868     5.223e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:TREAT1:DENSLow    +3.773    1.103        3.420     0.0009678   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:TREAT2:DENSLow    +10.581   1.155        9.164     2.773e-14   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:TREAT2:DENSLow    +8.815    1.155        7.634     3.255e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:TREAT2:DENSLow    +6.277    1.155        5.436     5.23e-07    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:TREAT1:DENSHigh   +8.638    1.103        7.829     1.33e-11    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:TREAT1:DENSHigh   +7.772    1.103        7.045     4.749e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:TREAT1:DENSHigh   +5.782    1.103        5.241     1.169e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:TREAT2:DENSHigh   +8.531    1.155        7.389     9.999e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:TREAT2:DENSHigh   +8.047    1.155        6.969     6.685e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:TREAT2:DENSHigh   +6.793    1.155        5.883     7.949e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:TREAT1:DENSLow    +8.184    1.103        7.418     8.741e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:TREAT1:DENSLow    +7.295    1.103        6.613     3.297e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:TREAT1:DENSLow    +6.697    1.103        6.070     3.555e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:TREAT2:DENSLow    +8.235    1.155        7.132     3.201e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:TREAT2:DENSLow    +8.091    1.155        7.007     5.634e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:TREAT2:DENSLow    +7.256    1.155        6.285     1.401e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:TREAT1:DENSHigh      +8.000    2.405        3.326     0.001307    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:TREAT1:DENSHigh      +14.532   2.405        6.042     4.02e-08    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:TREAT1:DENSHigh      +16.668   2.405        6.930     7.959e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:TREAT2:DENSHigh      +10.452   3.124        3.346     0.001228    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:TREAT2:DENSHigh      +15.438   3.124        4.942     3.895e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:TREAT2:DENSHigh      +15.672   3.124        5.017     2.888e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:TREAT1:DENSLow       +7.187    2.405        2.988     0.003678    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:TREAT1:DENSLow       +16.129   2.405        6.706     2.172e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:TREAT1:DENSLow       +15.116   2.405        6.285     1.398e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:TREAT2:DENSLow       +10.213   3.124        3.269     0.001563    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:TREAT2:DENSLow       +15.793   3.124        5.056     2.473e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:TREAT2:DENSLow       +14.843   3.124        4.752     8.23e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 144 total; 84 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.299215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1      2      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.6880 1.0018 1.0018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.0018 1.6880 1.0018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 1.0018 1.0018 1.6880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.2992 1.2992 1.2992 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laura Byrne, Rishabh Vishwakarma, Rafael de Andrade Moral, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

