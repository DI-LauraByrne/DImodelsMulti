<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The Sweden dataset — dataSWE • DImodelsMulti</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Sweden dataset — dataSWE"><meta name="description" content="Single site dataset containing 48 experimental units (plots), with four species seeded at two
density levels, representing fifteen communities. One ecosystem function response is recorded for
each plot at a three time points."><meta property="og:description" content="Single site dataset containing 48 experimental units (plots), with four species seeded at two
density levels, representing fifteen communities. One ecosystem function response is recorded for
each plot at a three time points."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DImodelsMulti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/DImulti_commonErrors.html">Common errors &amp; warnings encountered in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_onTheta.html">On the usage and estimation of theta in DImulti()</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_prediction.html">On prediction from multivariate repeated measures DI models</a></li>
    <li><a class="dropdown-item" href="../articles/DImulti_workflow.html">The recommended workflow of DImulti() analyses</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DI-LauraByrne/DImodelsMulti/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The Sweden dataset</h1>

      <div class="d-none name"><code>dataSWE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Single site dataset containing 48 experimental units (plots), with four species seeded at two
density levels, representing fifteen communities. One ecosystem function response is recorded for
each plot at a three time points.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dataSWE"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 432 observations on the following 9 variables.</p><dl><dt><code>YEARN</code></dt>
<dd><p>a numeric vector indicating the time point (year) that the ecosystem
    function recording was measured at</p></dd>

    <dt><code>PLOT</code></dt>
<dd><p>a numeric vector indicating the ID of the experimental unit from which the
    observation was recorded</p></dd>

    <dt><code>TREAT</code></dt>
<dd><p>a vector of factors with two levels, 1 or 2, indicating the treatment
    applied to the plot</p></dd>

    <dt><code>G1</code></dt>
<dd><p>a numeric vector ranging from 0 to 1, the proportion of the species G1</p></dd>

    <dt><code>G2</code></dt>
<dd><p>a numeric vector ranging from 0 to 1, the proportion of the species G2</p></dd>

    <dt><code>L1</code></dt>
<dd><p>a numeric vector ranging from 0 to 1, the proportion of the species L1</p></dd>

    <dt><code>L2</code></dt>
<dd><p>a numeric vector ranging from 0 to 1, the proportion of the species L2</p></dd>

    <dt><code>DENS</code></dt>
<dd><p>a character vector representing the seeding density of the plot (-1 or 1)</p></dd>

    <dt><code>YIELD</code></dt>
<dd><p>a numeric vector indicating the value of the harvest recorded</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Data comes from a single site from a wider agrodiversity experiment conducted in Sweden. <br>
The four species used were Lolium perenne (G1), Dactylis glomerata (G2), Trifolium pratense (L1), and
Trifolium repens (L2). There are two recommended functional groupings: grouping grasses (G1, G2)
and legumes (L1, L2), or grouping fast-establishing species (G1, L1) and temporally persistent
species (G2, L2). <br>
One ecosystem function (aboveground biomass (t DM ha-1)) was recorded by summing recordings from
four harvests over each year, for three years. <br>
The treatment applied varied the quantity of nitrogen applied (core plots with a quantity of 0 units
while treated plots had 180 units applied).</p>
    </div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, A., Carnus, T., Collins,
R.P., Cop, J., Delgado, I.,  De Vliegher, A., Elgersma A., Frankow-Lindberg, B., Golinski, P.,
Grieu, P., Gustavsson, A.M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M.,
Kadžiulienė, Ž., Lunnan, T., Lüscher, A., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U.,
Walmsley, D., and Finn, J., 2014. <br>
The Agrodiversity Experiment: three years of data from a multisite study in intensively managed
grasslands. <br></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dooley, A., Isbell, F., Kirwan, L., Connolly, J., Finn, J.A. and Brophy, C., 2015. <br>
Testing the effects of diversity on ecosystem multifunctionality using a multivariate model. <br>
Ecology Letters, 18(11), pp.1242-1251. <br></p>
<p>Kirwan, L., Connolly, J., Brophy, C., Baadshaug, O.H., Belanger, G., Black, A., Carnus, T., Collins,
R.P., Cop, J., Delgado, I.,  De Vliegher, A., Elgersma A., Frankow-Lindberg, B., Golinski, P.,
Grieu, P., Gustavsson, A.M., Helgadóttir, Á., Höglind, M., Huguenin-Elie, O., Jørgensen, M.,
Kadžiulienė, Ž., Lunnan, T., Lüscher, A., Kurki, P., Porqueddu, C., Sebastia, M.-T., Thumm, U.,
Walmsley, D., and Finn, J., 2014. <br>
The Agrodiversity Experiment: three years of data from a multisite study in intensively managed
grasslands. <br></p>
<p>Finn, J.A., Kirwan, L., Connolly, J., Sebastia, M.T., Helgadottir, A., Baadshaug, O.H.,
Belanger, G., Black, A., Brophy, C., Collins, R.P., Cop, J., Dalmannsdóttir, S., Delgado, I.,
Elgersma, A., Fothergill, M., Frankow-Lindberg, B.E., Ghesquiere, A., Golinska, B., Golinski, P.,
Grieu, P., Gustavsson, A.M., Höglind, M., Huguenin-Elie, O., Jørgensen, M., Kadziuliene, Z.,
Kurki, P., Llurba, R., Lunnan, T., Porqueddu, C., Suter, M., Thumm, U., and Lüscher, A., 2013. <br>
Ecosystem function enhanced by combining four functional types of plant species in intensively
managed grassland mixtures: a 3-year continental-scale field experiment.<br>
Journal of Applied Ecology, 50(2), pp.365-375 .<br></p>
<p>Kirwan, L., Connolly, J., Finn, J.A., Brophy, C., Luscher, A., Nyfeler, D. and Sebastia, M.T.,
2009. <br>
Diversity-interaction modeling: estimating contributions of species identities and interactions
to ecosystem function. <br>
Ecology, 90(8), pp.2032-2038. <br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">####################################################################################################</span></span></span>
<span class="r-in"><span><span class="co">####################################################################################################</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;STYLE type='text/css' scoped&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;/STYLE&gt;</span>
<span class="r-in"><span><span class="co">## Modelling Example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For a more thorough example of the workflow of this package, please see vignette</span></span></span>
<span class="r-in"><span><span class="co"># DImulti_workflow using the following code:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># vignette("DImulti_workflow")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataSWE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   YEARN PLOT TREAT DENS   G1   G2   L1   L2     YIELD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1    1     1 High 0.70 0.10 0.10 0.10  7.774822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1    2     1 High 0.10 0.70 0.10 0.10 10.302994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     1    3     1 High 0.10 0.10 0.70 0.10 12.643246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     1    4     1 High 0.10 0.10 0.10 0.70 12.174211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     1    5     1 High 0.25 0.25 0.25 0.25  9.063782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     1    6     1 High 0.40 0.40 0.10 0.10  9.148516</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We begin by transforming the time identifier column to a factor, to better group coefficients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dataSWE</span><span class="op">$</span><span class="va">YEARN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">dataSWE</span><span class="op">$</span><span class="va">YEARN</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We fit a repeated measures DI model using the main function DImulti().</span></span></span>
<span class="r-in"><span><span class="co"># We begin by passing the initial species proportions column names through 'prop' and the</span></span></span>
<span class="r-in"><span><span class="co"># response value column name through 'y'.</span></span></span>
<span class="r-in"><span><span class="co"># As the data contains multiple time points, we include the 'time' parameter, through which we</span></span></span>
<span class="r-in"><span><span class="co"># specify the column name containing the repeated measure indicator and the autocorrelation</span></span></span>
<span class="r-in"><span><span class="co"># structure we want to use, in this case, we use compound symmetry (CS).</span></span></span>
<span class="r-in"><span><span class="co"># The experimental unit ID is stored in the column "PLOT" and so we pass this to 'unit_IDs'.</span></span></span>
<span class="r-in"><span><span class="co"># We request that the method fits an average interaction structure and we include the treatments</span></span></span>
<span class="r-in"><span><span class="co"># DENS and TREAT as additional fixed effects.</span></span></span>
<span class="r-in"><span><span class="co"># We opt to use the ML estimation method to allow for model comparisons with different fixed</span></span></span>
<span class="r-in"><span><span class="co"># effects.</span></span></span>
<span class="r-in"><span><span class="co"># Finally, we specify the data object, dataSWE, through 'data'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SWEmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"YIELD"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"PLOT"</span>,</span></span>
<span class="r-in"><span>                    prop <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, data <span class="op">=</span> <span class="va">dataSWE</span>, DImodel <span class="op">=</span> <span class="st">"AV"</span>,</span></span>
<span class="r-in"><span>                    extra_fixed <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">DENS</span><span class="op">:</span><span class="va">TREAT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">SWEmodel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Note: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Method Used =</span><span style="font-weight: bold;"> </span><span style="font-weight: bold; text-decoration: underline;">ML</span><span style="font-weight: bold;"> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Correlation Structure Used = </span><span style="font-weight: bold; text-decoration: underline;">CS</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00; font-weight: bold;">Average Term Model</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB00BB; font-weight: bold;">Theta value(s) = </span>1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized least squares fit by maximum likelihood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: YIELD ~ 0 + YEARN:((G1_ID + G2_ID + L1_ID + L2_ID + AV):(DENS:TREAT)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       AIC       BIC    logLik </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  481.5727  665.7011 -178.7863 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Repeated Measure Correlation Structure: Compound symmetry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~0 | PLOT </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5934976 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Table: <span style="font-weight: bold;">Fixed Effect Coefficients</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                Beta      Std. Error   t-value   p-value     Signif </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------  --------  -----------  --------  ----------  -------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:DENSHigh:TREAT1   +7.247    1.103        6.569     3.999e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:DENSHigh:TREAT1   +4.404    1.103        3.992     0.0001397   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:DENSHigh:TREAT1   +2.749    1.103        2.492     0.01467     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:DENSLow:TREAT1    +7.564    1.103        6.856     1.111e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:DENSLow:TREAT1    +3.748    1.103        3.397     0.001042    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:DENSLow:TREAT1    +2.861    1.103        2.593     0.01122     *      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:DENSHigh:TREAT2   +10.605   1.155        9.185     2.52e-14    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:DENSHigh:TREAT2   +7.905    1.155        6.847     1.159e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:DENSHigh:TREAT2   +6.164    1.155        5.339     7.821e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:DENSLow:TREAT2    +9.509    1.155        8.236     2.041e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G1_ID:DENSLow:TREAT2    +7.103    1.155        6.152     2.499e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G1_ID:DENSLow:TREAT2    +5.447    1.155        4.717     9.423e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:DENSHigh:TREAT1   +7.412    1.103        6.718     2.057e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:DENSHigh:TREAT1   +5.286    1.103        4.792     7.053e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:DENSHigh:TREAT1   +4.293    1.103        3.891     0.0001991   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:DENSLow:TREAT1    +7.629    1.103        6.915     8.52e-10    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:DENSLow:TREAT1    +6.194    1.103        5.614     2.489e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:DENSLow:TREAT1    +4.791    1.103        4.343     3.908e-05   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:DENSHigh:TREAT2   +12.244   1.155        10.605    3.612e-17   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:DENSHigh:TREAT2   +11.280   1.155        9.770     1.68e-15    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:DENSHigh:TREAT2   +9.434    1.155        8.170     2.764e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G2_ID:DENSLow:TREAT2    +12.185   1.155        10.553    4.58e-17    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:G2_ID:DENSLow:TREAT2    +10.478   1.155        9.075     4.199e-14   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:G2_ID:DENSLow:TREAT2    +9.152    1.155        7.926     8.517e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:DENSHigh:TREAT1   +9.475    1.103        8.589     3.991e-13   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:DENSHigh:TREAT1   +7.245    1.103        6.567     4.027e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:DENSHigh:TREAT1   +3.269    1.103        2.963     0.003964    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:DENSLow:TREAT1    +8.150    1.103        7.388     1.005e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:DENSLow:TREAT1    +5.371    1.103        4.868     5.223e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:DENSLow:TREAT1    +3.773    1.103        3.420     0.0009679   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:DENSHigh:TREAT2   +11.322   1.155        9.806     1.422e-15   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:DENSHigh:TREAT2   +9.371    1.155        8.116     3.553e-12   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:DENSHigh:TREAT2   +5.873    1.155        5.086     2.19e-06    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L1_ID:DENSLow:TREAT2    +10.581   1.155        9.164     2.774e-14   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L1_ID:DENSLow:TREAT2    +8.815    1.155        7.634     3.256e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L1_ID:DENSLow:TREAT2    +6.277    1.155        5.436     5.231e-07   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:DENSHigh:TREAT1   +8.638    1.103        7.829     1.33e-11    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:DENSHigh:TREAT1   +7.772    1.103        7.045     4.75e-10    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:DENSHigh:TREAT1   +5.782    1.103        5.241     1.169e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:DENSLow:TREAT1    +8.184    1.103        7.418     8.743e-11   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:DENSLow:TREAT1    +7.295    1.103        6.613     3.297e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:DENSLow:TREAT1    +6.697    1.103        6.070     3.556e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:DENSHigh:TREAT2   +8.531    1.155        7.389     1e-10       ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:DENSHigh:TREAT2   +8.047    1.155        6.969     6.686e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:DENSHigh:TREAT2   +6.793    1.155        5.883     7.95e-08    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:L2_ID:DENSLow:TREAT2    +8.235    1.155        7.132     3.201e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:L2_ID:DENSLow:TREAT2    +8.091    1.155        7.007     5.635e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:L2_ID:DENSLow:TREAT2    +7.256    1.155        6.284     1.401e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:DENSHigh:TREAT1      +8.000    2.405        3.326     0.001307    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:DENSHigh:TREAT1      +14.532   2.405        6.042     4.02e-08    ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:DENSHigh:TREAT1      +16.668   2.405        6.930     7.961e-10   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:DENSLow:TREAT1       +7.187    2.405        2.988     0.003678    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:DENSLow:TREAT1       +16.129   2.405        6.706     2.173e-09   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:DENSLow:TREAT1       +15.116   2.405        6.285     1.398e-08   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:DENSHigh:TREAT2      +10.452   3.124        3.346     0.001228    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:DENSHigh:TREAT2      +15.438   3.124        4.942     3.895e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:DENSHigh:TREAT2      +15.672   3.124        5.017     2.888e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:AV:DENSLow:TREAT2       +10.213   3.124        3.269     0.001563    **     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN2:AV:DENSLow:TREAT2       +15.793   3.124        5.056     2.473e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN3:AV:DENSLow:TREAT2       +14.843   3.124        4.752     8.231e-06   ***    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif codes: 0-0.001 '***', 0.001-0.01 '**', 0.01-0.05 '*', 0.05-0.1 '+', 0.1-1.0 ' '</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 144 total; 84 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.9922969 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1       2       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.98465 0.58439 0.58439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.58439 0.98465 0.58439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.58439 0.58439 0.98465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 0.9923 0.9923 0.9923 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can now make any changes to the model's fixed effects and use a series of anovas (if the</span></span></span>
<span class="r-in"><span><span class="co"># models are nested) or information criteria such as AIC, AICc, BIC, or BICc to select a final model</span></span></span>
<span class="r-in"><span><span class="co"># We choose to change the interactions structure to functional groups, grouping the grasses and</span></span></span>
<span class="r-in"><span><span class="co"># legumes, and simplify the extra_fixed terms, as an example, by only crossing the ID effect of G1</span></span></span>
<span class="r-in"><span><span class="co"># with the treatments, and no longer crossing them with each other.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SWEmodel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"YIELD"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"PLOT"</span>,</span></span>
<span class="r-in"><span>                    prop <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, data <span class="op">=</span> <span class="va">dataSWE</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>, FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    extra_fixed <span class="op">=</span> <span class="op">~</span> <span class="va">G1_ID</span><span class="op">:</span><span class="op">(</span><span class="va">DENS</span><span class="op">+</span><span class="va">TREAT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="BICc.html">BICc</a></span><span class="op">(</span><span class="va">SWEmodel</span><span class="op">)</span>; <span class="fu"><a href="BICc.html">BICc</a></span><span class="op">(</span><span class="va">SWEmodel2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 905.3566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 588.6466</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We select the model with the lower information criteria, which is our functional group model, and</span></span></span>
<span class="r-in"><span><span class="co"># refit it using the "REML" estimation method, for unbiased estimates.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SWEmodel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="DImulti.html">DImulti</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"YIELD"</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"YEARN"</span>, <span class="st">"CS"</span><span class="op">)</span>, unit_IDs <span class="op">=</span> <span class="st">"PLOT"</span>,</span></span>
<span class="r-in"><span>                    prop <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">8</span>, data <span class="op">=</span> <span class="va">dataSWE</span>, DImodel <span class="op">=</span> <span class="st">"FG"</span>, FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"L"</span>, <span class="st">"L"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    extra_fixed <span class="op">=</span> <span class="op">~</span> <span class="va">G1_ID</span><span class="op">:</span><span class="op">(</span><span class="va">DENS</span><span class="op">+</span><span class="va">TREAT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With this model, we can examine the coefficients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">SWEmodel2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YEARN1:G1_ID         YEARN2:G1_ID         YEARN3:G1_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            7.5729869            3.9436908            2.5825595 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YEARN1:G2_ID         YEARN2:G2_ID         YEARN3:G2_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           10.2715952            8.3922725            6.9327048 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YEARN1:L1_ID         YEARN2:L1_ID         YEARN3:L1_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            9.4996347            7.6097151            4.7693333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         YEARN1:L2_ID         YEARN2:L2_ID         YEARN3:L2_ID </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            8.0816864            7.7804133            6.6584057 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    YEARN1:FG.bfg_G_L    YEARN2:FG.bfg_G_L    YEARN3:FG.bfg_G_L </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           10.8208347           13.5505353           14.4412685 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      YEARN1:FG.wfg_G      YEARN2:FG.wfg_G      YEARN3:FG.wfg_G </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -10.9099707           11.6936379           12.6962405 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      YEARN1:FG.wfg_L      YEARN2:FG.wfg_L      YEARN3:FG.wfg_L </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           10.5492339           17.8021550           15.4746646 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> YEARN1:G1_ID:DENSLow YEARN2:G1_ID:DENSLow YEARN3:G1_ID:DENSLow </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           -0.7974119           -0.6232490           -0.3472993 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  YEARN1:G1_ID:TREAT2  YEARN2:G1_ID:TREAT2  YEARN3:G1_ID:TREAT2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            4.3168232            4.8914212            4.1921989 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or the variance and correlation structures</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SWEmodel2</span><span class="op">$</span><span class="va">corr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Repeated Measure`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation structure of class corCompSymm representing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Rho </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8244173 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">nlme</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getVarCov.html" class="external-link">getVarCov</a></span><span class="op">(</span><span class="va">SWEmodel2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal variance covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1      2      3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2.7966 2.3055 2.3055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2.3055 2.7966 2.3055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2.3055 2.3055 2.7966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Standard Deviations: 1.6723 1.6723 1.6723 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Laura Byrne, Rishabh Vishwakarma, Rafael de Andrade Moral, Caroline Brophy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

